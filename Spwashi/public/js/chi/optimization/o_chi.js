/*! jQuery v2.1.4 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license */

/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.0.2
 */

//Underscore.js 1.8.3//http://underscorejs.org//(c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors//Underscore may be freely distributed under the MIT license.

//# sourceMappingURL=backbone-min.map;
//     (c) 2012 Onsi Fakhouri
//     Cocktail.js may be freely distributed under the MIT license.
//     http://github.com/onsi/cocktail

/*! Select2 4.0.1 | https://github.com/select2/select2/blob/master/LICENSE.md */

//  Underscore.inflection.js
//  (c) 2014 Jeremy Ruppel
//  Underscore.inflection is freely distributable under the MIT license.
//  Portions of Underscore.inflection are inspired or borrowed from ActiveSupport
//  Version 1.0.0

!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t="length"in e&&e.length,i=Z.type(e);return"function"===i||Z.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function n(e,t,i){if(Z.isFunction(t))return Z.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return Z.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(ae.test(t))return Z.filter(t,e,i);t=Z.filter(t,e)}return Z.grep(e,function(e){return W.call(t,e)>=0!==i})}function o(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function r(e){var t=fe[e]={};return Z.each(e.match(he)||[],function(e,i){t[i]=!0}),t}function s(){J.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1),Z.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Z.expando+a.uid++}function l(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(be,"-$1").toLowerCase(),i=e.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:ye.test(i)?Z.parseJSON(i):i}catch(o){}ge.set(e,t,i)}else i=void 0;return i}function c(){return!0}function d(){return!1}function u(){try{return J.activeElement}catch(e){}}function p(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function h(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Ve.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function m(e,t){for(var i=0,n=e.length;n>i;i++)ve.set(e[i],"globalEval",!t||ve.get(t[i],"globalEval"))}function _(e,t){var i,n,o,r,s,a,l,c;if(1===t.nodeType){if(ve.hasData(e)&&(r=ve.access(e),s=ve.set(t,r),c=r.events)){delete s.handle,s.events={};for(o in c)for(i=0,n=c[o].length;n>i;i++)Z.event.add(t,o,c[o][i])}ge.hasData(e)&&(a=ge.access(e),l=Z.extend({},a),ge.set(t,l))}}function v(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],i):i}function g(e,t){var i=t.nodeName.toLowerCase();"input"===i&&Ee.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function y(t,i){var n,o=Z(i.createElement(t)).appendTo(i.body),r=e.getDefaultComputedStyle&&(n=e.getDefaultComputedStyle(o[0]))?n.display:Z.css(o[0],"display");return o.detach(),r}function b(e){var t=J,i=Le[e];return i||(i=y(e,t),"none"!==i&&i||(qe=(qe||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=qe[0].contentDocument,t.write(),t.close(),i=y(e,t),qe.detach()),Le[e]=i),i}function S(e,t,i){var n,o,r,s,a=e.style;return i=i||He(e),i&&(s=i.getPropertyValue(t)||i[t]),i&&(""!==s||Z.contains(e.ownerDocument,e)||(s=Z.style(e,t)),Ue.test(s)&&Ge.test(t)&&(n=a.width,o=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=o,a.maxWidth=r)),void 0!==s?s+"":s}function C(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function w(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),n=t,o=Xe.length;o--;)if(t=Xe[o]+i,t in e)return t;return n}function E(e,t,i){var n=Be.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function x(e,t,i,n,o){for(var r=i===(n?"border":"content")?4:"width"===t?1:0,s=0;4>r;r+=2)"margin"===i&&(s+=Z.css(e,i+Ce[r],!0,o)),n?("content"===i&&(s-=Z.css(e,"padding"+Ce[r],!0,o)),"margin"!==i&&(s-=Z.css(e,"border"+Ce[r]+"Width",!0,o))):(s+=Z.css(e,"padding"+Ce[r],!0,o),"padding"!==i&&(s+=Z.css(e,"border"+Ce[r]+"Width",!0,o)));return s}function M(e,t,i){var n=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=He(e),s="border-box"===Z.css(e,"boxSizing",!1,r);if(0>=o||null==o){if(o=S(e,t,r),(0>o||null==o)&&(o=e.style[t]),Ue.test(o))return o;n=s&&(K.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+x(e,t,i||(s?"border":"content"),n,r)+"px"}function T(e,t){for(var i,n,o,r=[],s=0,a=e.length;a>s;s++)n=e[s],n.style&&(r[s]=ve.get(n,"olddisplay"),i=n.style.display,t?(r[s]||"none"!==i||(n.style.display=""),""===n.style.display&&we(n)&&(r[s]=ve.access(n,"olddisplay",b(n.nodeName)))):(o=we(n),"none"===i&&o||ve.set(n,"olddisplay",o?i:Z.css(n,"display"))));for(s=0;a>s;s++)n=e[s],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?r[s]||"":"none"));return e}function D(e,t,i,n,o){return new D.prototype.init(e,t,i,n,o)}function O(){return setTimeout(function(){Ke=void 0}),Ke=Z.now()}function $(e,t){var i,n=0,o={height:e};for(t=t?1:0;4>n;n+=2-t)i=Ce[n],o["margin"+i]=o["padding"+i]=e;return t&&(o.opacity=o.width=e),o}function I(e,t,i){for(var n,o=(it[t]||[]).concat(it["*"]),r=0,s=o.length;s>r;r++)if(n=o[r].call(i,t,e))return n}function k(e,t,i){var n,o,r,s,a,l,c,d,u=this,p={},h=e.style,f=e.nodeType&&we(e),m=ve.get(e,"fxshow");i.queue||(a=Z._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,Z.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[h.overflow,h.overflowX,h.overflowY],c=Z.css(e,"display"),d="none"===c?ve.get(e,"olddisplay")||b(e.nodeName):c,"inline"===d&&"none"===Z.css(e,"float")&&(h.display="inline-block")),i.overflow&&(h.overflow="hidden",u.always(function(){h.overflow=i.overflow[0],h.overflowX=i.overflow[1],h.overflowY=i.overflow[2]}));for(n in t)if(o=t[n],Qe.exec(o)){if(delete t[n],r=r||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!m||void 0===m[n])continue;f=!0}p[n]=m&&m[n]||Z.style(e,n)}else c=void 0;if(Z.isEmptyObject(p))"inline"===("none"===c?b(e.nodeName):c)&&(h.display=c);else{m?"hidden"in m&&(f=m.hidden):m=ve.access(e,"fxshow",{}),r&&(m.hidden=!f),f?Z(e).show():u.done(function(){Z(e).hide()}),u.done(function(){var t;ve.remove(e,"fxshow");for(t in p)Z.style(e,t,p[t])});for(n in p)s=I(f?m[n]:0,n,u),n in m||(m[n]=s.start,f&&(s.end=s.start,s.start="width"===n||"height"===n?1:0))}}function N(e,t){var i,n,o,r,s;for(i in e)if(n=Z.camelCase(i),o=t[n],r=e[i],Z.isArray(r)&&(o=r[1],r=e[i]=r[0]),i!==n&&(e[n]=r,delete e[i]),s=Z.cssHooks[n],s&&"expand"in s){r=s.expand(r),delete e[n];for(i in r)i in e||(e[i]=r[i],t[i]=o)}else t[n]=o}function A(e,t,i){var n,o,r=0,s=tt.length,a=Z.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=Ke||O(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,r=1-n,s=0,l=c.tweens.length;l>s;s++)c.tweens[s].run(r);return a.notifyWith(e,[c,r,i]),1>r&&l?i:(a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:Z.extend({},t),opts:Z.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Ke||O(),duration:i.duration,tweens:[],createTween:function(t,i){var n=Z.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(o)return this;for(o=!0;n>i;i++)c.tweens[i].run(1);return t?a.resolveWith(e,[c,t]):a.rejectWith(e,[c,t]),this}}),d=c.props;for(N(d,c.opts.specialEasing);s>r;r++)if(n=tt[r].call(c,e,d,c.opts))return n;return Z.map(d,I,c),Z.isFunction(c.opts.start)&&c.opts.start.call(e,c),Z.fx.timer(Z.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function P(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,o=0,r=t.toLowerCase().match(he)||[];if(Z.isFunction(i))for(;n=r[o++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function V(e,t,i,n){function o(a){var l;return r[a]=!0,Z.each(e[a]||[],function(e,a){var c=a(t,i,n);return"string"!=typeof c||s||r[c]?s?!(l=c):void 0:(t.dataTypes.unshift(c),o(c),!1)}),l}var r={},s=e===yt;return o(t.dataTypes[0])||!r["*"]&&o("*")}function R(e,t){var i,n,o=Z.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((o[i]?e:n||(n={}))[i]=t[i]);return n&&Z.extend(!0,e,n),e}function j(e,t,i){for(var n,o,r,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(o in a)if(a[o]&&a[o].test(n)){l.unshift(o);break}if(l[0]in i)r=l[0];else{for(o in i){if(!l[0]||e.converters[o+" "+l[0]]){r=o;break}s||(s=o)}r=r||s}return r?(r!==l[0]&&l.unshift(r),i[r]):void 0}function q(e,t,i,n){var o,r,s,a,l,c={},d=e.dataTypes.slice();if(d[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(r=d.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=d.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(s=c[l+" "+r]||c["* "+r],!s)for(o in c)if(a=o.split(" "),a[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){s===!0?s=c[o]:c[o]!==!0&&(r=a[0],d.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(u){return{state:"parsererror",error:s?u:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}function L(e,t,i,n){var o;if(Z.isArray(t))Z.each(t,function(t,o){i||Et.test(e)?n(e,o):L(e+"["+("object"==typeof o?t:"")+"]",o,i,n)});else if(i||"object"!==Z.type(t))n(e,t);else for(o in t)L(e+"["+o+"]",t[o],i,n)}function G(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var U=[],H=U.slice,F=U.concat,B=U.push,W=U.indexOf,z={},Y=z.toString,X=z.hasOwnProperty,K={},J=e.document,Q="2.1.4",Z=function(e,t){return new Z.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ie=/-([\da-z])/gi,ne=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:Q,constructor:Z,selector:"",length:0,toArray:function(){return H.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:H.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Z.each(this,e,t)},map:function(e){return this.pushStack(Z.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(H.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:B,sort:U.sort,splice:U.splice},Z.extend=Z.fn.extend=function(){var e,t,i,n,o,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||Z.isFunction(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(e=arguments[a]))for(t in e)i=s[t],n=e[t],s!==n&&(c&&n&&(Z.isPlainObject(n)||(o=Z.isArray(n)))?(o?(o=!1,r=i&&Z.isArray(i)?i:[]):r=i&&Z.isPlainObject(i)?i:{},s[t]=Z.extend(c,r,n)):void 0!==n&&(s[t]=n));return s},Z.extend({expando:"jQuery"+(Q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Z.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Z.type(e)||e.nodeType||Z.isWindow(e)?!1:e.constructor&&!X.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?z[Y.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=Z.trim(e),e&&(1===e.indexOf("use strict")?(t=J.createElement("script"),t.text=e,J.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ie,ne)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var o,r=0,s=e.length,a=i(e);if(n){if(a)for(;s>r&&(o=t.apply(e[r],n),o!==!1);r++);else for(r in e)if(o=t.apply(e[r],n),o===!1)break}else if(a)for(;s>r&&(o=t.call(e[r],r,e[r]),o!==!1);r++);else for(r in e)if(o=t.call(e[r],r,e[r]),o===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?Z.merge(n,"string"==typeof e?[e]:e):B.call(n,e)),n},inArray:function(e,t,i){return null==t?-1:W.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,o=e.length;i>n;n++)e[o++]=t[n];return e.length=o,e},grep:function(e,t,i){for(var n,o=[],r=0,s=e.length,a=!i;s>r;r++)n=!t(e[r],r),n!==a&&o.push(e[r]);return o},map:function(e,t,n){var o,r=0,s=e.length,a=i(e),l=[];if(a)for(;s>r;r++)o=t(e[r],r,n),null!=o&&l.push(o);else for(r in e)o=t(e[r],r,n),null!=o&&l.push(o);return F.apply([],l)},guid:1,proxy:function(e,t){var i,n,o;return"string"==typeof t&&(i=e[t],t=e,e=i),Z.isFunction(e)?(n=H.call(arguments,2),o=function(){return e.apply(t||this,n.concat(H.call(arguments)))},o.guid=e.guid=e.guid||Z.guid++,o):void 0},now:Date.now,support:K}),Z.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){z["[object "+t+"]"]=t.toLowerCase()});var oe=function(e){function t(e,t,i,n){var o,r,s,a,l,c,u,h,f,m;if((t?t.ownerDocument||t:L)!==k&&I(t),t=t||k,i=i||[],a=t.nodeType,"string"!=typeof e||!e||1!==a&&9!==a&&11!==a)return i;if(!n&&A){if(11!==a&&(o=ge.exec(e)))if(s=o[1]){if(9===a){if(r=t.getElementById(s),!r||!r.parentNode)return i;if(r.id===s)return i.push(r),i}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(s))&&j(t,r)&&r.id===s)return i.push(r),i}else{if(o[2])return Q.apply(i,t.getElementsByTagName(e)),i;if((s=o[3])&&S.getElementsByClassName)return Q.apply(i,t.getElementsByClassName(s)),i}if(S.qsa&&(!P||!P.test(e))){if(h=u=q,f=t,m=1!==a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(c=x(e),(u=t.getAttribute("id"))?h=u.replace(be,"\\$&"):t.setAttribute("id",h),h="[id='"+h+"'] ",l=c.length;l--;)c[l]=h+p(c[l]);f=ye.test(e)&&d(t.parentNode)||t,m=c.join(",")}if(m)try{return Q.apply(i,f.querySelectorAll(m)),i}catch(_){}finally{u||t.removeAttribute("id")}}}return T(e.replace(le,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>C.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[q]=!0,e}function o(e){var t=k.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var i=e.split("|"),n=e.length;n--;)C.attrHandle[i[n]]=t}function s(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||z)-(~e.sourceIndex||z);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function a(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function l(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function c(e){return n(function(t){return t=+t,n(function(i,n){for(var o,r=e([],i.length,t),s=r.length;s--;)i[o=r[s]]&&(i[o]=!(n[o]=i[o]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function p(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function h(e,t,i){var n=t.dir,o=i&&"parentNode"===n,r=U++;return t.first?function(t,i,r){for(;t=t[n];)if(1===t.nodeType||o)return e(t,i,r)}:function(t,i,s){var a,l,c=[G,r];if(s){for(;t=t[n];)if((1===t.nodeType||o)&&e(t,i,s))return!0}else for(;t=t[n];)if(1===t.nodeType||o){if(l=t[q]||(t[q]={}),(a=l[n])&&a[0]===G&&a[1]===r)return c[2]=a[2];if(l[n]=c,c[2]=e(t,i,s))return!0}}}function f(e){return e.length>1?function(t,i,n){for(var o=e.length;o--;)if(!e[o](t,i,n))return!1;return!0}:e[0]}function m(e,i,n){for(var o=0,r=i.length;r>o;o++)t(e,i[o],n);return n}function _(e,t,i,n,o){for(var r,s=[],a=0,l=e.length,c=null!=t;l>a;a++)(r=e[a])&&(!i||i(r,n,o))&&(s.push(r),c&&t.push(a));return s}function v(e,t,i,o,r,s){return o&&!o[q]&&(o=v(o)),r&&!r[q]&&(r=v(r,s)),n(function(n,s,a,l){var c,d,u,p=[],h=[],f=s.length,v=n||m(t||"*",a.nodeType?[a]:a,[]),g=!e||!n&&t?v:_(v,p,e,a,l),y=i?r||(n?e:f||o)?[]:s:g;if(i&&i(g,y,a,l),o)for(c=_(y,h),o(c,[],a,l),d=c.length;d--;)(u=c[d])&&(y[h[d]]=!(g[h[d]]=u));if(n){if(r||e){if(r){for(c=[],d=y.length;d--;)(u=y[d])&&c.push(g[d]=u);r(null,y=[],c,l)}for(d=y.length;d--;)(u=y[d])&&(c=r?ee(n,u):p[d])>-1&&(n[c]=!(s[c]=u))}}else y=_(y===s?y.splice(f,y.length):y),r?r(null,s,y,l):Q.apply(s,y)})}function g(e){for(var t,i,n,o=e.length,r=C.relative[e[0].type],s=r||C.relative[" "],a=r?1:0,l=h(function(e){return e===t},s,!0),c=h(function(e){return ee(t,e)>-1},s,!0),d=[function(e,i,n){var o=!r&&(n||i!==D)||((t=i).nodeType?l(e,i,n):c(e,i,n));return t=null,o}];o>a;a++)if(i=C.relative[e[a].type])d=[h(f(d),i)];else{if(i=C.filter[e[a].type].apply(null,e[a].matches),i[q]){for(n=++a;o>n&&!C.relative[e[n].type];n++);return v(a>1&&f(d),a>1&&p(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(le,"$1"),i,n>a&&g(e.slice(a,n)),o>n&&g(e=e.slice(n)),o>n&&p(e))}d.push(i)}return f(d)}function y(e,i){var o=i.length>0,r=e.length>0,s=function(n,s,a,l,c){var d,u,p,h=0,f="0",m=n&&[],v=[],g=D,y=n||r&&C.find.TAG("*",c),b=G+=null==g?1:Math.random()||.1,S=y.length;for(c&&(D=s!==k&&s);f!==S&&null!=(d=y[f]);f++){if(r&&d){for(u=0;p=e[u++];)if(p(d,s,a)){l.push(d);break}c&&(G=b)}o&&((d=!p&&d)&&h--,n&&m.push(d))}if(h+=f,o&&f!==h){for(u=0;p=i[u++];)p(m,v,s,a);if(n){if(h>0)for(;f--;)m[f]||v[f]||(v[f]=K.call(l));v=_(v)}Q.apply(l,v),c&&!n&&v.length>0&&h+i.length>1&&t.uniqueSort(l)}return c&&(G=b,D=g),m};return o?n(s):s}var b,S,C,w,E,x,M,T,D,O,$,I,k,N,A,P,V,R,j,q="sizzle"+1*new Date,L=e.document,G=0,U=0,H=i(),F=i(),B=i(),W=function(e,t){return e===t&&($=!0),0},z=1<<31,Y={}.hasOwnProperty,X=[],K=X.pop,J=X.push,Q=X.push,Z=X.slice,ee=function(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe=ne.replace("w","w#"),re="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+oe+"))|)"+ie+"*\\]",se=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",ae=new RegExp(ie+"+","g"),le=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),ce=new RegExp("^"+ie+"*,"+ie+"*"),de=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ue=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),pe=new RegExp(se),he=new RegExp("^"+oe+"$"),fe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne.replace("w","w*")+")"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},me=/^(?:input|select|textarea|button)$/i,_e=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,be=/'|\\/g,Se=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),Ce=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},we=function(){I()};try{Q.apply(X=Z.call(L.childNodes),L.childNodes),X[L.childNodes.length].nodeType}catch(Ee){Q={apply:X.length?function(e,t){J.apply(e,Z.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}S=t.support={},E=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},I=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:L;return n!==k&&9===n.nodeType&&n.documentElement?(k=n,N=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",we,!1):i.attachEvent&&i.attachEvent("onunload",we)),A=!E(n),S.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),S.getElementsByTagName=o(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),S.getElementsByClassName=ve.test(n.getElementsByClassName),S.getById=o(function(e){return N.appendChild(e).id=q,!n.getElementsByName||!n.getElementsByName(q).length}),S.getById?(C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&A){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(e){var t=e.replace(Se,Ce);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(Se,Ce);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),C.find.TAG=S.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):S.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;i=r[o++];)1===i.nodeType&&n.push(i);return n}return r},C.find.CLASS=S.getElementsByClassName&&function(e,t){return A?t.getElementsByClassName(e):void 0},V=[],P=[],(S.qsa=ve.test(n.querySelectorAll))&&(o(function(e){N.appendChild(e).innerHTML="<a id='"+q+"'></a><select id='"+q+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&P.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||P.push("\\["+ie+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+q+"-]").length||P.push("~="),e.querySelectorAll(":checked").length||P.push(":checked"),e.querySelectorAll("a#"+q+"+*").length||P.push(".#.+[+~]")}),o(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&P.push("name"+ie+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||P.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),P.push(",.*:")})),(S.matchesSelector=ve.test(R=N.matches||N.webkitMatchesSelector||N.mozMatchesSelector||N.oMatchesSelector||N.msMatchesSelector))&&o(function(e){S.disconnectedMatch=R.call(e,"div"),R.call(e,"[s!='']:x"),V.push("!=",se)}),P=P.length&&new RegExp(P.join("|")),V=V.length&&new RegExp(V.join("|")),t=ve.test(N.compareDocumentPosition),j=t||ve.test(N.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},W=t?function(e,t){if(e===t)return $=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!S.sortDetached&&t.compareDocumentPosition(e)===i?e===n||e.ownerDocument===L&&j(L,e)?-1:t===n||t.ownerDocument===L&&j(L,t)?1:O?ee(O,e)-ee(O,t):0:4&i?-1:1)}:function(e,t){if(e===t)return $=!0,0;var i,o=0,r=e.parentNode,a=t.parentNode,l=[e],c=[t];if(!r||!a)return e===n?-1:t===n?1:r?-1:a?1:O?ee(O,e)-ee(O,t):0;if(r===a)return s(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[o]===c[o];)o++;return o?s(l[o],c[o]):l[o]===L?-1:c[o]===L?1:0},n):k},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==k&&I(e),i=i.replace(ue,"='$1']"),!(!S.matchesSelector||!A||V&&V.test(i)||P&&P.test(i)))try{var n=R.call(e,i);if(n||S.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(o){}return t(i,k,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==k&&I(e),j(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==k&&I(e);var i=C.attrHandle[t.toLowerCase()],n=i&&Y.call(C.attrHandle,t.toLowerCase())?i(e,t,!A):void 0;return void 0!==n?n:S.attributes||!A?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,o=0;if($=!S.detectDuplicates,O=!S.sortStable&&e.slice(0),e.sort(W),$){for(;t=e[o++];)t===e[o]&&(n=i.push(o));for(;n--;)e.splice(i[n],1)}return O=null,e},w=t.getText=function(e){var t,i="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=w(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=w(t);return i},C=t.selectors={cacheLength:50,createPseudo:n,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Se,Ce),e[3]=(e[3]||e[4]||e[5]||"").replace(Se,Ce),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&pe.test(i)&&(t=x(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Se,Ce).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&H(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(o){var r=t.attr(o,e);return null==r?"!="===i:i?(r+="","="===i?r===n:"!="===i?r!==n:"^="===i?n&&0===r.indexOf(n):"*="===i?n&&r.indexOf(n)>-1:"$="===i?n&&r.slice(-n.length)===n:"~="===i?(" "+r.replace(ae," ")+" ").indexOf(n)>-1:"|="===i?r===n||r.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,o){var r="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===o?function(e){return!!e.parentNode}:function(t,i,l){var c,d,u,p,h,f,m=r!==s?"nextSibling":"previousSibling",_=t.parentNode,v=a&&t.nodeName.toLowerCase(),g=!l&&!a;if(_){if(r){for(;m;){for(u=t;u=u[m];)if(a?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?_.firstChild:_.lastChild],s&&g){for(d=_[q]||(_[q]={}),c=d[e]||[],h=c[0]===G&&c[1],p=c[0]===G&&c[2],u=h&&_.childNodes[h];u=++h&&u&&u[m]||(p=h=0)||f.pop();)if(1===u.nodeType&&++p&&u===t){d[e]=[G,h,p];break}}else if(g&&(c=(t[q]||(t[q]={}))[e])&&c[0]===G)p=c[1];else for(;(u=++h&&u&&u[m]||(p=h=0)||f.pop())&&((a?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++p||(g&&((u[q]||(u[q]={}))[e]=[G,p]),u!==t)););return p-=o,p===n||p%n===0&&p/n>=0}}},PSEUDO:function(e,i){var o,r=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[q]?r(i):r.length>1?(o=[e,e,"",i],C.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,o=r(e,i),s=o.length;s--;)n=ee(e,o[s]),e[n]=!(t[n]=o[s])}):function(e){return r(e,0,o)}):r}},pseudos:{not:n(function(e){var t=[],i=[],o=M(e.replace(le,"$1"));return o[q]?n(function(e,t,i,n){for(var r,s=o(e,null,n,[]),a=e.length;a--;)(r=s[a])&&(e[a]=!(t[a]=r))}):function(e,n,r){return t[0]=e,o(t,null,r,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(Se,Ce),function(t){return(t.textContent||t.innerText||w(t)).indexOf(e)>-1}}),lang:n(function(e){return he.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(Se,Ce).toLowerCase(),function(t){var i;do if(i=A?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===N},focus:function(e){return e===k.activeElement&&(!k.hasFocus||k.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return _e.test(e.nodeName)},input:function(e){return me.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[0>i?i+t:i]}),even:c(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:c(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:c(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:c(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}},C.pseudos.nth=C.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[b]=a(b);for(b in{submit:!0,reset:!0})C.pseudos[b]=l(b);return u.prototype=C.filters=C.pseudos,C.setFilters=new u,x=t.tokenize=function(e,i){var n,o,r,s,a,l,c,d=F[e+" "];if(d)return i?0:d.slice(0);for(a=e,l=[],c=C.preFilter;a;){(!n||(o=ce.exec(a)))&&(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),n=!1,(o=de.exec(a))&&(n=o.shift(),r.push({value:n,type:o[0].replace(le," ")}),a=a.slice(n.length));for(s in C.filter)!(o=fe[s].exec(a))||c[s]&&!(o=c[s](o))||(n=o.shift(),r.push({value:n,type:s,matches:o}),a=a.slice(n.length));if(!n)break}return i?a.length:a?t.error(e):F(e,l).slice(0)},M=t.compile=function(e,t){var i,n=[],o=[],r=B[e+" "];if(!r){for(t||(t=x(e)),i=t.length;i--;)r=g(t[i]),r[q]?n.push(r):o.push(r);r=B(e,y(o,n)),r.selector=e}return r},T=t.select=function(e,t,i,n){var o,r,s,a,l,c="function"==typeof e&&e,u=!n&&x(e=c.selector||e);if(i=i||[],1===u.length){if(r=u[0]=u[0].slice(0),r.length>2&&"ID"===(s=r[0]).type&&S.getById&&9===t.nodeType&&A&&C.relative[r[1].type]){if(t=(C.find.ID(s.matches[0].replace(Se,Ce),t)||[])[0],!t)return i;c&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(o=fe.needsContext.test(e)?0:r.length;o--&&(s=r[o],!C.relative[a=s.type]);)if((l=C.find[a])&&(n=l(s.matches[0].replace(Se,Ce),ye.test(r[0].type)&&d(t.parentNode)||t))){if(r.splice(o,1),e=n.length&&p(r),!e)return Q.apply(i,n),i;break}}return(c||M(e,u))(n,t,!A,i,ye.test(e)&&d(t.parentNode)||t),i},S.sortStable=q.split("").sort(W).join("")===q,S.detectDuplicates=!!$,I(),S.sortDetached=o(function(e){return 1&e.compareDocumentPosition(k.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||r("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),S.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||r("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||r(te,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);Z.find=oe,Z.expr=oe.selectors,Z.expr[":"]=Z.expr.pseudos,Z.unique=oe.uniqueSort,Z.text=oe.getText,Z.isXMLDoc=oe.isXML,Z.contains=oe.contains;var re=Z.expr.match.needsContext,se=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ae=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?Z.find.matchesSelector(n,e)?[n]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,i=this.length,n=[],o=this;
if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;i>t;t++)if(Z.contains(o[t],this))return!0}));for(t=0;i>t;t++)Z.find(e,o[t],n);return n=this.pushStack(i>1?Z.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&re.test(e)?Z(e):e||[],!1).length}});var le,ce=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,de=Z.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ce.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||le).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:J,!0)),se.test(i[1])&&Z.isPlainObject(t))for(i in t)Z.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return n=J.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=J,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?"undefined"!=typeof le.ready?le.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this))};de.prototype=Z.fn,le=Z(J);var ue=/^(?:parents|prev(?:Until|All))/,pe={children:!0,contents:!0,next:!0,prev:!0};Z.extend({dir:function(e,t,i){for(var n=[],o=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&Z(e).is(i))break;n.push(e)}return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),Z.fn.extend({has:function(e){var t=Z(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,n=0,o=this.length,r=[],s=re.test(e)||"string"!=typeof e?Z(e,t||this.context):0;o>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&Z.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(r.length>1?Z.unique(r):r)},index:function(e){return e?"string"==typeof e?W.call(Z(e),this[0]):W.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.unique(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Z.dir(e,"parentNode")},parentsUntil:function(e,t,i){return Z.dir(e,"parentNode",i)},next:function(e){return o(e,"nextSibling")},prev:function(e){return o(e,"previousSibling")},nextAll:function(e){return Z.dir(e,"nextSibling")},prevAll:function(e){return Z.dir(e,"previousSibling")},nextUntil:function(e,t,i){return Z.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return Z.dir(e,"previousSibling",i)},siblings:function(e){return Z.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Z.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(e,t){Z.fn[e]=function(i,n){var o=Z.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=Z.filter(n,o)),this.length>1&&(pe[e]||Z.unique(o),ue.test(e)&&o.reverse()),this.pushStack(o)}});var he=/\S+/g,fe={};Z.Callbacks=function(e){e="string"==typeof e?fe[e]||r(e):Z.extend({},e);var t,i,n,o,s,a,l=[],c=!e.once&&[],d=function(r){for(t=e.memory&&r,i=!0,a=o||0,o=0,s=l.length,n=!0;l&&s>a;a++)if(l[a].apply(r[0],r[1])===!1&&e.stopOnFalse){t=!1;break}n=!1,l&&(c?c.length&&d(c.shift()):t?l=[]:u.disable())},u={add:function(){if(l){var i=l.length;!function r(t){Z.each(t,function(t,i){var n=Z.type(i);"function"===n?e.unique&&u.has(i)||l.push(i):i&&i.length&&"string"!==n&&r(i)})}(arguments),n?s=l.length:t&&(o=i,d(t))}return this},remove:function(){return l&&Z.each(arguments,function(e,t){for(var i;(i=Z.inArray(t,l,i))>-1;)l.splice(i,1),n&&(s>=i&&s--,a>=i&&a--)}),this},has:function(e){return e?Z.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=c=t=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,t||u.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||i&&!c||(t=t||[],t=[e,t.slice?t.slice():t],n?c.push(t):d(t)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},Z.extend({Deferred:function(e){var t=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Z.Deferred(function(i){Z.each(t,function(t,r){var s=Z.isFunction(e[t])&&e[t];o[r[1]](function(){var e=s&&s.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r[0]+"With"](this===n?i.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Z.extend(e,n):n}},o={};return n.pipe=n.then,Z.each(t,function(e,r){var s=r[2],a=r[3];n[r[1]]=s.add,a&&s.add(function(){i=a},t[1^e][2].disable,t[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?n:this,arguments),this},o[r[0]+"With"]=s.fireWith}),n.promise(o),e&&e.call(o,o),o},when:function(e){var t,i,n,o=0,r=H.call(arguments),s=r.length,a=1!==s||e&&Z.isFunction(e.promise)?s:0,l=1===a?e:Z.Deferred(),c=function(e,i,n){return function(o){i[e]=this,n[e]=arguments.length>1?H.call(arguments):o,n===t?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(s>1)for(t=new Array(s),i=new Array(s),n=new Array(s);s>o;o++)r[o]&&Z.isFunction(r[o].promise)?r[o].promise().done(c(o,n,r)).fail(l.reject).progress(c(o,i,t)):--a;return a||l.resolveWith(n,r),l.promise()}});var me;Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(e===!0?--Z.readyWait:Z.isReady)||(Z.isReady=!0,e!==!0&&--Z.readyWait>0||(me.resolveWith(J,[Z]),Z.fn.triggerHandler&&(Z(J).triggerHandler("ready"),Z(J).off("ready"))))}}),Z.ready.promise=function(t){return me||(me=Z.Deferred(),"complete"===J.readyState?setTimeout(Z.ready):(J.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1))),me.promise(t)},Z.ready.promise();var _e=Z.access=function(e,t,i,n,o,r,s){var a=0,l=e.length,c=null==i;if("object"===Z.type(i)){o=!0;for(a in i)Z.access(e,t,a,i[a],!0,r,s)}else if(void 0!==n&&(o=!0,Z.isFunction(n)||(s=!0),c&&(s?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(Z(e),i)})),t))for(;l>a;a++)t(e[a],i,s?n:n.call(e[a],a,t(e[a],i)));return o?e:c?t.call(e):l?t(e[0],i):r};Z.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},a.uid=1,a.accepts=Z.acceptData,a.prototype={key:function(e){if(!a.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=a.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(n){t[this.expando]=i,Z.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var n,o=this.key(e),r=this.cache[o];if("string"==typeof t)r[t]=i;else if(Z.isEmptyObject(r))Z.extend(this.cache[o],t);else for(n in t)r[n]=t[n];return r},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?(n=this.get(e,t),void 0!==n?n:this.get(e,Z.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,o,r=this.key(e),s=this.cache[r];if(void 0===t)this.cache[r]={};else{Z.isArray(t)?n=t.concat(t.map(Z.camelCase)):(o=Z.camelCase(t),t in s?n=[t,o]:(n=o,n=n in s?[n]:n.match(he)||[])),i=n.length;for(;i--;)delete s[n[i]]}},hasData:function(e){return!Z.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var ve=new a,ge=new a,ye=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,be=/([A-Z])/g;Z.extend({hasData:function(e){return ge.hasData(e)||ve.hasData(e)},data:function(e,t,i){return ge.access(e,t,i)},removeData:function(e,t){ge.remove(e,t)},_data:function(e,t,i){return ve.access(e,t,i)},_removeData:function(e,t){ve.remove(e,t)}}),Z.fn.extend({data:function(e,t){var i,n,o,r=this[0],s=r&&r.attributes;if(void 0===e){if(this.length&&(o=ge.get(r),1===r.nodeType&&!ve.get(r,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=Z.camelCase(n.slice(5)),l(r,n,o[n])));ve.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){ge.set(this,e)}):_e(this,function(t){var i,n=Z.camelCase(e);if(r&&void 0===t){if(i=ge.get(r,e),void 0!==i)return i;if(i=ge.get(r,n),void 0!==i)return i;if(i=l(r,n,void 0),void 0!==i)return i}else this.each(function(){var i=ge.get(this,n);ge.set(this,n,t),-1!==e.indexOf("-")&&void 0!==i&&ge.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ge.remove(this,e)})}}),Z.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=ve.get(e,t),i&&(!n||Z.isArray(i)?n=ve.access(e,t,Z.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=Z.queue(e,t),n=i.length,o=i.shift(),r=Z._queueHooks(e,t),s=function(){Z.dequeue(e,t)};"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===t&&i.unshift("inprogress"),delete r.stop,o.call(e,s,r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ve.get(e,i)||ve.access(e,i,{empty:Z.Callbacks("once memory").add(function(){ve.remove(e,[t+"queue",i])})})}}),Z.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Z.queue(this[0],e):void 0===t?this:this.each(function(){var i=Z.queue(this,e,t);Z._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Z.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,o=Z.Deferred(),r=this,s=this.length,a=function(){--n||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)i=ve.get(r[s],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(a));return a(),o.promise(t)}});var Se=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ce=["Top","Right","Bottom","Left"],we=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},Ee=/^(?:checkbox|radio)$/i;!function(){var e=J.createDocumentFragment(),t=e.appendChild(J.createElement("div")),i=J.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),K.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",K.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var xe="undefined";K.focusinBubbles="onfocusin"in e;var Me=/^key/,Te=/^(?:mouse|pointer|contextmenu)|click/,De=/^(?:focusinfocus|focusoutblur)$/,Oe=/^([^.]*)(?:\.(.+)|)$/;Z.event={global:{},add:function(e,t,i,n,o){var r,s,a,l,c,d,u,p,h,f,m,_=ve.get(e);if(_)for(i.handler&&(r=i,i=r.handler,o=r.selector),i.guid||(i.guid=Z.guid++),(l=_.events)||(l=_.events={}),(s=_.handle)||(s=_.handle=function(t){return typeof Z!==xe&&Z.event.triggered!==t.type?Z.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(he)||[""],c=t.length;c--;)a=Oe.exec(t[c])||[],h=m=a[1],f=(a[2]||"").split(".").sort(),h&&(u=Z.event.special[h]||{},h=(o?u.delegateType:u.bindType)||h,u=Z.event.special[h]||{},d=Z.extend({type:h,origType:m,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&Z.expr.match.needsContext.test(o),namespace:f.join(".")},r),(p=l[h])||(p=l[h]=[],p.delegateCount=0,u.setup&&u.setup.call(e,n,f,s)!==!1||e.addEventListener&&e.addEventListener(h,s,!1)),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),Z.event.global[h]=!0)},remove:function(e,t,i,n,o){var r,s,a,l,c,d,u,p,h,f,m,_=ve.hasData(e)&&ve.get(e);if(_&&(l=_.events)){for(t=(t||"").match(he)||[""],c=t.length;c--;)if(a=Oe.exec(t[c])||[],h=m=a[1],f=(a[2]||"").split(".").sort(),h){for(u=Z.event.special[h]||{},h=(n?u.delegateType:u.bindType)||h,p=l[h]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=p.length;r--;)d=p[r],!o&&m!==d.origType||i&&i.guid!==d.guid||a&&!a.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(p.splice(r,1),d.selector&&p.delegateCount--,u.remove&&u.remove.call(e,d));s&&!p.length&&(u.teardown&&u.teardown.call(e,f,_.handle)!==!1||Z.removeEvent(e,h,_.handle),delete l[h])}else for(h in l)Z.event.remove(e,h+t[c],i,n,!0);Z.isEmptyObject(l)&&(delete _.handle,ve.remove(e,"events"))}},trigger:function(t,i,n,o){var r,s,a,l,c,d,u,p=[n||J],h=X.call(t,"type")?t.type:t,f=X.call(t,"namespace")?t.namespace.split("."):[];if(s=a=n=n||J,3!==n.nodeType&&8!==n.nodeType&&!De.test(h+Z.event.triggered)&&(h.indexOf(".")>=0&&(f=h.split("."),h=f.shift(),f.sort()),c=h.indexOf(":")<0&&"on"+h,t=t[Z.expando]?t:new Z.Event(h,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:Z.makeArray(i,[t]),u=Z.event.special[h]||{},o||!u.trigger||u.trigger.apply(n,i)!==!1)){if(!o&&!u.noBubble&&!Z.isWindow(n)){for(l=u.delegateType||h,De.test(l+h)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(n.ownerDocument||J)&&p.push(a.defaultView||a.parentWindow||e)}for(r=0;(s=p[r++])&&!t.isPropagationStopped();)t.type=r>1?l:u.bindType||h,d=(ve.get(s,"events")||{})[t.type]&&ve.get(s,"handle"),d&&d.apply(s,i),d=c&&s[c],d&&d.apply&&Z.acceptData(s)&&(t.result=d.apply(s,i),t.result===!1&&t.preventDefault());return t.type=h,o||t.isDefaultPrevented()||u._default&&u._default.apply(p.pop(),i)!==!1||!Z.acceptData(n)||c&&Z.isFunction(n[h])&&!Z.isWindow(n)&&(a=n[c],a&&(n[c]=null),Z.event.triggered=h,n[h](),Z.event.triggered=void 0,a&&(n[c]=a)),t.result}},dispatch:function(e){e=Z.event.fix(e);var t,i,n,o,r,s=[],a=H.call(arguments),l=(ve.get(this,"events")||{})[e.type]||[],c=Z.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(s=Z.event.handlers.call(this,e,l),t=0;(o=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,i=0;(r=o.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,n=((Z.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,a),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,o,r,s=[],a=t.delegateCount,l=e.target;if(a&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(n=[],i=0;a>i;i++)r=t[i],o=r.selector+" ",void 0===n[o]&&(n[o]=r.needsContext?Z(o,this).index(l)>=0:Z.find(o,this,null,[l]).length),n[o]&&n.push(r);n.length&&s.push({elem:l,handlers:n})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,o,r=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||J,n=i.documentElement,o=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,i,n,o=e.type,r=e,s=this.fixHooks[o];for(s||(this.fixHooks[o]=s=Te.test(o)?this.mouseHooks:Me.test(o)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,e=new Z.Event(r),t=n.length;t--;)i=n[t],e[i]=r[i];return e.target||(e.target=J),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Z.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var o=Z.extend(new Z.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?Z.event.trigger(o,null,t):Z.event.dispatch.call(t,o),o.isDefaultPrevented()&&i.preventDefault()}},Z.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},Z.Event=function(e,t){return this instanceof Z.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?c:d):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(e,t)},Z.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=c,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=c,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=c,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Z.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,o=e.relatedTarget,r=e.handleObj;return(!o||o!==n&&!Z.contains(n,o))&&(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}}),K.focusinBubbles||Z.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){Z.event.simulate(t,e.target,Z.event.fix(e),!0)};Z.event.special[t]={setup:function(){var n=this.ownerDocument||this,o=ve.access(n,t);o||n.addEventListener(e,i,!0),ve.access(n,t,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=ve.access(n,t)-1;o?ve.access(n,t,o):(n.removeEventListener(e,i,!0),ve.remove(n,t))}}}),Z.fn.extend({on:function(e,t,i,n,o){var r,s;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(s in e)this.on(s,t,i,e[s],o);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=d;else if(!n)return this;return 1===o&&(r=n,n=function(e){return Z().off(e),r.apply(this,arguments)},n.guid=r.guid||(r.guid=Z.guid++)),this.each(function(){Z.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Z(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=d),this.each(function(){Z.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?Z.event.trigger(e,t,i,!0):void 0}});var $e=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ie=/<([\w:]+)/,ke=/<|&#?\w+;/,Ne=/<(?:script|style|link)/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Pe=/^$|\/(?:java|ecma)script/i,Ve=/^true\/(.*)/,Re=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,je={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};je.optgroup=je.option,je.tbody=je.tfoot=je.colgroup=je.caption=je.thead,je.th=je.td,Z.extend({clone:function(e,t,i){var n,o,r,s,a=e.cloneNode(!0),l=Z.contains(e.ownerDocument,e);if(!(K.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(s=v(a),r=v(e),n=0,o=r.length;o>n;n++)g(r[n],s[n]);if(t)if(i)for(r=r||v(e),s=s||v(a),n=0,o=r.length;o>n;n++)_(r[n],s[n]);else _(e,a);return s=v(a,"script"),s.length>0&&m(s,!l&&v(e,"script")),a},buildFragment:function(e,t,i,n){for(var o,r,s,a,l,c,d=t.createDocumentFragment(),u=[],p=0,h=e.length;h>p;p++)if(o=e[p],o||0===o)if("object"===Z.type(o))Z.merge(u,o.nodeType?[o]:o);else if(ke.test(o)){for(r=r||d.appendChild(t.createElement("div")),s=(Ie.exec(o)||["",""])[1].toLowerCase(),a=je[s]||je._default,r.innerHTML=a[1]+o.replace($e,"<$1></$2>")+a[2],c=a[0];c--;)r=r.lastChild;Z.merge(u,r.childNodes),r=d.firstChild,r.textContent=""}else u.push(t.createTextNode(o));for(d.textContent="",p=0;o=u[p++];)if((!n||-1===Z.inArray(o,n))&&(l=Z.contains(o.ownerDocument,o),r=v(d.appendChild(o),"script"),l&&m(r),i))for(c=0;o=r[c++];)Pe.test(o.type||"")&&i.push(o);return d},cleanData:function(e){for(var t,i,n,o,r=Z.event.special,s=0;void 0!==(i=e[s]);s++){if(Z.acceptData(i)&&(o=i[ve.expando],o&&(t=ve.cache[o]))){if(t.events)for(n in t.events)r[n]?Z.event.remove(i,n):Z.removeEvent(i,n,t.handle);ve.cache[o]&&delete ve.cache[o]}delete ge.cache[i[ge.expando]]}}}),Z.fn.extend({text:function(e){return _e(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?Z.filter(e,this):this,o=0;null!=(i=n[o]);o++)t||1!==i.nodeType||Z.cleanData(v(i)),i.parentNode&&(t&&Z.contains(i.ownerDocument,i)&&m(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return _e(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ne.test(e)&&!je[(Ie.exec(e)||["",""])[1].toLowerCase()]){e=e.replace($e,"<$1></$2>");try{for(;n>i;i++)t=this[i]||{},1===t.nodeType&&(Z.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Z.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=F.apply([],e);var i,n,o,r,s,a,l=0,c=this.length,d=this,u=c-1,p=e[0],m=Z.isFunction(p);if(m||c>1&&"string"==typeof p&&!K.checkClone&&Ae.test(p))return this.each(function(i){var n=d.eq(i);m&&(e[0]=p.call(this,i,n.html())),n.domManip(e,t)});if(c&&(i=Z.buildFragment(e,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(o=Z.map(v(i,"script"),h),r=o.length;c>l;l++)s=i,l!==u&&(s=Z.clone(s,!0,!0),r&&Z.merge(o,v(s,"script"))),t.call(this[l],s,l);if(r)for(a=o[o.length-1].ownerDocument,Z.map(o,f),l=0;r>l;l++)s=o[l],Pe.test(s.type||"")&&!ve.access(s,"globalEval")&&Z.contains(a,s)&&(s.src?Z._evalUrl&&Z._evalUrl(s.src):Z.globalEval(s.textContent.replace(Re,"")))}return this}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Z.fn[e]=function(e){for(var i,n=[],o=Z(e),r=o.length-1,s=0;r>=s;s++)i=s===r?this:this.clone(!0),Z(o[s])[t](i),B.apply(n,i.get());return this.pushStack(n)}});var qe,Le={},Ge=/^margin/,Ue=new RegExp("^("+Se+")(?!px)[a-z%]+$","i"),He=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",o.appendChild(r);var t=e.getComputedStyle(s,null);i="1%"!==t.top,n="4px"===t.width,o.removeChild(r)}var i,n,o=J.documentElement,r=J.createElement("div"),s=J.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",K.clearCloneStyle="content-box"===s.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(s),e.getComputedStyle&&Z.extend(K,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==n&&t(),n},reliableMarginRight:function(){var t,i=s.appendChild(J.createElement("div"));return i.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",s.style.width="1px",o.appendChild(r),t=!parseFloat(e.getComputedStyle(i,null).marginRight),o.removeChild(r),s.removeChild(i),t}}))}(),Z.swap=function(e,t,i,n){var o,r,s={};for(r in t)s[r]=e.style[r],e.style[r]=t[r];o=i.apply(e,n||[]);for(r in t)e.style[r]=s[r];return o};var Fe=/^(none|table(?!-c[ea]).+)/,Be=new RegExp("^("+Se+")(.*)$","i"),We=new RegExp("^([+-])=("+Se+")","i"),ze={position:"absolute",visibility:"hidden",display:"block"},Ye={letterSpacing:"0",fontWeight:"400"},Xe=["Webkit","O","Moz","ms"];Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=S(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,s,a=Z.camelCase(t),l=e.style;return t=Z.cssProps[a]||(Z.cssProps[a]=w(l,a)),s=Z.cssHooks[t]||Z.cssHooks[a],void 0===i?s&&"get"in s&&void 0!==(o=s.get(e,!1,n))?o:l[t]:(r=typeof i,"string"===r&&(o=We.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(Z.css(e,t)),r="number"),void(null!=i&&i===i&&("number"!==r||Z.cssNumber[a]||(i+="px"),K.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(i=s.set(e,i,n))||(l[t]=i))))}},css:function(e,t,i,n){var o,r,s,a=Z.camelCase(t);return t=Z.cssProps[a]||(Z.cssProps[a]=w(e.style,a)),s=Z.cssHooks[t]||Z.cssHooks[a],s&&"get"in s&&(o=s.get(e,!0,i)),void 0===o&&(o=S(e,t,n)),"normal"===o&&t in Ye&&(o=Ye[t]),""===i||i?(r=parseFloat(o),i===!0||Z.isNumeric(r)?r||0:o):o}}),Z.each(["height","width"],function(e,t){Z.cssHooks[t]={get:function(e,i,n){return i?Fe.test(Z.css(e,"display"))&&0===e.offsetWidth?Z.swap(e,ze,function(){return M(e,t,n)}):M(e,t,n):void 0},set:function(e,i,n){var o=n&&He(e);return E(e,i,n?x(e,t,n,"border-box"===Z.css(e,"boxSizing",!1,o),o):0)}}}),Z.cssHooks.marginRight=C(K.reliableMarginRight,function(e,t){return t?Z.swap(e,{display:"inline-block"},S,[e,"marginRight"]):void 0}),Z.each({margin:"",padding:"",border:"Width"},function(e,t){Z.cssHooks[e+t]={expand:function(i){for(var n=0,o={},r="string"==typeof i?i.split(" "):[i];4>n;n++)o[e+Ce[n]+t]=r[n]||r[n-2]||r[0];return o}},Ge.test(e)||(Z.cssHooks[e+t].set=E)}),Z.fn.extend({css:function(e,t){return _e(this,function(e,t,i){var n,o,r={},s=0;if(Z.isArray(t)){for(n=He(e),o=t.length;o>s;s++)r[t[s]]=Z.css(e,t[s],!1,n);return r}return void 0!==i?Z.style(e,t,i):Z.css(e,t)},e,t,arguments.length>1)},show:function(){return T(this,!0)},hide:function(){return T(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){we(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=D,D.prototype={constructor:D,init:function(e,t,i,n,o,r){this.elem=e,this.prop=i,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(Z.cssNumber[i]?"":"px")},cur:function(){var e=D.propHooks[this.prop];return e&&e.get?e.get(this):D.propHooks._default.get(this)},run:function(e){var t,i=D.propHooks[this.prop];return this.options.duration?this.pos=t=Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):D.propHooks._default.set(this),this}},D.prototype.init.prototype=D.prototype,D.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Z.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Z.cssProps[e.prop]]||Z.cssHooks[e.prop])?Z.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},D.propHooks.scrollTop=D.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Z.fx=D.prototype.init,Z.fx.step={};var Ke,Je,Qe=/^(?:toggle|show|hide)$/,Ze=new RegExp("^(?:([+-])=|)("+Se+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[k],it={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),o=Ze.exec(t),r=o&&o[3]||(Z.cssNumber[e]?"":"px"),s=(Z.cssNumber[e]||"px"!==r&&+n)&&Ze.exec(Z.css(i.elem,e)),a=1,l=20;if(s&&s[3]!==r){r=r||s[3],o=o||[],s=+n||1;do a=a||".5",s/=a,Z.style(i.elem,e,s+r);while(a!==(a=i.cur()/n)&&1!==a&&--l)}return o&&(s=i.start=+s||+n||0,i.unit=r,i.end=o[1]?s+(o[1]+1)*o[2]:+o[2]),i}]};Z.Animation=Z.extend(A,{tweener:function(e,t){Z.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,o=e.length;o>n;n++)i=e[n],it[i]=it[i]||[],it[i].unshift(t)},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}}),Z.speed=function(e,t,i){var n=e&&"object"==typeof e?Z.extend({},e):{complete:i||!i&&t||Z.isFunction(e)&&e,duration:e,easing:i&&t||t&&!Z.isFunction(t)&&t};return n.duration=Z.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in Z.fx.speeds?Z.fx.speeds[n.duration]:Z.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){Z.isFunction(n.old)&&n.old.call(this),n.queue&&Z.dequeue(this,n.queue)},n},Z.fn.extend({fadeTo:function(e,t,i,n){return this.filter(we).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var o=Z.isEmptyObject(e),r=Z.speed(t,i,n),s=function(){var t=A(this,Z.extend({},e),r);(o||ve.get(this,"finish"))&&t.stop(!0)};return s.finish=s,o||r.queue===!1?this.each(s):this.queue(r.queue,s)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",r=Z.timers,s=ve.get(this);if(o)s[o]&&s[o].stop&&n(s[o]);else for(o in s)s[o]&&s[o].stop&&et.test(o)&&n(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(i),t=!1,r.splice(o,1));(t||!i)&&Z.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ve.get(this),n=i[e+"queue"],o=i[e+"queueHooks"],r=Z.timers,s=n?n.length:0;for(i.finish=!0,Z.queue(this,e,[]),
o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;s>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),Z.each(["toggle","show","hide"],function(e,t){var i=Z.fn[t];Z.fn[t]=function(e,n,o){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate($(t,!0),e,n,o)}}),Z.each({slideDown:$("show"),slideUp:$("hide"),slideToggle:$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Z.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,i=Z.timers;for(Ke=Z.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||Z.fx.stop(),Ke=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Je||(Je=setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){clearInterval(Je),Je=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(e,t){return e=Z.fx?Z.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e=J.createElement("input"),t=J.createElement("select"),i=t.appendChild(J.createElement("option"));e.type="checkbox",K.checkOn=""!==e.value,K.optSelected=i.selected,t.disabled=!0,K.optDisabled=!i.disabled,e=J.createElement("input"),e.value="t",e.type="radio",K.radioValue="t"===e.value}();var nt,ot,rt=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return _e(this,Z.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,i){var n,o,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?typeof e.getAttribute===xe?Z.prop(e,t,i):(1===r&&Z.isXMLDoc(e)||(t=t.toLowerCase(),n=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?ot:nt)),void 0===i?n&&"get"in n&&null!==(o=n.get(e,t))?o:(o=Z.find.attr(e,t),null==o?void 0:o):null!==i?n&&"set"in n&&void 0!==(o=n.set(e,i,t))?o:(e.setAttribute(t,i+""),i):void Z.removeAttr(e,t)):void 0},removeAttr:function(e,t){var i,n,o=0,r=t&&t.match(he);if(r&&1===e.nodeType)for(;i=r[o++];)n=Z.propFix[i]||i,Z.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!K.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),ot={set:function(e,t,i){return t===!1?Z.removeAttr(e,i):e.setAttribute(i,i),i}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var i=rt[t]||Z.find.attr;rt[t]=function(e,t,n){var o,r;return n||(r=rt[t],rt[t]=o,o=null!=i(e,t,n)?t.toLowerCase():null,rt[t]=r),o}});var st=/^(?:input|select|textarea|button)$/i;Z.fn.extend({prop:function(e,t){return _e(this,Z.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var n,o,r,s=e.nodeType;return e&&3!==s&&8!==s&&2!==s?(r=1!==s||!Z.isXMLDoc(e),r&&(t=Z.propFix[t]||t,o=Z.propHooks[t]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:e[t]=i:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]):void 0},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||st.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),K.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var at=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(e){var t,i,n,o,r,s,a="string"==typeof e&&e,l=0,c=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(he)||[];c>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(at," "):" ")){for(r=0;o=t[r++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");s=Z.trim(n),i.className!==s&&(i.className=s)}return this},removeClass:function(e){var t,i,n,o,r,s,a=0===arguments.length||"string"==typeof e&&e,l=0,c=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(he)||[];c>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(at," "):"")){for(r=0;o=t[r++];)for(;n.indexOf(" "+o+" ")>=0;)n=n.replace(" "+o+" "," ");s=e?Z.trim(n):"",i.className!==s&&(i.className=s)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):this.each(Z.isFunction(e)?function(i){Z(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var t,n=0,o=Z(this),r=e.match(he)||[];t=r[n++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(i===xe||"boolean"===i)&&(this.className&&ve.set(this,"__className__",this.className),this.className=this.className||e===!1?"":ve.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(at," ").indexOf(t)>=0)return!0;return!1}});var lt=/\r/g;Z.fn.extend({val:function(e){var t,i,n,o=this[0];return arguments.length?(n=Z.isFunction(e),this.each(function(i){var o;1===this.nodeType&&(o=n?e.call(this,i,Z(this).val()):e,null==o?o="":"number"==typeof o?o+="":Z.isArray(o)&&(o=Z.map(o,function(e){return null==e?"":e+""})),t=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))})):o?(t=Z.valHooks[o.type]||Z.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(o,"value"))?i:(i=o.value,"string"==typeof i?i.replace(lt,""):null==i?"":i)):void 0}}),Z.extend({valHooks:{option:{get:function(e){var t=Z.find.attr(e,"value");return null!=t?t:Z.trim(Z.text(e))}},select:{get:function(e){for(var t,i,n=e.options,o=e.selectedIndex,r="select-one"===e.type||0>o,s=r?null:[],a=r?o+1:n.length,l=0>o?a:r?o:0;a>l;l++)if(i=n[l],!(!i.selected&&l!==o||(K.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&Z.nodeName(i.parentNode,"optgroup"))){if(t=Z(i).val(),r)return t;s.push(t)}return s},set:function(e,t){for(var i,n,o=e.options,r=Z.makeArray(t),s=o.length;s--;)n=o[s],(n.selected=Z.inArray(n.value,r)>=0)&&(i=!0);return i||(e.selectedIndex=-1),r}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){return Z.isArray(t)?e.checked=Z.inArray(Z(e).val(),t)>=0:void 0}},K.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Z.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var ct=Z.now(),dt=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,t=i.parseFromString(e,"text/xml")}catch(n){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Z.error("Invalid XML: "+e),t};var ut=/#.*$/,pt=/([?&])_=[^&]*/,ht=/^(.*?):[ \t]*([^\r\n]*)$/gm,ft=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,mt=/^(?:GET|HEAD)$/,_t=/^\/\//,vt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,gt={},yt={},bt="*/".concat("*"),St=e.location.href,Ct=vt.exec(St.toLowerCase())||[];Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:St,type:"GET",isLocal:ft.test(Ct[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":bt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?R(R(e,Z.ajaxSettings),t):R(Z.ajaxSettings,e)},ajaxPrefilter:P(gt),ajaxTransport:P(yt),ajax:function(e,t){function i(e,t,i,s){var l,d,v,g,b,C=t;2!==y&&(y=2,a&&clearTimeout(a),n=void 0,r=s||"",S.readyState=e>0?4:0,l=e>=200&&300>e||304===e,i&&(g=j(u,S,i)),g=q(u,g,S,l),l?(u.ifModified&&(b=S.getResponseHeader("Last-Modified"),b&&(Z.lastModified[o]=b),b=S.getResponseHeader("etag"),b&&(Z.etag[o]=b)),204===e||"HEAD"===u.type?C="nocontent":304===e?C="notmodified":(C=g.state,d=g.data,v=g.error,l=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),S.status=e,S.statusText=(t||C)+"",l?f.resolveWith(p,[d,C,S]):f.rejectWith(p,[S,C,v]),S.statusCode(_),_=void 0,c&&h.trigger(l?"ajaxSuccess":"ajaxError",[S,u,l?d:v]),m.fireWith(p,[S,C]),c&&(h.trigger("ajaxComplete",[S,u]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o,r,s,a,l,c,d,u=Z.ajaxSetup({},t),p=u.context||u,h=u.context&&(p.nodeType||p.jquery)?Z(p):Z.event,f=Z.Deferred(),m=Z.Callbacks("once memory"),_=u.statusCode||{},v={},g={},y=0,b="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s)for(s={};t=ht.exec(r);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?r:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return y||(e=g[i]=g[i]||e,v[e]=t),this},overrideMimeType:function(e){return y||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)_[t]=[_[t],e[t]];else S.always(e[S.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),i(0,t),this}};if(f.promise(S).complete=m.add,S.success=S.done,S.error=S.fail,u.url=((e||u.url||St)+"").replace(ut,"").replace(_t,Ct[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=Z.trim(u.dataType||"*").toLowerCase().match(he)||[""],null==u.crossDomain&&(l=vt.exec(u.url.toLowerCase()),u.crossDomain=!(!l||l[1]===Ct[1]&&l[2]===Ct[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(Ct[3]||("http:"===Ct[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=Z.param(u.data,u.traditional)),V(gt,u,t,S),2===y)return S;c=Z.event&&u.global,c&&0===Z.active++&&Z.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!mt.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(dt.test(o)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=pt.test(o)?o.replace(pt,"$1_="+ct++):o+(dt.test(o)?"&":"?")+"_="+ct++)),u.ifModified&&(Z.lastModified[o]&&S.setRequestHeader("If-Modified-Since",Z.lastModified[o]),Z.etag[o]&&S.setRequestHeader("If-None-Match",Z.etag[o])),(u.data&&u.hasContent&&u.contentType!==!1||t.contentType)&&S.setRequestHeader("Content-Type",u.contentType),S.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+bt+"; q=0.01":""):u.accepts["*"]);for(d in u.headers)S.setRequestHeader(d,u.headers[d]);if(u.beforeSend&&(u.beforeSend.call(p,S,u)===!1||2===y))return S.abort();b="abort";for(d in{success:1,error:1,complete:1})S[d](u[d]);if(n=V(yt,u,t,S)){S.readyState=1,c&&h.trigger("ajaxSend",[S,u]),u.async&&u.timeout>0&&(a=setTimeout(function(){S.abort("timeout")},u.timeout));try{y=1,n.send(v,i)}catch(C){if(!(2>y))throw C;i(-1,C)}}else i(-1,"No Transport");return S},getJSON:function(e,t,i){return Z.get(e,t,i,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,t){Z[t]=function(e,i,n,o){return Z.isFunction(i)&&(o=o||n,n=i,i=void 0),Z.ajax({url:e,type:t,dataType:o,data:i,success:n})}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Z.fn.extend({wrapAll:function(e){var t;return Z.isFunction(e)?this.each(function(t){Z(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Z(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(Z.isFunction(e)?function(t){Z(this).wrapInner(e.call(this,t))}:function(){var t=Z(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=Z.isFunction(e);return this.each(function(i){Z(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Z.expr.filters.visible=function(e){return!Z.expr.filters.hidden(e)};var wt=/%20/g,Et=/\[\]$/,xt=/\r?\n/g,Mt=/^(?:submit|button|image|reset|file)$/i,Tt=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var i,n=[],o=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){o(this.name,this.value)});else for(i in e)L(i,e[i],t,o);return n.join("&").replace(wt,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&Tt.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!Ee.test(e))}).map(function(e,t){var i=Z(this).val();return null==i?null:Z.isArray(i)?Z.map(i,function(e){return{name:t.name,value:e.replace(xt,"\r\n")}}):{name:t.name,value:i.replace(xt,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Dt=0,Ot={},$t={0:200,1223:204},It=Z.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Ot)Ot[e]()}),K.cors=!!It&&"withCredentials"in It,K.ajax=It=!!It,Z.ajaxTransport(function(e){var t;return K.cors||It&&!e.crossDomain?{send:function(i,n){var o,r=e.xhr(),s=++Dt;if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)r[o]=e.xhrFields[o];e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(o in i)r.setRequestHeader(o,i[o]);t=function(e){return function(){t&&(delete Ot[s],t=r.onload=r.onerror=null,"abort"===e?r.abort():"error"===e?n(r.status,r.statusText):n($t[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=t(),r.onerror=t("error"),t=Ot[s]=t("abort");try{r.send(e.hasContent&&e.data||null)}catch(a){if(t)throw a}},abort:function(){t&&t()}}:void 0}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,o){t=Z("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&o("error"===e.type?404:200,e.type)}),J.head.appendChild(t[0])},abort:function(){i&&i()}}}});var kt=[],Nt=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=kt.pop()||Z.expando+"_"+ct++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(t,i,n){var o,r,s,a=t.jsonp!==!1&&(Nt.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Nt.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(o=t.jsonpCallback=Z.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Nt,"$1"+o):t.jsonp!==!1&&(t.url+=(dt.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||Z.error(o+" was not called"),s[0]},t.dataTypes[0]="json",r=e[o],e[o]=function(){s=arguments},n.always(function(){e[o]=r,t[o]&&(t.jsonpCallback=i.jsonpCallback,kt.push(o)),s&&Z.isFunction(r)&&r(s[0]),s=r=void 0}),"script"):void 0}),Z.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||J;var n=se.exec(e),o=!i&&[];return n?[t.createElement(n[1])]:(n=Z.buildFragment([e],t,o),o&&o.length&&Z(o).remove(),Z.merge([],n.childNodes))};var At=Z.fn.load;Z.fn.load=function(e,t,i){if("string"!=typeof e&&At)return At.apply(this,arguments);var n,o,r,s=this,a=e.indexOf(" ");return a>=0&&(n=Z.trim(e.slice(a)),e=e.slice(0,a)),Z.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(o="POST"),s.length>0&&Z.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){r=arguments,s.html(n?Z("<div>").append(Z.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){s.each(i,r||[e.responseText,t,e])}),this},Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z.expr.filters.animated=function(e){return Z.grep(Z.timers,function(t){return e===t.elem}).length};var Pt=e.document.documentElement;Z.offset={setOffset:function(e,t,i){var n,o,r,s,a,l,c,d=Z.css(e,"position"),u=Z(e),p={};"static"===d&&(e.style.position="relative"),a=u.offset(),r=Z.css(e,"top"),l=Z.css(e,"left"),c=("absolute"===d||"fixed"===d)&&(r+l).indexOf("auto")>-1,c?(n=u.position(),s=n.top,o=n.left):(s=parseFloat(r)||0,o=parseFloat(l)||0),Z.isFunction(t)&&(t=t.call(e,i,a)),null!=t.top&&(p.top=t.top-a.top+s),null!=t.left&&(p.left=t.left-a.left+o),"using"in t?t.using.call(e,p):u.css(p)}},Z.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Z.offset.setOffset(this,e,t)});var t,i,n=this[0],o={top:0,left:0},r=n&&n.ownerDocument;return r?(t=r.documentElement,Z.contains(t,n)?(typeof n.getBoundingClientRect!==xe&&(o=n.getBoundingClientRect()),i=G(r),{top:o.top+i.pageYOffset-t.clientTop,left:o.left+i.pageXOffset-t.clientLeft}):o):void 0},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===Z.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(n=e.offset()),n.top+=Z.css(e[0],"borderTopWidth",!0),n.left+=Z.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-Z.css(i,"marginTop",!0),left:t.left-n.left-Z.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Pt;e&&!Z.nodeName(e,"html")&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||Pt})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n="pageYOffset"===i;Z.fn[t]=function(o){return _e(this,function(t,o,r){var s=G(t);return void 0===r?s?s[i]:t[o]:void(s?s.scrollTo(n?e.pageXOffset:r,n?r:e.pageYOffset):t[o]=r)},t,o,arguments.length,null)}}),Z.each(["top","left"],function(e,t){Z.cssHooks[t]=C(K.pixelPosition,function(e,i){return i?(i=S(e,t),Ue.test(i)?Z(e).position()[t]+"px":i):void 0})}),Z.each({Height:"height",Width:"width"},function(e,t){Z.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){Z.fn[n]=function(n,o){var r=arguments.length&&(i||"boolean"!=typeof n),s=i||(n===!0||o===!0?"margin":"border");return _e(this,function(t,i,n){var o;return Z.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===n?Z.css(t,i,s):Z.style(t,i,n,s)},t,r?n:void 0,r,null)}})}),Z.fn.size=function(){return this.length},Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var Vt=e.jQuery,Rt=e.$;return Z.noConflict=function(t){return e.$===Z&&(e.$=Rt),t&&e.jQuery===Z&&(e.jQuery=Vt),Z},typeof t===xe&&(e.jQuery=e.$=Z),Z}),function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function t(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function n(e){G=e}function o(e){B=e}function r(){return function(){process.nextTick(d)}}function s(){return function(){L(d)}}function a(){var e=0,t=new Y(d),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=d,function(){e.port2.postMessage(0)}}function c(){return function(){setTimeout(d,1)}}function d(){for(var e=0;F>e;e+=2){var t=J[e],i=J[e+1];t(i),J[e]=void 0,J[e+1]=void 0}F=0}function u(){try{var e=require,t=e("vertx");return L=t.runOnLoop||t.runOnContext,s()}catch(i){return c()}}function p(){}function h(){return new TypeError("You cannot resolve a promise with itself")}function f(){return new TypeError("A promises callback cannot return that same promise.")}function m(e){try{return e.then}catch(t){return te.error=t,te}}function _(e,t,i,n){try{e.call(t,i,n)}catch(o){return o}}function v(e,t,i){B(function(e){var n=!1,o=_(i,t,function(i){n||(n=!0,t!==i?b(e,i):C(e,i))},function(t){n||(n=!0,w(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&o&&(n=!0,w(e,o))},e)}function g(e,t){t._state===Z?C(e,t._result):t._state===ee?w(e,t._result):E(t,void 0,function(t){b(e,t)},function(t){w(e,t)})}function y(e,i){if(i.constructor===e.constructor)g(e,i);else{var n=m(i);n===te?w(e,te.error):void 0===n?C(e,i):t(n)?v(e,i,n):C(e,i)}}function b(t,i){t===i?w(t,h()):e(i)?y(t,i):C(t,i)}function S(e){e._onerror&&e._onerror(e._result),x(e)}function C(e,t){e._state===Q&&(e._result=t,e._state=Z,0!==e._subscribers.length&&B(x,e))}function w(e,t){e._state===Q&&(e._state=ee,e._result=t,B(S,e))}function E(e,t,i,n){var o=e._subscribers,r=o.length;e._onerror=null,o[r]=t,o[r+Z]=i,o[r+ee]=n,0===r&&e._state&&B(x,e)}function x(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var n,o,r=e._result,s=0;s<t.length;s+=3)n=t[s],o=t[s+i],n?D(i,n,o,r):o(r);e._subscribers.length=0}}function M(){this.error=null}function T(e,t){try{return e(t)}catch(i){return ie.error=i,ie}}function D(e,i,n,o){var r,s,a,l,c=t(n);if(c){if(r=T(n,o),r===ie?(l=!0,s=r.error,r=null):a=!0,i===r)return void w(i,f())}else r=o,a=!0;i._state!==Q||(c&&a?b(i,r):l?w(i,s):e===Z?C(i,r):e===ee&&w(i,r))}function O(e,t){try{t(function(t){b(e,t)},function(t){w(e,t)})}catch(i){w(e,i)}}function $(e,t){var i=this;i._instanceConstructor=e,i.promise=new e(p),i._validateInput(t)?(i._input=t,i.length=t.length,i._remaining=t.length,i._init(),0===i.length?C(i.promise,i._result):(i.length=i.length||0,i._enumerate(),0===i._remaining&&C(i.promise,i._result))):w(i.promise,i._validationError())}function I(e){return new ne(this,e).promise}function k(e){function t(e){b(o,e)}function i(e){w(o,e)}var n=this,o=new n(p);if(!H(e))return w(o,new TypeError("You must pass an array to race.")),o;for(var r=e.length,s=0;o._state===Q&&r>s;s++)E(n.resolve(e[s]),void 0,t,i);return o}function N(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var i=new t(p);return b(i,e),i}function A(e){var t=this,i=new t(p);return w(i,e),i}function P(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(e){this._id=le++,this._state=void 0,this._result=void 0,this._subscribers=[],p!==e&&(t(e)||P(),this instanceof R||V(),O(this,e))}function j(){var e;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=e.Promise;(!i||"[object Promise]"!==Object.prototype.toString.call(i.resolve())||i.cast)&&(e.Promise=ce)}var q;q=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var L,G,U,H=q,F=0,B=({}.toString,function(e,t){J[F]=e,J[F+1]=t,F+=2,2===F&&(G?G(d):U())}),W="undefined"!=typeof window?window:void 0,z=W||{},Y=z.MutationObserver||z.WebKitMutationObserver,X="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,J=new Array(1e3);U=X?r():Y?a():K?l():void 0===W&&"function"==typeof require?u():c();var Q=void 0,Z=1,ee=2,te=new M,ie=new M;$.prototype._validateInput=function(e){return H(e)},$.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},$.prototype._init=function(){this._result=new Array(this.length)};var ne=$;$.prototype._enumerate=function(){for(var e=this,t=e.length,i=e.promise,n=e._input,o=0;i._state===Q&&t>o;o++)e._eachEntry(n[o],o)},$.prototype._eachEntry=function(e,t){var n=this,o=n._instanceConstructor;i(e)?e.constructor===o&&e._state!==Q?(e._onerror=null,n._settledAt(e._state,t,e._result)):n._willSettleAt(o.resolve(e),t):(n._remaining--,n._result[t]=e)},$.prototype._settledAt=function(e,t,i){var n=this,o=n.promise;o._state===Q&&(n._remaining--,e===ee?w(o,i):n._result[t]=i),0===n._remaining&&C(o,n._result)},$.prototype._willSettleAt=function(e,t){var i=this;E(e,void 0,function(e){i._settledAt(Z,t,e)},function(e){i._settledAt(ee,t,e)})};var oe=I,re=k,se=N,ae=A,le=0,ce=R;R.all=oe,R.race=re,R.resolve=se,R.reject=ae,R._setScheduler=n,R._setAsap=o,R._asap=B,R.prototype={constructor:R,then:function(e,t){var i=this,n=i._state;if(n===Z&&!e||n===ee&&!t)return this;var o=new this.constructor(p),r=i._result;if(n){var s=arguments[n-1];B(function(){D(n,o,s,r)})}else E(i,o,e,t);return o},"catch":function(e){return this.then(null,e)}};var de=j,ue={Promise:ce,polyfill:de};"function"==typeof define&&define.amd?define("Promise",[],function(){return ue}):"undefined"!=typeof module&&module.exports?module.exports=ue:"undefined"!=typeof this&&(this.ES6Promise=ue),de()}.call(this),function(){function e(e){function t(t,i,n,o,r,s){for(;r>=0&&s>r;r+=e){var a=o?o[r]:r;n=i(n,t[a],a,t)}return n}return function(i,n,o,r){n=y(n,r,4);var s=!M(i)&&g.keys(i),a=(s||i).length,l=e>0?0:a-1;return arguments.length<3&&(o=i[s?s[l]:l],l+=e),t(i,n,o,s,l,a)}}function t(e){return function(t,i,n){i=b(i,n);for(var o=x(t),r=e>0?0:o-1;r>=0&&o>r;r+=e)if(i(t[r],r,t))return r;return-1}}function i(e,t,i){return function(n,o,r){var s=0,a=x(n);if("number"==typeof r)e>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(i&&r&&a)return r=i(n,o),n[r]===o?r:-1;if(o!==o)return r=t(d.call(n,s,a),g.isNaN),r>=0?r+s:-1;for(r=e>0?s:a-1;r>=0&&a>r;r+=e)if(n[r]===o)return r;return-1}}function n(e,t){var i=I.length,n=e.constructor,o=g.isFunction(n)&&n.prototype||a,r="constructor";for(g.has(e,r)&&!g.contains(t,r)&&t.push(r);i--;)r=I[i],r in e&&e[r]!==o[r]&&!g.contains(t,r)&&t.push(r)}var o=this,r=o._,s=Array.prototype,a=Object.prototype,l=Function.prototype,c=s.push,d=s.slice,u=a.toString,p=a.hasOwnProperty,h=Array.isArray,f=Object.keys,m=l.bind,_=Object.create,v=function(){},g=function(e){return e instanceof g?e:this instanceof g?void(this._wrapped=e):new g(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=g),exports._=g):o._=g,g.VERSION="1.8.3";var y=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,o){return e.call(t,i,n,o)};case 4:return function(i,n,o,r){return e.call(t,i,n,o,r)}}return function(){return e.apply(t,arguments)}},b=function(e,t,i){return null==e?g.identity:g.isFunction(e)?y(e,t,i):g.isObject(e)?g.matcher(e):g.property(e)};g.iteratee=function(e,t){return b(e,t,1/0)};var S=function(e,t){return function(i){var n=arguments.length;if(2>n||null==i)return i;for(var o=1;n>o;o++)for(var r=arguments[o],s=e(r),a=s.length,l=0;a>l;l++){var c=s[l];t&&void 0!==i[c]||(i[c]=r[c])}return i}},C=function(e){if(!g.isObject(e))return{};if(_)return _(e);v.prototype=e;var t=new v;return v.prototype=null,t},w=function(e){return function(t){return null==t?void 0:t[e]}},E=Math.pow(2,53)-1,x=w("length"),M=function(e){var t=x(e);return"number"==typeof t&&t>=0&&E>=t};g.each=g.forEach=function(e,t,i){t=y(t,i);var n,o;if(M(e))for(n=0,o=e.length;o>n;n++)t(e[n],n,e);else{var r=g.keys(e);for(n=0,o=r.length;o>n;n++)t(e[r[n]],r[n],e)}return e},g.map=g.collect=function(e,t,i){t=b(t,i);for(var n=!M(e)&&g.keys(e),o=(n||e).length,r=Array(o),s=0;o>s;s++){var a=n?n[s]:s;r[s]=t(e[a],a,e)}return r},g.reduce=g.foldl=g.inject=e(1),g.reduceRight=g.foldr=e(-1),g.find=g.detect=function(e,t,i){var n;return n=M(e)?g.findIndex(e,t,i):g.findKey(e,t,i),void 0!==n&&-1!==n?e[n]:void 0},g.filter=g.select=function(e,t,i){var n=[];return t=b(t,i),g.each(e,function(e,i,o){t(e,i,o)&&n.push(e)}),n},g.reject=function(e,t,i){return g.filter(e,g.negate(b(t)),i)},g.every=g.all=function(e,t,i){t=b(t,i);for(var n=!M(e)&&g.keys(e),o=(n||e).length,r=0;o>r;r++){var s=n?n[r]:r;if(!t(e[s],s,e))return!1}return!0},g.some=g.any=function(e,t,i){t=b(t,i);for(var n=!M(e)&&g.keys(e),o=(n||e).length,r=0;o>r;r++){var s=n?n[r]:r;if(t(e[s],s,e))return!0}return!1},g.contains=g.includes=g.include=function(e,t,i,n){return M(e)||(e=g.values(e)),("number"!=typeof i||n)&&(i=0),g.indexOf(e,t,i)>=0},g.invoke=function(e,t){var i=d.call(arguments,2),n=g.isFunction(t);return g.map(e,function(e){var o=n?t:e[t];return null==o?o:o.apply(e,i)})},g.pluck=function(e,t){return g.map(e,g.property(t))},g.where=function(e,t){return g.filter(e,g.matcher(t))},g.findWhere=function(e,t){return g.find(e,g.matcher(t))},g.max=function(e,t,i){var n,o,r=-1/0,s=-1/0;if(null==t&&null!=e){e=M(e)?e:g.values(e);for(var a=0,l=e.length;l>a;a++)n=e[a],n>r&&(r=n)}else t=b(t,i),g.each(e,function(e,i,n){o=t(e,i,n),(o>s||o===-1/0&&r===-1/0)&&(r=e,s=o)});return r},g.min=function(e,t,i){var n,o,r=1/0,s=1/0;if(null==t&&null!=e){e=M(e)?e:g.values(e);for(var a=0,l=e.length;l>a;a++)n=e[a],r>n&&(r=n)}else t=b(t,i),g.each(e,function(e,i,n){o=t(e,i,n),(s>o||1/0===o&&1/0===r)&&(r=e,s=o)});return r},g.shuffle=function(e){for(var t,i=M(e)?e:g.values(e),n=i.length,o=Array(n),r=0;n>r;r++)t=g.random(0,r),t!==r&&(o[r]=o[t]),o[t]=i[r];return o},g.sample=function(e,t,i){return null==t||i?(M(e)||(e=g.values(e)),e[g.random(e.length-1)]):g.shuffle(e).slice(0,Math.max(0,t))},g.sortBy=function(e,t,i){return t=b(t,i),g.pluck(g.map(e,function(e,i,n){return{value:e,index:i,criteria:t(e,i,n)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,i,n){var o={};return i=b(i,n),g.each(t,function(n,r){var s=i(n,r,t);e(o,n,s)}),o}};g.groupBy=T(function(e,t,i){g.has(e,i)?e[i].push(t):e[i]=[t]}),g.indexBy=T(function(e,t,i){e[i]=t}),g.countBy=T(function(e,t,i){g.has(e,i)?e[i]++:e[i]=1}),g.toArray=function(e){return e?g.isArray(e)?d.call(e):M(e)?g.map(e,g.identity):g.values(e):[]},g.size=function(e){return null==e?0:M(e)?e.length:g.keys(e).length},g.partition=function(e,t,i){t=b(t,i);var n=[],o=[];return g.each(e,function(e,i,r){(t(e,i,r)?n:o).push(e)}),[n,o]},g.first=g.head=g.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:g.initial(e,e.length-t)},g.initial=function(e,t,i){return d.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},g.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:g.rest(e,Math.max(0,e.length-t))},g.rest=g.tail=g.drop=function(e,t,i){return d.call(e,null==t||i?1:t)},g.compact=function(e){return g.filter(e,g.identity)};var D=function(e,t,i,n){for(var o=[],r=0,s=n||0,a=x(e);a>s;s++){var l=e[s];if(M(l)&&(g.isArray(l)||g.isArguments(l))){
t||(l=D(l,t,i));var c=0,d=l.length;for(o.length+=d;d>c;)o[r++]=l[c++]}else i||(o[r++]=l)}return o};g.flatten=function(e,t){return D(e,t,!1)},g.without=function(e){return g.difference(e,d.call(arguments,1))},g.uniq=g.unique=function(e,t,i,n){g.isBoolean(t)||(n=i,i=t,t=!1),null!=i&&(i=b(i,n));for(var o=[],r=[],s=0,a=x(e);a>s;s++){var l=e[s],c=i?i(l,s,e):l;t?(s&&r===c||o.push(l),r=c):i?g.contains(r,c)||(r.push(c),o.push(l)):g.contains(o,l)||o.push(l)}return o},g.union=function(){return g.uniq(D(arguments,!0,!0))},g.intersection=function(e){for(var t=[],i=arguments.length,n=0,o=x(e);o>n;n++){var r=e[n];if(!g.contains(t,r)){for(var s=1;i>s&&g.contains(arguments[s],r);s++);s===i&&t.push(r)}}return t},g.difference=function(e){var t=D(arguments,!0,!0,1);return g.filter(e,function(e){return!g.contains(t,e)})},g.zip=function(){return g.unzip(arguments)},g.unzip=function(e){for(var t=e&&g.max(e,x).length||0,i=Array(t),n=0;t>n;n++)i[n]=g.pluck(e,n);return i},g.object=function(e,t){for(var i={},n=0,o=x(e);o>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},g.findIndex=t(1),g.findLastIndex=t(-1),g.sortedIndex=function(e,t,i,n){i=b(i,n,1);for(var o=i(t),r=0,s=x(e);s>r;){var a=Math.floor((r+s)/2);i(e[a])<o?r=a+1:s=a}return r},g.indexOf=i(1,g.findIndex,g.sortedIndex),g.lastIndexOf=i(-1,g.findLastIndex),g.range=function(e,t,i){null==t&&(t=e||0,e=0),i=i||1;for(var n=Math.max(Math.ceil((t-e)/i),0),o=Array(n),r=0;n>r;r++,e+=i)o[r]=e;return o};var O=function(e,t,i,n,o){if(!(n instanceof t))return e.apply(i,o);var r=C(e.prototype),s=e.apply(r,o);return g.isObject(s)?s:r};g.bind=function(e,t){if(m&&e.bind===m)return m.apply(e,d.call(arguments,1));if(!g.isFunction(e))throw new TypeError("Bind must be called on a function");var i=d.call(arguments,2),n=function(){return O(e,n,t,this,i.concat(d.call(arguments)))};return n},g.partial=function(e){var t=d.call(arguments,1),i=function(){for(var n=0,o=t.length,r=Array(o),s=0;o>s;s++)r[s]=t[s]===g?arguments[n++]:t[s];for(;n<arguments.length;)r.push(arguments[n++]);return O(e,i,this,this,r)};return i},g.bindAll=function(e){var t,i,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(t=1;n>t;t++)i=arguments[t],e[i]=g.bind(e[i],e);return e},g.memoize=function(e,t){var i=function(n){var o=i.cache,r=""+(t?t.apply(this,arguments):n);return g.has(o,r)||(o[r]=e.apply(this,arguments)),o[r]};return i.cache={},i},g.delay=function(e,t){var i=d.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},g.defer=g.partial(g.delay,g,1),g.throttle=function(e,t,i){var n,o,r,s=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:g.now(),s=null,r=e.apply(n,o),s||(n=o=null)};return function(){var c=g.now();a||i.leading!==!1||(a=c);var d=t-(c-a);return n=this,o=arguments,0>=d||d>t?(s&&(clearTimeout(s),s=null),a=c,r=e.apply(n,o),s||(n=o=null)):s||i.trailing===!1||(s=setTimeout(l,d)),r}},g.debounce=function(e,t,i){var n,o,r,s,a,l=function(){var c=g.now()-s;t>c&&c>=0?n=setTimeout(l,t-c):(n=null,i||(a=e.apply(r,o),n||(r=o=null)))};return function(){r=this,o=arguments,s=g.now();var c=i&&!n;return n||(n=setTimeout(l,t)),c&&(a=e.apply(r,o),r=o=null),a}},g.wrap=function(e,t){return g.partial(t,e)},g.negate=function(e){return function(){return!e.apply(this,arguments)}},g.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}},g.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},g.before=function(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),1>=e&&(t=null),i}},g.once=g.partial(g.before,2);var $=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];g.keys=function(e){if(!g.isObject(e))return[];if(f)return f(e);var t=[];for(var i in e)g.has(e,i)&&t.push(i);return $&&n(e,t),t},g.allKeys=function(e){if(!g.isObject(e))return[];var t=[];for(var i in e)t.push(i);return $&&n(e,t),t},g.values=function(e){for(var t=g.keys(e),i=t.length,n=Array(i),o=0;i>o;o++)n[o]=e[t[o]];return n},g.mapObject=function(e,t,i){t=b(t,i);for(var n,o=g.keys(e),r=o.length,s={},a=0;r>a;a++)n=o[a],s[n]=t(e[n],n,e);return s},g.pairs=function(e){for(var t=g.keys(e),i=t.length,n=Array(i),o=0;i>o;o++)n[o]=[t[o],e[t[o]]];return n},g.invert=function(e){for(var t={},i=g.keys(e),n=0,o=i.length;o>n;n++)t[e[i[n]]]=i[n];return t},g.functions=g.methods=function(e){var t=[];for(var i in e)g.isFunction(e[i])&&t.push(i);return t.sort()},g.extend=S(g.allKeys),g.extendOwn=g.assign=S(g.keys),g.findKey=function(e,t,i){t=b(t,i);for(var n,o=g.keys(e),r=0,s=o.length;s>r;r++)if(n=o[r],t(e[n],n,e))return n},g.pick=function(e,t,i){var n,o,r={},s=e;if(null==s)return r;g.isFunction(t)?(o=g.allKeys(s),n=y(t,i)):(o=D(arguments,!1,!1,1),n=function(e,t,i){return t in i},s=Object(s));for(var a=0,l=o.length;l>a;a++){var c=o[a],d=s[c];n(d,c,s)&&(r[c]=d)}return r},g.omit=function(e,t,i){if(g.isFunction(t))t=g.negate(t);else{var n=g.map(D(arguments,!1,!1,1),String);t=function(e,t){return!g.contains(n,t)}}return g.pick(e,t,i)},g.defaults=S(g.allKeys,!0),g.create=function(e,t){var i=C(e);return t&&g.extendOwn(i,t),i},g.clone=function(e){return g.isObject(e)?g.isArray(e)?e.slice():g.extend({},e):e},g.tap=function(e,t){return t(e),e},g.isMatch=function(e,t){var i=g.keys(t),n=i.length;if(null==e)return!n;for(var o=Object(e),r=0;n>r;r++){var s=i[r];if(t[s]!==o[s]||!(s in o))return!1}return!0};var k=function(e,t,i,n){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof g&&(e=e._wrapped),t instanceof g&&(t=t._wrapped);var o=u.call(e);if(o!==u.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var r="[object Array]"===o;if(!r){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,a=t.constructor;if(s!==a&&!(g.isFunction(s)&&s instanceof s&&g.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===e)return n[l]===t;if(i.push(e),n.push(t),r){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!k(e[l],t[l],i,n))return!1}else{var c,d=g.keys(e);if(l=d.length,g.keys(t).length!==l)return!1;for(;l--;)if(c=d[l],!g.has(t,c)||!k(e[c],t[c],i,n))return!1}return i.pop(),n.pop(),!0};g.isEqual=function(e,t){return k(e,t)},g.isEmpty=function(e){return null==e?!0:M(e)&&(g.isArray(e)||g.isString(e)||g.isArguments(e))?0===e.length:0===g.keys(e).length},g.isElement=function(e){return!(!e||1!==e.nodeType)},g.isArray=h||function(e){return"[object Array]"===u.call(e)},g.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},g.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){g["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),g.isArguments(arguments)||(g.isArguments=function(e){return g.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(g.isFunction=function(e){return"function"==typeof e||!1}),g.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},g.isNaN=function(e){return g.isNumber(e)&&e!==+e},g.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===u.call(e)},g.isNull=function(e){return null===e},g.isUndefined=function(e){return void 0===e},g.has=function(e,t){return null!=e&&p.call(e,t)},g.noConflict=function(){return o._=r,this},g.identity=function(e){return e},g.constant=function(e){return function(){return e}},g.noop=function(){},g.property=w,g.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},g.matcher=g.matches=function(e){return e=g.extendOwn({},e),function(t){return g.isMatch(t,e)}},g.times=function(e,t,i){var n=Array(Math.max(0,e));t=y(t,i,1);for(var o=0;e>o;o++)n[o]=t(o);return n},g.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},g.now=Date.now||function(){return(new Date).getTime()};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},A=g.invert(N),P=function(e){var t=function(t){return e[t]},i="(?:"+g.keys(e).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(o,t):e}};g.escape=P(N),g.unescape=P(A),g.result=function(e,t,i){var n=null==e?void 0:e[t];return void 0===n&&(n=i),g.isFunction(n)?n.call(e):n};var V=0;g.uniqueId=function(e){var t=++V+"";return e?e+t:t},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\u2028|\u2029/g,L=function(e){return"\\"+j[e]};g.template=function(e,t,i){!t&&i&&(t=i),t=g.defaults({},t,g.templateSettings);var n=RegExp([(t.escape||R).source,(t.interpolate||R).source,(t.evaluate||R).source].join("|")+"|$","g"),o=0,r="__p+='";e.replace(n,function(t,i,n,s,a){return r+=e.slice(o,a).replace(q,L),o=a+t.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),t}),r+="';\n",t.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(t.variable||"obj","_",r)}catch(a){throw a.source=r,a}var l=function(e){return s.call(this,e,g)},c=t.variable||"obj";return l.source="function("+c+"){\n"+r+"}",l},g.chain=function(e){var t=g(e);return t._chain=!0,t};var G=function(e,t){return e._chain?g(t).chain():t};g.mixin=function(e){g.each(g.functions(e),function(t){var i=g[t]=e[t];g.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),G(this,i.apply(g,e))}})},g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];g.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0],G(this,i)}}),g.each(["concat","join","slice"],function(e){var t=s[e];g.prototype[e]=function(){return G(this,t.apply(this._wrapped,arguments))}}),g.prototype.value=function(){return this._wrapped},g.prototype.valueOf=g.prototype.toJSON=g.prototype.value,g.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return g})}.call(this),function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(i,n,o){t.Backbone=e(t,o,i,n)});else if("undefined"!=typeof exports){var i,n=require("underscore");try{i=require("jquery")}catch(o){}e(t,exports,n,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,i,n){var o=e.Backbone,r=Array.prototype.slice;t.VERSION="1.3.3",t.$=n,t.noConflict=function(){return e.Backbone=o,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(e,t,n){switch(e){case 1:return function(){return i[t](this[n])};case 2:return function(e){return i[t](this[n],e)};case 3:return function(e,o){return i[t](this[n],l(e,this),o)};case 4:return function(e,o,r){return i[t](this[n],l(e,this),o,r)};default:return function(){var e=r.call(arguments);return e.unshift(this[n]),i[t].apply(i,e)}}},a=function(e,t,n){i.each(t,function(t,o){i[o]&&(e.prototype[o]=s(t,o,n))})},l=function(e,t){return i.isFunction(e)?e:i.isObject(e)&&!t._isModel(e)?c(e):i.isString(e)?function(t){return t.get(e)}:e},c=function(e){var t=i.matches(e);return function(e){return t(e.attributes)}},d=t.Events={},u=/\s+/,p=function(e,t,n,o,r){var s,a=0;if(n&&"object"==typeof n){void 0!==o&&"context"in r&&void 0===r.context&&(r.context=o);for(s=i.keys(n);a<s.length;a++)t=p(e,t,s[a],n[s[a]],r)}else if(n&&u.test(n))for(s=n.split(u);a<s.length;a++)t=e(t,s[a],o,r);else t=e(t,n,o,r);return t};d.on=function(e,t,i){return h(this,e,t,i)};var h=function(e,t,i,n,o){if(e._events=p(f,e._events||{},t,i,{context:n,ctx:e,listening:o}),o){var r=e._listeners||(e._listeners={});r[o.id]=o}return e};d.listenTo=function(e,t,n){if(!e)return this;var o=e._listenId||(e._listenId=i.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),s=r[o];if(!s){var a=this._listenId||(this._listenId=i.uniqueId("l"));s=r[o]={obj:e,objId:o,id:a,listeningTo:r,count:0}}return h(e,t,n,this,s),this};var f=function(e,t,i,n){if(i){var o=e[t]||(e[t]=[]),r=n.context,s=n.ctx,a=n.listening;a&&a.count++,o.push({callback:i,context:r,ctx:r||s,listening:a})}return e};d.off=function(e,t,i){return this._events?(this._events=p(m,this._events,e,t,{context:i,listeners:this._listeners}),this):this},d.stopListening=function(e,t,n){var o=this._listeningTo;if(!o)return this;for(var r=e?[e._listenId]:i.keys(o),s=0;s<r.length;s++){var a=o[r[s]];if(!a)break;a.obj.off(t,n,this)}return this};var m=function(e,t,n,o){if(e){var r,s=0,a=o.context,l=o.listeners;if(t||n||a){for(var c=t?[t]:i.keys(e);s<c.length;s++){t=c[s];var d=e[t];if(!d)break;for(var u=[],p=0;p<d.length;p++){var h=d[p];n&&n!==h.callback&&n!==h.callback._callback||a&&a!==h.context?u.push(h):(r=h.listening,r&&0===--r.count&&(delete l[r.id],delete r.listeningTo[r.objId]))}u.length?e[t]=u:delete e[t]}return e}for(var f=i.keys(l);s<f.length;s++)r=l[f[s]],delete l[r.id],delete r.listeningTo[r.objId]}};d.once=function(e,t,n){var o=p(_,{},e,t,i.bind(this.off,this));return"string"==typeof e&&null==n&&(t=void 0),this.on(o,t,n)},d.listenToOnce=function(e,t,n){var o=p(_,{},t,n,i.bind(this.stopListening,this,e));return this.listenTo(e,o)};var _=function(e,t,n,o){if(n){var r=e[t]=i.once(function(){o(t,r),n.apply(this,arguments)});r._callback=n}return e};d.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),i=Array(t),n=0;t>n;n++)i[n]=arguments[n+1];return p(v,this._events,e,void 0,i),this};var v=function(e,t,i,n){if(e){var o=e[t],r=e.all;o&&r&&(r=r.slice()),o&&g(o,n),r&&g(r,[t].concat(n))}return e},g=function(e,t){var i,n=-1,o=e.length,r=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<o;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s);return;case 3:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s,a);return;default:for(;++n<o;)(i=e[n]).callback.apply(i.ctx,t);return}};d.bind=d.on,d.unbind=d.off,i.extend(t,d);var y=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{});var o=i.result(this,"defaults");n=i.defaults(i.extend({},o,n),o),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(y.prototype,d,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!i.iteratee(e,this)(this.attributes)},set:function(e,t,n){if(null==e)return this;var o;if("object"==typeof e?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;var r=n.unset,s=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,d=this.changed,u=this._previousAttributes;for(var p in o)t=o[p],i.isEqual(c[p],t)||a.push(p),i.isEqual(u[p],t)?delete d[p]:d[p]=t,r?delete c[p]:c[p]=t;if(this.idAttribute in o&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=n);for(var h=0;h<a.length;h++)this.trigger("change:"+a[h],this,c[a[h]],n)}if(l)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,n={};for(var o in e){var r=e[o];i.isEqual(t[o],r)||(n[o]=r)}return i.size(n)?n:!1},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=i.extend({parse:!0},e);var t=this,n=e.success;return e.success=function(i){var o=e.parse?t.parse(i,e):i;return t.set(o,e)?(n&&n.call(e.context,t,i,e),void t.trigger("sync",t,i,e)):!1},G(this,e),this.sync("read",this,e)},save:function(e,t,n){var o;null==e||"object"==typeof e?(o=e,n=t):(o={})[e]=t,n=i.extend({validate:!0,parse:!0},n);var r=n.wait;if(o&&!r){if(!this.set(o,n))return!1}else if(!this._validate(o,n))return!1;var s=this,a=n.success,l=this.attributes;n.success=function(e){s.attributes=l;var t=n.parse?s.parse(e,n):e;return r&&(t=i.extend({},o,t)),t&&!s.set(t,n)?!1:(a&&a.call(n.context,s,e,n),void s.trigger("sync",s,e,n))},G(this,n),o&&r&&(this.attributes=i.extend({},l,o));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=o);var d=this.sync(c,this,n);return this.attributes=l,d},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,o=e.wait,r=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(i){o&&r(),n&&n.call(e.context,t,i,e),t.isNew()||t.trigger("sync",t,i,e)};var s=!1;return this.isNew()?i.defer(e.success):(G(this,e),s=this.sync("delete",this,e)),o||r(),s},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||L();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1):!0}});var b={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(y,b,"attributes");var S=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},C={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},E=function(e,t,i){i=Math.min(Math.max(i,0),e.length);var n,o=Array(e.length-i),r=t.length;for(n=0;n<o.length;n++)o[n]=e[n+i];for(n=0;r>n;n++)e[n+i]=t[n];for(n=0;n<o.length;n++)e[n+r+i]=o[n]};i.extend(S.prototype,d,{model:y,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,w))},remove:function(e,t){t=i.extend({},t);var n=!i.isArray(e);e=n?[e]:e.slice();var o=this._removeModels(e,t);return!t.silent&&o.length&&(t.changes={added:[],merged:[],removed:o},this.trigger("update",this,t)),n?o[0]:o},set:function(e,t){if(null!=e){t=i.extend({},C,t),t.parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var n=!i.isArray(e);e=n?[e]:e.slice();var o=t.at;null!=o&&(o=+o),o>this.length&&(o=this.length),0>o&&(o+=this.length+1);var r,s,a=[],l=[],c=[],d=[],u={},p=t.add,h=t.merge,f=t.remove,m=!1,_=this.comparator&&null==o&&t.sort!==!1,v=i.isString(this.comparator)?this.comparator:null;for(s=0;s<e.length;s++){r=e[s];var g=this.get(r);if(g){if(h&&r!==g){var y=this._isModel(r)?r.attributes:r;t.parse&&(y=g.parse(y,t)),g.set(y,t),c.push(g),_&&!m&&(m=g.hasChanged(v))}u[g.cid]||(u[g.cid]=!0,a.push(g)),e[s]=g}else p&&(r=e[s]=this._prepareModel(r,t),r&&(l.push(r),this._addReference(r,t),u[r.cid]=!0,a.push(r)))}if(f){for(s=0;s<this.length;s++)r=this.models[s],u[r.cid]||d.push(r);d.length&&this._removeModels(d,t)}var b=!1,S=!_&&p&&f;if(a.length&&S?(b=this.length!==a.length||i.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,E(this.models,a,0),this.length=this.models.length):l.length&&(_&&(m=!0),E(this.models,l,null==o?this.length:o),this.length=this.models.length),m&&this.sort({silent:!0}),!t.silent){for(s=0;s<l.length;s++)null!=o&&(t.index=o+s),r=l[s],r.trigger("add",r,this,t);(m||b)&&this.trigger("sort",this,t),(l.length||d.length||c.length)&&(t.changes={added:l,removed:d,merged:c},this.trigger("update",this,t))}return n?e[0]:e}},reset:function(e,t){t=t?i.clone(t):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return r.apply(this.models,arguments)},get:function(e){return null!=e?this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]:void 0},has:function(e){return null!=this.get(e)},at:function(e){return 0>e&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var n=t.length;return i.isFunction(t)&&(t=i.bind(t,this)),1===n||i.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){e=i.extend({parse:!0},e);var t=e.success,n=this;return e.success=function(i){var o=e.reset?"reset":"set";n[o](i,e),t&&t.call(e.context,n,i,e),n.trigger("sync",n,i,e)},G(this,e),this.sync("read",this,e)},create:function(e,t){t=t?i.clone(t):{};var n=t.wait;if(e=this._prepareModel(e,t),!e)return!1;n||this.add(e,t);var o=this,r=t.success;return t.success=function(e,t,i){n&&o.add(e,i),r&&r.call(i.context,e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeModels:function(e,t){for(var i=[],n=0;n<e.length;n++){var o=this.get(e[n]);if(o){var r=this.indexOf(o);this.models.splice(r,1),this.length--,delete this._byId[o.cid];var s=this.modelId(o.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=r,o.trigger("remove",o,this,t)),i.push(o),this._removeReference(o,t)}}return i},_isModel:function(e){return e instanceof y},_addReference:function(e,t){this._byId[e.cid]=e;var i=this.modelId(e.attributes);null!=i&&(this._byId[i]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var i=this.modelId(e.attributes);null!=i&&delete this._byId[i],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){if(t){if(("add"===e||"remove"===e)&&i!==this)return;if("destroy"===e&&this.remove(t,n),"change"===e){var o=this.modelId(t.previousAttributes()),r=this.modelId(t.attributes);o!==r&&(null!=o&&delete this._byId[o],null!=r&&(this._byId[r]=t))}}this.trigger.apply(this,arguments)}});var x={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};a(S,x,"models");var M=t.View=function(e){this.cid=i.uniqueId("view"),i.extend(this,i.pick(e,D)),this._ensureElement(),this.initialize.apply(this,arguments)},T=/^(\S+)\s*(.*)$/,D=["model","collection","el","id","attributes","className","tagName","events"];i.extend(M.prototype,d,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=i.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[n]),n){var o=t.match(T);this.delegate(o[1],o[2],i.bind(n,this))}}return this},delegate:function(e,t,i){return this.$el.on(e+".delegateEvents"+this.cid,t,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,i){return this.$el.off(e+".delegateEvents"+this.cid,t,i),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,n,o){var r=O[e];i.defaults(o||(o={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=i.result(n,"url")||L()),null!=o.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===s.type||o.emulateJSON||(s.processData=!1);var l=o.error;o.error=function(e,t,i){o.textStatus=t,o.errorThrown=i,l&&l.call(o.context,e,t,i)};var c=o.xhr=t.ajax(i.extend(s,o));return n.trigger("request",n,c,o),c};var O={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var $=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},I=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,N=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend($.prototype,d,{initialize:function(){},route:function(e,n,o){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var r=this;return t.history.route(e,function(i){var s=r._extractParameters(e,i);r.execute(o,s,n)!==!1&&(r.trigger.apply(r,["route:"+n].concat(s)),r.trigger("route",n,s),t.history.trigger("route",r,n,s))}),this},execute:function(e,t,i){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(I,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/?]+)"}).replace(N,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var P=t.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},V=/^[#\/]|\s+$/g,R=/^\/+|\/+$/g,j=/#.*$/;P.started=!1,i.extend(P.prototype,d,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(V,"")},start:function(e){if(P.started)throw new Error("Backbone.history has already been started");if(P.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(R,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,o=n.insertBefore(this.iframe,n.firstChild).contentWindow;o.document.open(),o.document.close(),o.location.hash="#"+this.fragment}var r=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};return this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),P.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),i.some(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})):!1},navigate:function(e,t){if(!P.started)return!1;t&&t!==!0||(t={trigger:!!t}),e=this.getFragment(e||"");var i=this.root;(""===e||"?"===e.charAt(0))&&(i=i.slice(0,-1)||"/");var n=i+e;if(e=this.decodeFragment(e.replace(j,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{
if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;t.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new P;var q=function(e,t){var n,o=this;return n=e&&i.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,t),n.prototype=i.create(o.prototype,e),n.prototype.constructor=n,n.__super__=o.prototype,n};y.extend=S.extend=$.extend=M.extend=P.extend=q;var L=function(){throw new Error('A "url" property or function must be specified')},G=function(e,t){var i=t.error;t.error=function(n){i&&i.call(t.context,e,n,t),e.trigger("error",e,n,t)}};return t}),function(e){"function"==typeof require&&"undefined"!=typeof module&&module.exports?module.exports=e(require("underscore")):"function"==typeof define?define("Cocktail",["underscore"],e):this.Cocktail=e(_)}(function(e){var t={},i={boon:null};t.end_with=function(e){return[i,e]},t.mixins={},t.mixin=function(n){var o=e.chain(arguments).toArray().slice(1).flatten().value(),r=n.prototype||n,s={};return e.each(o,function(i){e.isString(i)&&(i=t.mixins[i]),e.each(i,function(t,i){if(e.isFunction(t)){if(r[i]===t)return;r[i]&&(s[i]=s.hasOwnProperty(i)?s[i]:[r[i]],s[i].push(t)),r[i]=t}else e.isArray(t)?r[i]=e.union(t,r[i]||[]):e.isObject(t)?r[i]=e.extend({},t,r[i]||{}):i in r||(r[i]=t)})}),e.each(s,function(t,n){r[n]=function(){var n=this,o=arguments,r=void 0,s=!1;return e.each(t,function(t){if(!s){var a=e.isFunction(t)?t.apply(n,o):t;"undefined"!=typeof a&&("object"==typeof a&&a[0]&&a.splice&&a[0]===i?(r="undefined"!=typeof a[1]?a[1]:r,s=!0):r=a)}}),r}}),n};var n;return t.patch=function(i){n=i.Model.extend;var o=function(e,i){var o=n.call(this,e,i),r=o.prototype.mixins;return r&&o.prototype.hasOwnProperty("mixins")&&t.mixin(o,r),o};e.each([i.Model,i.Collection,i.Router,i.View],function(i){i.mixin=function(){t.mixin(this,e.toArray(arguments))},i.extend=o})},t.unpatch=function(t){e.each([t.Model,t.Collection,t.Router,t.View],function(e){e.mixin=void 0,e.extend=n})},t});var Sm={};require(["require","jquery","Cocktail","backbone"],function(e,t,i,n){window.Sm=Sm||{};var o=document.getElementById("drag_n_drop"),r=!!o&&o.checked,s=document.getElementById("d_l"),a=document.getElementById("i_e"),l=a?a.value:!1,c=s?s.value:!1;Sm.CONFIG={DRAG_MODE:r,EDIT:l,DEBUG:parseInt(c)+1},Sm.loaded={_loaded:{},_unloaded:{},_waiting:{},_correct_dependencies:function(e){var t=[];e.constructor!==Array&&(e=[e]);for(var i=0;i<e.length;i++){var n=e[i];n=n.toLowerCase().trim(),this.is_loaded(n)||t.push(n)}return t},add:function(e,t){if(e=e.toLowerCase().trim(),this._loaded[e])return!0;this._loaded[e]=!0,this.resolve(e,t||"add");var i=this._unloaded[e];if(i){for(var n=i.length,o=0;n>o;o++){var r=i[o];r=r.toLowerCase().trim();var s=this._waiting[r];"object"==typeof s&&s.timeout!==!1&&(s.dependencies=this._correct_dependencies(s.dependencies),s.dependencies.length||this.add(r,e))}delete this._unloaded[e]}return!0},resolve:function(e,t){var i=this._waiting[e];if(!i||i.timeout===!1)return!1;clearTimeout(i.timeout);var n=i.fn;return delete this._waiting[e],n()},_bb:{},when_loaded:function(e,t,i,n){var o=Sm.loaded;return i&&(this._bb[i]=!0),new Promise(function(r,s){var a=function(e){r(e())};e=o._correct_dependencies(e),i||(i=e.join?e.join(","):e+"-"),i=i.toLowerCase().trim();var l=t;if("function"!=typeof t&&(t=function(){return l}),!e.length)return o.add(i),a(t);for(var c=0;c<e.length;c++){var d=e[c];o._unloaded[d]=o._unloaded[d]||[],o._unloaded[d].push(i)}o._waiting[i]={timeout:setTimeout(function(){var e=o._waiting[i];if(e&&e.timeout!==!1){var t=o._correct_dependencies(e.dependencies);return t.length?(o._waiting[i].timeout=!1,s(t)):r(o.add(i,"timeout"))}},n||15e3),fn:a.bind(null,t),dependencies:e}})},is_loaded:function(e){if(e.constructor===Array){for(var t=0;t<e.length;t++){var i=e[t];if(!this.is_loaded(i))return!1}return!0}return e=e.toLowerCase().trim(),!!this._loaded[e]}},window.Sm.Extras=window.Sm.Extras||{},Sm.Extras.visual_debug=function(e,t){var i=document.getElementById("debug_el");if(i){var n=document.createElement("li");n.innerHTML=""+e,i.appendChild(n)}},window.Sm.Core={},e(["Sm-Core-Core"]),e(["tooltipster"]),e(["SmHighlight"]),e(["Cocktail"]),i.patch(n),Sm.Entities=Sm.Entities||{},Sm.Entities.Abstraction=Sm.Entities.Abstraction||{},Sm.Entities.Abstraction.mixins=Sm.Entities.Abstraction.mixins||{};var d=function(e){this.name="NonexistentModelError",this.message=e||"Model does not exist",this.stack=(new Error).stack};d.prototype=new Error,Sm.Errors={},Sm.Errors.NonexistentModelError=d,Sm.loaded.add("Errors"),Sm.CONFIG.DEBUG&&Sm.loaded.when_loaded("Core_Identifier",function(){var e=document.getElementById("debug_identifier");if(e){var t=document.getElementById("debug_identifier_button");if(t){var i=function(){var t=e.value;if(t=t.trim(),t.indexOf("MvWrapper")>-1){var i=t.split(".");i.shift(),i.length?Sm.CONFIG.DEBUG&&console.log(Sm.Core.MvWrapper[i.join(".")]):Sm.CONFIG.DEBUG&&console.log(Sm.Core.MvWrapper)}else Sm.CONFIG.DEBUG&&console.log(Sm.Core.Identifier.retrieve(t))};t.addEventListener("click",i),e.addEventListener("keyup",function(e){13==e.keyCode&&i()})}}},"Sm_debug_handler"),o&&o.addEventListener("change",function(){Sm.CONFIG.DRAG_MODE=this.checked})}),define("Sm",function(){});var initializing=!1,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,Class=function(){};if(Class.extend=function(e){function t(){!initializing&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;initializing=!0;var n=new this;initializing=!1;for(var o in e)n[o]="function"==typeof e[o]&&"function"==typeof i[o]&&fnTest.test(e[o])?function(e,t){return function(){var n=this._super;this._super=i[e];var o=t.apply(this,arguments);return this._super=n,o}}(o,e[o]):e[o];return t.prototype=n,t.prototype.constructor=t,t.extend=arguments.callee,t},define("Class",[],function(){return Class}),define("Sm-Core-RelationshipIndex",["Class","Sm"],function(e){var t=window.Sm;t.Core.RelationshipIndex=e.extend({init:function(e){e=e||{},this._meta={_key:"",_index:e.index||null,_list:[]},this.parent_type=e.parent_type,this.is_reciprocal=!!e.is_reciprocal;var i=this.linked_entities=e.linked_entities||[];this.deleted_items={},this.items={},this._meta._key=e._key||(this.is_reciprocal?i[0]:i[1])||!1,this.operations={},this.contexts={},this.add_new_context(0),this.MvCombo=e.MvCombo,this.status={last_fetched:!1};var n=this;this.Identity=t.Core.Identifier.get_or_init({id:!1,ent_id:!1,type:"RelationshipIndex",Resource:n}),this.r_id_map={},this._to_delete={}},get_relationship_type_obj_index:function(){if(this.info_index)return this.info_index;var e=this._meta._index;if(!e)return{error:"No index"};var i=this.parent_type,n=t.Entities[i];if(!n)return{error:"no self Sm"};var o=n.Meta;if(!o)return{error:"No info object for type "+this.parent_type};if(!o.relationship_type_obj)return{error:"No info object relationship type obj"};if(!o.relationship_type_obj[e])return{error:"No info object for index "+e+'"'};var r=o.relationship_type_obj[e];return r.index=e,this.info_index=r,r},fetch:function(){var e=this.get_relationship_type_obj_index();if(e.error)return Promise.reject(e);var i,n=e.MvType,o=this.is_reciprocal;t.Entities[n]&&t.Entities[n].Meta&&(i=t.Entities[n].Meta.lower_plural[n]);var r=t.urls.api.generate({MvCombo:this.MvCombo,fetch:i||n,find_usages:o,relationship_type:e.index});return r&&r.length?(this.status.last_fetched=new Date,Promise.resolve($.ajax({url:r,contentType:"application/json; charset=UTF-8",method:"GET"})).then(function(e){if("object"==typeof e&&e.error&&e.error.length)throw e.error;"[object Array]"!==Object.prototype.toString.call(e)&&(e=[e]);for(var i=[],n=0;n<e.length;n++){var o=e[n];t.CONFIG.DEBUG&&console.log(o);var r=o._model_type;if(r){var s=t.Entities[r];if(s){var a=s.Wrapper.init_MvCombo({model:o});i.push(a)}}}return i})):Promise.reject({error:"No URL"})},toJSON:function(e){var i=this.get_relationship_type_obj_index();if("string"==typeof i)return Promise.reject(i);var n=this.contexts[e]||this,o=n._meta,r=n.items,s=n.operations||{},a={_meta:o,maps:{},identities:{},operations:s,context_id:e},l=this._meta._key;n._meta._index=this._meta._index;for(var c in s)if(s.hasOwnProperty(c)){var d=c in r?r:n.deleted_items,u=d[c].relationship||d[c];if(u.map){var p=u.get_Identity_at_index(l);p?(a.maps[c]=u.map,a.identities[c]=p):t.CONFIG.DEBUG&&console.log(u)}else t.CONFIG.DEBUG&&console.log(u,r,c,c in r,d[c])}return a},save:function(e){e=e||{};var i,n=e.context_id;if(i=null!==n&&"undefined"!==n?this.contexts[n]:this,!i)return Promise.reject({error:"No Context"});if(this.is_reciprocal)return Promise.resolve(!0);var o=t.urls.api.generate({MvCombo:this.MvCombo});if(!o||!o.length)return Promise.reject({error:"No URL"});var r=this;return Promise.resolve($.ajax({url:o,data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",method:"PATCH"})).then(function(e){t.CONFIG.DEBUG&&console.log(e);var o,s=r.deleted_items;if("object"==typeof e){var a=(e.message,e.success,e.data);for(o in a)if(a.hasOwnProperty(o)){var l=a[o];if(l.data.map=l.data.map||{},l.success===!0||0===l.success){var c=i.items[o];c.setMap(l.data.map),i.operations[o]=[]}else o in s&&r.add_item(s[o],o,n,!1,!0)}}else for(o in s)s.hasOwnProperty(o)&&r.add_item(s[o],o,n,!1,!0);r.deleted_items={}})},add_new_context:function(e){var t=this._meta.index,i=this._meta._key,n=this;return this.contexts[e]||(this.contexts[e]={_meta:{_list:[],_index:t||null,_key:i||!1},deleted_items:{},items:{},operations:{},toJSON:n.toJSON.bind(n,e)})},locate:function(e,t){if(!e)return-1;if("string"==typeof e){var i;return i=null===t?this:this.contexts[t],t=t||0,i&&i._meta&&i._meta._list?i._meta._list.indexOf(e):-1}return e.r_id?this.locate(e.r_id,t):e.Identity?this.locate(e.Identity):-1},sort_incoming:function(e,t){},add_item:function(e,t,i,n,o){var r=e.map||{};if(!r)return!1;e.relationshipIndexRIDs.indexOf(this.Identity.r_id)<0&&e.relationshipIndexRIDs.push(this.Identity.r_id);var s=r.position||1;s=parseInt(s),n=!!n,i=i||0;var a=this.contexts[i]||this.add_new_context(i),l=!1,c=!1;this.r_id_map[e.Identity.r_id]=t,0>s&&(s=0),a._meta._list.indexOf(t)>-1&&(l=!0),this._meta._list.indexOf(t)>-1&&(c=!0);var d,u=a._meta._list.length,p=this._meta._list.length;return c||(d=s,d>p&&(d=p),!p||d>=p?this._meta._list.push(t):this._meta._list.splice(d-1,0,t)),l||(d=s,d>u&&(d=u),!u||d>=u?a._meta._list.push(t):(d||(d=1),a._meta._list.splice(d-1,0,t)),a.items[t]=e),this.items[t]=e,o||(a.operations[t]=a.operations[t]||[],a.operations[t].push("add"),this.operations[t]=this.operations[t]||[],this.operations[t].push("add")),n&&this.update_indices(i),this.sort_incoming(e,t),!0},get_listed_items:function(e){e=e||0;for(var i=this.contexts[e],n=i._meta._list,o=i.items,r={relationships:[],items:[],count:0},s=0;s<n.length;s++){var a=n[s];if(o[a]){var l=o[a],c=t.Core.Identifier.retrieve(a);c&&(c=c.getResource(),r.items.push(c),r.relationships.push(l))}}return r.count=r.items.length,r},update_indices:function(e){if(e||!e)return!0;if(e=e||0,!this.contexts[e])return!1;var t=this.contexts[e],i=t.items,n=(t._meta._list,[]);for(var o in i)if(i.hasOwnProperty(o)){var r=i[o],s=r.position||r.map.position||1;s&&n.push({item:r,r_id:o,position:s})}n.sort(function(e,t){return e.position-t.position});var a=n.length;a&&(t._meta._list=[]);for(var l=0;a>l;l++){var c=n[l];t._meta._list.push(c.r_id),i[c.r_id].map.position=l+1}},remove_item:function(e,t,i){var n,o=this.contexts;if(null==t){var r,s=!0;for(n in o)o.hasOwnProperty(n)&&(s=(r=this.remove_item(e,n,i))&&s);return s?r:!1}if(t=t||0,"object"==typeof e&&(e.setMap?e=this.r_id_map[e.Identity.r_id]:e.r_id&&(e=e.r_id),t=t||e.context_id||0),!this.contexts[t])return!1;var a=this.contexts[t],l=a.items,c=a._meta._list;if(!e in c)return!1;var d=this.locate(e,t);c.splice(d,1);var u=!1;for(n in o)if(o.hasOwnProperty(n)&&this.locate(e,n)>-1){u=!0;break}u&&this._meta._list.splice(this.locate(e,null),1);var p=l[e];return delete l[e],i&&this.update_indices(t),a.operations[e]=a.operations[e]||[],a.operations[e].push("delete"),u&&(this.operations[e]=this.operations[e]||[],this.operations[e].push("delete")),this.MvCombo&&e in this.MvCombo.relationship_map&&delete this.MvCombo.relationship_map[e],a.deleted_items[e]={relationship:p,index:d},p||!1},move_item:function(e,t,i,n){if(!e)return!1;i=i||0;var o=this.locate(e,i);if(-1===o)return!1;var r=this.contexts[i];return o==t?!0:(o>t?(r._meta._list.splice(o,1),r._meta._list.splice(t,1,e)):(r._meta._list.splice(t,1,e),r._meta._list.splice(o,1)),n&&this.update_indices(i),r.operations[e]=r.operations[e]||[],r.operations[e].push("move"),i||(this.operations[e]=this.operations[e]||[],this.operations[e].push("move")),!0)},has_relationships_in_context:function(e){return e=e||0,this.contexts[e]&&this.contexts[e]._meta._list.length?!0:this.status.last_fetched?!1:0}}),t.loaded.add("Core_RelationshipIndex")}),define("Sm-Core-Relationship",["Class","Sm"],function(e){Sm.Core.Relationship=e.extend({number_of_links:2,init:function(e){e=e||{},this.relationshipIndexRIDs=[],this.map=this._get_default_map_properties(),this._to_delete={},this._map_links={},this._view_associations={},this.linked_entities=e.linked_entities||this.linked_entities||["",""],this.rel_indexes=e.rel_indexes||this.rel_indexes||["",""];var t=this;this.Identity=Sm.Core.Identifier.get_or_init({type:"Relationship",Resource:t}),this.context_id=e.context_id||this.map.context_id||0},get_Identity_at_index:function(e){return this._map_links[e]||!1},setMap:function(e){return e=e||{},this.map=Sm.Core.util.merge_objects(this.map,e),this.map.id&&this.Identity.refresh({id:this.map.id}),this},toJSON:function(){return{map:this.map,_meta:this._meta}},save:function(e){var t=Sm.urls.api.generate({Relationship:this});Sm.CONFIG.DEBUG&&console.log(t);var i=this;return Promise.resolve($.ajax({url:t,data:JSON.stringify(this),contentType:"application/json; charset=UTF-8",method:this.map&&this.map.id?"PATCH":"POST"})).then(function(e){Sm.CONFIG.DEBUG&&console.log(e),e&&e.success&&e.data&&e.data.map&&(e.data.map.id&&i.setMap(e.data.map),Sm.CONFIG.DEBUG&&console.log(i.map))})},destroy:function(e){e=e||{};var t=("silent"in e?e.silent:!0,this._view_associations),i=e.secondary_key||this.rel_indexes[1];if(i&&i.length)for(var n in t)t.hasOwnProperty(n)&&(this._to_delete[n]=t[n][i]);var o=this.relationshipIndexRIDs,r=Sm.urls.api.generate({Relationship:this});Sm.CONFIG.DEBUG&&console.log(r);var s=this;return Promise.resolve($.ajax({url:r,data:JSON.stringify(this),contentType:"application/json; charset=UTF-8",method:"DELETE"})).then(function(e){if(Sm.CONFIG.DEBUG&&console.log(e),!e||!e.success)throw e.error;for(var t=0;t<o.length;t++){var i=Sm.Core.Identifier.retrieve(o[t]);if(i){var n=i.getResource();n&&n.remove_item(s,s.context_id,!0)}}})},link_Mv:function(e,t){return e&&t?(this.linked_entities.length<2&&this.linked_entities.push(e.type),this._map_links[t]=e.Identity,this):this},get_Mv:function(e){var t=e.map_index;$.isArray(t)||(t=(t||"").split("|"));for(var i=e.SelfMvCombo?e.SelfMvCombo.Identity:e.Identity,n=0;n<t.length;n++){var o=t[n];if(o&&o.length&&this._map_links[o])return this._map_links[o].getResource()}if(i&&2==this.number_of_links){var r=this._map_links;for(var s in r)if(r.hasOwnProperty(s)&&r[s]&&r[s]!=i)return r[s].getResource()}return!1},get_map_index_of_Mv:function(e){var t=e.SelfMvCombo?e.SelfMvCombo.Identity:e.Identity;if(t&&2==this.number_of_links){var i=this._map_links;for(var n in i)if(i.hasOwnProperty(n)&&i[n]&&i[n]==t)return n}return!1},_get_default_map_properties:function(){return{id:null}},register_view_relationship:function(e){e=e||{};for(var t=this.rel_indexes,i=0;i<t.length;i++){var n=t[i];e[n]=e[n]||!1}for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];r&&r.cid&&(this._view_associations[r.cid]=e)}},getView:function(e,t,i){var n=e.cid;if(!t){var o=e.MvCombo;t=this.get_map_index_of_Mv(this.get_Mv({SelfMvCombo:o}))}if(!n||!t||i&&!this._view_associations[n])return!1;if(this._view_associations[n]&&this._view_associations[n][t])return this._view_associations[n][t];if(i)return!1;var r,s=this.rel_indexes;if(2==s.length)for(var a=0;a<s.length;a++){var l=s[a];if(l!=t){r=l;break}}if(r){var c=this.get_Mv({SelfMvCombo:e.MvCombo,map_index:t}),d={};return d[r]=e,d[t]=c.getView({reference_element:e.referenceElement,strict:i}),this.register_view_relationship(d),this.getView(e,t,!0)}return Sm.CONFIG.DEBUG&&console.log(t,r),!1}}),Sm.loaded.add("Core_Relationship")}),"undefined"==typeof global)var global="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};var raf=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;if(define("Sm-Core-util",["jquery","Sm"],function(e){Sm.Core.util={getBrowserPrefix:function(){if(!this.browserPrefix)return this.browserPrefix;var e,t,i=navigator.appName,n=navigator.userAgent,o=n.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);o&&null!=(t=n.match(/version\/([\.\d]+)/i))&&(o[2]=t[1]),o=o?[o[1],o[2]]:[i,navigator.appVersion,"-?"],o=o[0],"Chrome"==o&&(e="webkit"),"Firefox"==o&&(e="moz"),"Safari"==o&&(e="webkit"),"MSIE"==o&&(e="ms"),this.browserPrefix=e},follow_link:function(e,t){if(t)window.location=e;else{var i=window.open(e,"_blank");i.focus()}},isElement:function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},merge_objects:function(e,t){var i={};if(e&&"object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&"object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);return i},merge_objects_recursive:function(e,t){for(var i in t)if(t.hasOwnProperty(i))try{t[i].constructor==Object?e[i]=this.merge_objects_recursive(e[i],t[i]):e[i]=t[i]}catch(n){e[i]=t[i]}return e},switch_:function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i&&"object"==typeof i){var n=i.c,o=i.f;if(n&&"function"==typeof o)return o()}}},isChildOf:function(e,t){for(;(e=e.parentNode)&&e!==t;);return!!e},insertAfter:function(e,t){t.nextSibling&&t&&e&&t.parentNode.insertBefore(e,t.nextSibling)},_recurseGetChildElements:function(t,i,n){for(var o=0;o<t.childNodes.length;o++){var r=t.childNodes[o];if(e(r).hasClass(i)){n.push(t.childNodes[o]);break}this._recurseGetChildElements(t.childNodes[o],i,n)}},getChildElementsByClassName:function(e,t){if("string"!=typeof t||!this.isElement(e))return[];var i=[];return this._recurseGetChildElements(e,t,i),i},createElement:function(e,t){var i;i=document.createElement("div"),i.innerHTML=e;var n=i.childNodes[0];return t&&document.body.appendChild(n),n},camelize:function(e,t){return e=e.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(e,t){return 0===+e?"":0==t?e.toLowerCase():e.toUpperCase()}),t?e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()}):e},isEmpty:function(t){return t=e(t),!e.trim(t.html())},hasClass:function(e,t){return this.isElement(e)?!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)")):String(e).match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},getCaretCharacterOffsetWithin:function(e){var t,i=0,n=e.ownerDocument||e.document,o=n.defaultView||n.parentWindow;if("undefined"!=typeof o.getSelection){if(t=o.getSelection(),t.rangeCount>0){var r=o.getSelection().getRangeAt(0),s=r.cloneRange();s.selectNodeContents(e),s.setEnd(r.endContainer,r.endOffset),i=s.toString().length}}else if((t=n.selection)&&"Control"!=t.type){var a=t.createRange(),l=n.body.createTextRange();l.moveToElementText(e),l.setEndPoint("EndToEnd",a),i=l.text.length}return i},get_rect_width:function(e){return e.width||e.right-e.left},get_rect_height:function(e){return e.height||e.bottom-e.top},get_scroll:function(e,t){return"undefined"!=typeof global[t]?global[t]:document.clientHeight?document[e]:document.body[e]},randomString:function(e,t){t=t||"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";for(var i="",n=e;n>0;--n)i+=t[Math.floor(Math.random()*t.length)];return i},requestAnimationFrame:raf,create_animation_loop:function(e,t){function i(s){if(n!==!1){r?r(i,t):setTimeout(i,16),s=s&&s>1e4?s:+new Date;var a=s-o;160>a&&(n=e(a,s)),o=s}}var n=!0,o=+new Date,r=this.requestAnimationFrame;i()}},Sm.loaded.add("Core_util")}),require(["require","Class","Sm-Core-util"],function(e){var t=Sm.Core.util,i=Sm.Core.Identifier=Class.extend({toJSON:function(){var e=Sm.Core.util.merge_objects(this,{});return"Resource"in e&&delete e.Resource,e},init:function(e){return e=e||{},e.Resource=e.Resource||e.MvCombo||!1,this.ent_id=this.ent_id||e.ent_id||!1,this.id=this.id||e.id||!1,this.id=this.id?parseInt(this.id):!1,this.r_id=e.r_id||this.r_id||!1,this.type=this.type||e.type||i.guess_type(this.ent_id)||null,this.typed_id=this.typed_id||(this.type&&this.type.length?this.type+"|"+this.id:null),this.r_id=this.r_id||this.ent_id||this.generate_r_id(),this.Resource=this.Resource||e.Resource||null,this.ent_id||delete this.ent_id,this.id||(delete this.typed_id,delete this.id),i.register(this.r_id,this).register(this.typed_id,this).register(this.ent_id,this),this},generate_r_id:function(){return t.randomString(15)},refresh:function(e){return"object"!=typeof e?this:(!this.id&&e.id&&(e.type||this.type)&&(this.id=e.id,this.typed_id=(e.type||this.type)+"|"+this.id,i.register(this.typed_id,this)),!this.ent_id&&e.ent_id&&(this.ent_id=e.ent_id,i.register(this.ent_id,this)),(!this.Resource&&e.Resource||e.MvCombo)&&(this.Resource=e.Resource||e.MvCombo),this)},getResource:function(){return this.Resource||!1}});i.registry={},i.register=function(e,t){return e&&t&&e.length?(i.registry=i.registry||{},i.registry[e]=t,i):i},i.get_or_init=function(e){return i.retrieve(e)||new i(e)},i.is_ent_id=function(e){var t=25;return"string"==typeof e&&e.length===t&&/[0-9]{6}/.test(e.substr(4,6))},i.normalize_identifier=function(e,t){if(!e)return{};var n={};return"object"==typeof e?e:"string"==typeof e&&e.indexOf("|")?{typed_id:e}:i.is_ent_id(e)?{ent_id:e,type:t}:($.isNumeric(e)&&(n.id=parseInt(e),n.type=t,"string"==typeof t&&(n.typed_id=t+"|"+e)),n)},i.retrieve=function(e){var t,n=!1,o=i.registry;if("string"==typeof e){if(n=!0,e in o)return o[e];t=e,e={},i.is_ent_id(t)?e.ent_id=t:e.r_id=t}e=i.normalize_identifier(e,e.type||!1)||{},n&&Sm.CONFIG.DEBUG&&console.log(e);var r=e.ent_id||!1;if(t=t||e.r_id,t&&t in o)return o[t].refresh(e);if(r&&r in o)return o[r].refresh(e);var s=e.id||!1;s=s?parseInt(s):!1;var a=e.type||i.guess_type(r)||"",l=a&&a.length&&s?a+"|"+s:null;return l&&l in o?o[l].refresh(e):void 0},i.identify=function(e){var t=i.retrieve(e);return t?t.getResource():!1},i.guess_type=function(e){if(!e||!e.length)return!1;var t=e.substr(0,4);switch(t){case"sec_":return"Section";case"dim_":return"Dimension";case"page":return"Page";case"coll":return"Collection";case"dic_":return"Dictionary";default:return!1}},Sm.loaded.add("Core_Identifier")}),define("Sm-Core-Identifier",function(){}),require(["require","Class","Sm","Sm-Core-Identifier"],function(e,t){e("Sm"),e("Sm-Core-Identifier"),Sm.Core.MvWrapper=t.extend({type:null,parentType:null,init:function(e){e=e||{},this.MvMaps={loaded_MVs:{},focused_MVs:{},selected_MVs:{},active_MVs:{},deleted_MVs:{}},this.CONFIG=e.CONFIG||{},this.CONFIG.EDIT=this.CONFIG.EDIT||Sm.CONFIG.EDIT||!1,this.CONFIG.DRAG_MODE=this.CONFIG.DRAG_MODE||Sm.CONFIG.DRAG_MODE,this.CONFIG.DEBUG=this.CONFIG.DEBUG||Sm.CONFIG.DEBUG,this._callbacks={},this.events=[],this.loaded_ent_ids={}},get_MVs:function(e){return/loaded|active|focused|selected|deleted/.test(e)?this.MvMaps[e]:void 0},hydrate:function(e){e=e||{};var t=e.elements||!1;if(!t||!t.length)return this;var i,n,o,r;for(n=0;n<t.length;n++){i=t[n],r=$(i),o=i.dataset||{id:null,ent_id:null,model:null};var s=o.model;if(s){var a=$.parseJSON(s);delete o.model;var l=this.init_MvCombo({model:a,view:i}),c=r.closest(".relationship-container"),d=r.parent().closest("[data-view_r_id]");if(c[0]&&d[0]){var u,p=Sm.Core.Identifier.retrieve({ent_id:c.data("ent_id")});if(p){u=p.getResource();var h=i.parentNode,f=Sm.Core.Identifier.retrieve({r_id:d.data("view_r_id")});f&&(f=f.getResource()),Sm.loaded.when_loaded([l.type,u.type],function(e,t,i,n,o){return function(){var r=e.getRelationship(t.Identity),s=Sm.Entities[e.type].Meta,a=i.data("relationship_index");if(r&&s.relationship_type_obj&&s.relationship_type_obj[a]&&s.relationship_type_obj[a].primary_key&&s.relationship_type_obj[a].secondary_key){var l={},c=s.relationship_type_obj[a].primary_key,d=s.relationship_type_obj[a].secondary_key;l[c]=o,l[d]=t.getView({reference_element:n,strict:!0}),r.register_view_relationship(l),o.add_relationship({self_map_index:c,map_index:d,Relationship:r,relationship_type_index:a})}}}(u,l,c,h,f),"add_parent_relationship")}}var m=r.hasClass("active")?"active":"loaded";this.add_MV_as(m,l.Identity),"model"in i.dataset&&delete i.dataset.model}}return this},init_MvCombo:function(e){var t=e.model||e.Model||(e.id?{id:e.id}:{});t||Sm.CONFIG.DEBUG&&console.log(_.clone(e)),e=e||{},e.CONFIG=this.CONFIG,e.Wrapper=this,e.type=this.type;var i=e.Identifier||Sm.Core.Identifier.retrieve({id:t.id||!1,ent_id:t.ent_id||!1,MvCombo:t.MvCombo||!1,type:this.type}),n=e.model||e.Model||e;if(i&&i.r_id in this.MvMaps.loaded_MVs){var o=i.getResource();i.refresh({id:n.id||!1,ent_id:n.ent_id||!1});var r=e.View||e.view;return o.addView(r),o}var s=Sm.Entities[this.type];if(!s)return!1;e.type=this.type;var a=s.MvCombo;if(!a)return!1;var l=new a(e);if(l.type=this.type,!l.Identity)return!1;if(!l.queryStatus("init"))return!1;for(var c=["blur","destroy","focus","select","deselect","edit","activate","deactivate"],d=0;d<c.length;d++){var u=c[d],p=u+"_MV";this[p]&&l.on(u,this[p])}return l.type==this.type&&this.add_MV_as("loaded",l),l},MV_is:function(e,t){if(!t)return!1;t.Identity?t=t.Identity:t.MvCombo&&(t=t.MvCombo.Identity);var i=t.r_id;return i?(e+="_MVs",this[e]&&this[e][i]):!1},add_MV_as:function(e,t){if(!t)return this;t.Identity?t=t.Identity:t.MvCombo&&(t=t.MvCombo.Identity);var i=t.r_id;if(!i)return this;var n=Sm.Entities[this.type];n&&n.Meta&&n.Meta.add_MV_as(e,t);var o=this.MvMaps;switch(e){case"loaded":o.loaded_MVs[i]=t;break;case"active":case"focused":case"selected":if(!(e+"_MVs"in o))return Sm.CONFIG.DEBUG&&console.log(e,o),this;o[e+"_MVs"][i]=t,!(i in o.loaded_MVs)&&(o.loaded_MVs[i]=t)}var r=t.ent_id;if(t.getResource&&(r=r||(t.getResource()||{}).ent_id||!1),!!r&&(this.loaded_ent_ids[r]=t),this.parentType){var s=Sm.Entities[this.parentType];if(!s)return this;var a=s.Wrapper;a.add_MV_as(e,t)}return this},remove_MV_as:function(e,t){if(!t)return this;t.Identity?t=t.Identity:t.MvCombo&&(t=t.MvCombo.Identity);var i=Sm.Entities[this.type];i&&i.Meta&&i.Meta.remove_MV_as(e,t);var n=t.r_id;if(!n)return this;var o=e+"_MVs",r=this.MvMaps;if(!r[o])return!1;if(n in this.MvMaps[o]&&delete this.MvMaps[o][n],"loaded"==o&&(n in this.MvMaps.active_MVs&&delete this.MvMaps.active_MVs[n],n in this.MvMaps.selected_MVs&&delete this.MvMaps.selected_MVs[n],n in this.MvMaps.focused_MVs&&delete this.MvMaps.focused_MVs[n]),this.parentType){var s=Sm.Entities[this.parentType];if(!s)return this;var a=s.Wrapper;a.remove_MV_as(e,t)}return!0},get_arbitrary:function(){var e=this.MvMaps.loaded_MVs;for(var t in e)if(e.hasOwnProperty(t))return e[t].getResource();return!1},focus_MV:function(e){e=e||{};var t=e.MvCombo,i=(this.MvMaps.focused_MVs,e.View);if(this.MV_is("focused",t))return new Promise(function(e){e()});this.blur_MV(),i&&i.focus(),this.add_MV_as("focused",{MvCombo:t});var n=new Promise(function(e){e()});return n},activate_MV:function(e){e=e||{};var t=e.MvCombo;t&&this.add_MV_as("active",{MvCombo:t});var i=new Promise(function(e){e()});return i},select_MV:function(e){e=e||{};var t=e.MvCombo;t&&this.add_MV_as("selected",{MvCombo:t});var i=new Promise(function(e){e()});return i},deselect_MV:function(e){e=e||{};var t=e.MvCombo;t&&this.remove_MV_as("selected",{MvCombo:t});var i=new Promise(function(e){e()});return i},blur_MV:function(e){e=e||{};var t=e.MvCombo;if(t&&this.remove_MV_as("focused",{MvCombo:t}),!t){var i=this.MvMaps.focused_MVs;for(var n in i)if(i.hasOwnProperty(n)){var o=i[n],r=o.getResource();r.blur()}}var s=new Promise(function(e){e()});return s},deactivate_MV:function(e){e=e||{};var t=e.MvCombo;t&&this.remove_MV_as("active",{MvCombo:t});var i=new Promise(function(e){e()});return i},build_MV:function(e){e=e&&"object"==typeof e?e:{};var t=!!e.prompt;return t?this._prompt_build_MV(e):this._continue_build_MV(e)},destroy_MV:function(e){if(!e)return Promise.reject();var t=e.id;return t in this.MvMaps.selected_MVs&&delete this.MvMaps.selected_MVs[t],t in this.MvMaps.active_MVs&&delete this.MvMaps.active_MVs[t],t in this.MvMaps.loaded_MVs&&delete this.MvMaps.loaded_MVs[t],t in this.MvMaps.focused_MVs&&delete this.MvMaps.focused_MVs[t],this.MvMaps.deleted_MVs[t]=!0,Promise.resolve(!0)},_prompt_build_MV:function(e){e=e||{};Promise.reject();return this._continue_build_MV(e)},_continue_build_MV:function(e){e=e||{};var t=this,i=Sm.Entities[this.type];if(!i)return Promise.reject("No SmType to accompany "+this.type);var n=i.Model;if(!n)return Promise.reject("No Model type");var o=new n({});o.type=this.type;var r=Sm.Core.util.merge_objects(o.attributes,e.model_properties||{});return o.set(r),Promise.resolve(o.save()).then(function(i){if(i.success=i.success||!1,!i.success)throw i.message||"Unknown error occurred";i.data=i.data||{};var n=t.init_MvCombo({Wrapper:t,model:i.data.model,CONFIG:t.CONFIG});return n?(n.getView({}).render(),t.add_MV_as("loaded",{MvCombo:n,id:o.get("id"),ent_id:o.get("ent_id")}),e.MvCombo=n,n):Promise.reject("No new Mv")})}}),Sm.Core.MvWrapper.replacements={replaced_MVs:{},replacement_MVs:{}},Sm.Core.MvWrapper.convert_to_MvCombo=function(e){if(!e)return!1;if(e.constructor==Array)return e.map(function(e){return Sm.Core.MvWrapper.convert_to_MvCombo(e)});if(e.r_id&&(e=e.r_id),e.Identity&&(e=e.Identity.r_id),"string"==typeof e){if(e in Sm.Core.Meta.MvMaps.loaded_MVs)return Sm.Core.Meta.MvMaps.loaded_MVs[e].getResource();var t=Sm.Core.Identifier.retrieve(e);if(!t)return!1;var i=t.getResource();if(!i)return!1;if(i.addView)return i;if(i.MvCombo)return i.MvCombo}return!1},Sm.Core.MvWrapper.get_effective_MV=function(e,t,i,n){n=n||{};var o=Sm.Core.MvWrapper;t=!!t;var r;if("string"==typeof e)r=e;else{var s=o.convert_to_MvCombo(e);if(!s)return i?!1:{MVs:e,replacement_indices:{}};r=s.Identity.r_id}var a,l=t?o.replacements.replacement_MVs:o.replacements.replaced_MVs,c=l[r];if(a=c?c.MVs:!1,!a||!a.length||1===a.length&&a[0]==r)return i?!1:{MVs:[r],replacement_indices:{}};var d,u=c.replacement_indices;for(var p in u)u.hasOwnProperty(p)&&(d||(d=u[p]));for(var h=[],f={},m=0;m<a.length;m++){var _=a[m];if(n[_])delete l[r],a.splice(m,1),m--;else{n[_]=n;var v=Sm.Core.MvWrapper.get_effective_MV(_,t,!0,n);if(v||f[_]){var g=v.MVs,y=v.replacement_indices;if(!d)for(var b in y)y.hasOwnProperty(b)&&(d||(d=y[b]));for(var S=0;S<g.length;S++){var C=g[S];f[C]||C==r||(f[C]=!0,h.push(C))}}else{if(_==r)continue;h.push(_),f[_]=!0}}}return{MVs:h,replacement_indices:d}},Sm.Core.MvWrapper.register_MV_replacement=function(e,t,i){if(!i)return Sm.CONFIG.DEBUG&&console.log(i),!1;if(!t||!e)return!1;var n=Sm.Core.MvWrapper;e.Identity&&(e=[e.Identity.r_id]),t.Identity&&(t=[t.Identity.r_id]),e=e.sort(),t=t.sort();var o={},r={},s=n.replacements.replaced_MVs,a=n.replacements.replacement_MVs,l=e.join(","),c=t.join(","),d=[];for(var u in s)if(s.hasOwnProperty(u)){var p=s[u].MVs.join(",");l==p&&t.indexOf(u)>-1&&(delete s[u],d.push(u))}var h=d.join(",");if(h==c){for(var f=0;f<e.length;f++){var m=e[f];a[m]&&delete a[m]}d=!1}if(!d)return!0;for(var _,v=0;v<e.length;v++){_=e[v],r[_]=i;var g=n.get_effective_MV(_,!1,!0),y=g?g.MVs:!1;if(y)Sm.CONFIG.DEBUG&&console.log("reps",y),n.register_MV_replacement(y,t,i);else{var b=t.indexOf(_);_>0&&t.splice(b,1),
t.length?s[_]={MVs:t,replacement_indices:o}:s[_]&&delete s[_]}}var S=[];t.forEach(function(e){o[e]=i;var t=n.get_effective_MV(e),r=t.MVs;if(r)for(var s=0;s<r.length;s++){var a=r[s];S.push(a)}else S.push(e)});for(var C=0;C<S.length;C++)_=S[C],a[_]={MVs:e,replacement_indices:r};return!0},Sm.loaded.when_loaded("Core_Identifier",function(){Sm.loaded.add("Core_MvWrapper")},"Core_MvWrapper")}),define("Sm-Core-MvWrapper",function(){}),define("Emitter",["Class"],function(e){var t=Array.prototype.slice,i=e.extend({init:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.events=[],this._callbacks={}},on:function(e,t){return!this._callbacks&&(this._callbacks={}),!this._callbacks[e]&&(this._callbacks[e]=[]),"function"==typeof t&&this._callbacks[e].push(t),this},off:function(e,t){if(!this._callbacks||0===arguments.length)return this._callbacks={},this;var i=this._callbacks[e];if(!i)return this;if(1===arguments.length)return delete this._callbacks[e],this;var n,o,r,s;for(n=o=0,r=i.length;r>o;n=++o)if(s=i[n],s===t){i.splice(n,1);break}return this},emit:function(e){for(var t=this._prepare_event.apply(this,arguments),i=0;i<t.length;i++){var n=t[i];n()}return this},_prepare_event:function(e){var i=arguments.length>=2?t.call(arguments,1):[];if(!this._callbacks)return this._callbacks={},[];var n,o=this._callbacks[e],r=[];if(o)for(var s=0,a=o.length;a>s;s++)n=o[s],n&&(r[s]=Function.prototype.bind.apply(n,[this].concat(i)));return r||[]},resolve:function(e){var t=0;return Promise.all(this._prepare_event.apply(this,arguments).map(function(e){return t++,e?e():!1})).then(function(e){return 1===t?e[0]:e})},removeListener:function(e,t){this.off(e,t)},removeAllListeners:function(){this.off()},add_bound:function(e,t,i){return this._fns=this._fns||{},"function"!=typeof t?(Sm.CONFIG.DEBUG&&console.log(e,t),function(){}):this._fns[e]=this._fns[e]||t.bind(i||this)},get_bound:function(e){return this._fns[e]?this._fns[e]:function(){}.bind(this)}});return i}),require(["require","Sm","Sm-Core-util","Emitter"],function(e){var t=e("Emitter");Sm.Core.MvCombo=t.extend({init:function(e){this.type=e.type||this.type||"MvCombo",e=e||{},this._callbacks={},this.status={},this._relationships_to_add=null,this._permissions={},this.Views={},this.ViewMaps={selected_Views:{},active_Views:{},focused_Views:{}},this.ViewList=[],this.defaultViewList=[],this.Model=null,this.relationship_map={},this.relationships={},this.reciprocal_relationships={},this.relationships=this._create_relationship_holder()||{},this.reciprocal_relationships=this._create_relationship_holder(!0)||{},this.CONFIG=Sm.CONFIG,this.Wrapper=e.Wrapper||null,this.addView(e.view||e.View||null);var t=e.model||e.Model||null;t=this.Model=this._initModel(t);var i=this,n=this.type||e.type;this._cache={ids:{}};var o=this.Identity=e.Identifier||Sm.Core.Identifier.get_or_init({id:t.id||e.id||!1,ent_id:t.ent_id||e.ent_id||!1,type:n,Resource:i});this.Model.Identity=o;var r=function(e){return function(){e._prepare_known_relationships(e._relationships_to_add),!Sm.CONFIG.DEBUG&&(e._relationships_to_add=null)}}(this);Sm.loaded.is_loaded(this.type+"__core")?r():Sm.loaded.when_loaded([this.type+"__core"],r,"prepare_"+o.ent_id+"_relationships");var s=function(e){return function(){return i._cache.ids[e]?i._cache.ids[e]:i._cache.ids[e]=i.Identity&&i.Identity[e]?i.Identity[e]:!1}};Object.defineProperties(i,{ent_id:{get:s("ent_id")},id:{get:s("id")},r_id:{get:s("r_id")}}),this.ent_id&&this.setStatus("has_ent_id",!0),this.setStatus("completed",o.id&&o.ent_id&&o.ent_id.length);var a=this.add_bound("_destroy",this.destroy),l=this.add_bound("_focus",this.focus);this.on("destroy",a).on("focus",l),this.setStatus("init",!0)},_create_relationship_holder:function(e){var t={};if(!Sm.Entities[this.type])return!1;var i=Sm.Entities[this.type].Meta;if(!i)return!1;var n=i.relationship_type_obj;if(!n)return!1;var o=this.type,r=this;e=!!e;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];if(!a.is_only_reciprocal||e){var l=i.get_relationship_type({type:"index"},s),c=!1;Sm.Entities[this.type].RelationshipAbstraction&&(c=Sm.Entities[this.type].RelationshipAbstraction[l+"_RelationshipIndex"]),c=c||Sm.Core.RelationshipIndex,t[s]=new c({_key:e?a.primary_key:a.secondary_key,is_reciprocal:e,index:l,parent_type:o,linked_entities:a.linked_entities,MvCombo:r})}}return t},_initModel:function(e){var t=Sm.Entities[this.type];if(!t)return!1;var i=t.Model;if(!i)return!1;var n,o;if(e instanceof i)e.MvCombo=this,n=e.get("id"),o=e.get("ent_id");else{"string"==typeof e?e=$.parseJSON(e):e||(e={});var r={};if(n=e.id,o=e.ent_id,e.id&&(r=_.clone(e)),r._permissions){var s=r._permissions;this.setPermission(s)}r.relationships&&r.relationships.items&&(this._relationships_to_add=r.relationships.items,delete r.relationships),r.MvCombo=this,e=new i(r),e.MvCombo=this}return this.id=n||!1,this.ent_id=o||!1,e||{}},setPermission:function(e,t){if("string"==typeof e)this._permissions[e]=t;else if("object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&this.setPermission(i,e[i])},queryPermission:function(e){return e&&this._permissions[e]?this._permissions[e]:null},setStatus:function(e,t){if("string"==typeof e)this.status[e]=t;else if("object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&this.setStatus(i,e[i])},queryStatus:function(e){return e&&this.status[e]?this.status[e]:null},_prepare_known_relationships:function(e){e=e||{};var t=this.type;for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];if(n&&"object"==typeof n&&n._meta&&n.items){var o=n.items;for(var r in o)if(o.hasOwnProperty(r)&&$.isNumeric(r)){var s=o[r];if(s&&"object"==typeof s){var a=s._map||!1;if(a){var l,c=s.model;if(c&&c._model_type&&(l=c._model_type),!l&&n._meta._linked_entities){var d=n._meta._linked_entities;if(1===d.length)l=d[0];else{l=d[0];for(var u=0;u<d.length;u++){var p=d[u];p!=t&&(l=p)}}}if(l){var h=this,f=function(e,t,i,n,o,r){return function(){var s=Sm.Entities[e];if(s){var a=s.Wrapper;if(a){var l=a.init_MvCombo({model:t,id:i});l&&l.Identity&&Sm.loaded.when_loaded([n.type+"__core",l.type+"__core"],function(){n.add_relationship(l,{map:o,relationship_index:r,position:o.position||1,silent:!0})["catch"](function(e){Sm.CONFIG.DEBUG&&console.log(e)})},"add_rel_to_"+n.type)}}}}(l,c,r,h,a,i);Sm.loaded.is_loaded(l+"__core")?f():Sm.loaded.when_loaded(l+"__core",f,"add_rel_to_other_")}}}}delete e[i]}}return e},addView:function(e,t,i){i=i||{};var n=Sm.Entities[this.type],o=n.View;if(!o)return!1;var r=this,s=this.Model;if(e instanceof o)e.model=s,e.MvCombo||e.setMvCombo(r),this.defaultViewList&&this.defaultViewList.length&&this.removeView(this.defaultViewList[0]),!t&&document.body.contains(e.el.parentNode)&&(t=e.el.parentNode),e.referenceElement=t||e.referenceElement||!1;else{var a={model:s,el:!1,display_type:i.display_type||"full"};if(Sm.Core.util.isElement(e))a.el=e,e=new o(a),e.setMvCombo(r),e.referenceElement||(!t&&document.body.contains(e.el.parentNode)&&(t=e.el.parentNode),e.referenceElement=t||!1),this.defaultViewList&&this.defaultViewList.length&&this.removeView(this.defaultViewList[0]);else{if(!this.defaultViewList&&(this.defaultViewList=[]),this.defaultViewList.length)return this.defaultViewList[0];if(e=new o(a),t&&this.ViewList.length)for(var l=!1,c=this.ViewList,d=0;d<c.length;d++){var u=c[d],p=this.Views[u];if(p.referenceElement==t)return l=!0,p}this.defaultViewList.push(e.cid),e.setMvCombo&&e.setMvCombo(r),!t&&document.body.contains(e.el.parentNode)&&(t=e.el.parentNode),e.referenceElement=t}}return e.cid in this.ViewList||(this.Views[e.cid]=e,this.ViewList.push(e.cid)),e},removeView:function(e){e in this.Views&&delete this.Views[e];var t;this.defaultViewList&&(t=this.defaultViewList.indexOf(e))>-1&&this.defaultViewList.splice(t,1),this.ViewList&&(t=this.ViewList.indexOf(e))>-1&&this.ViewList.splice(t,1)},getView:function(e){e=e||{};var t,i=e.cid||!1,n=e.reference_element||!1,o=!!e.strict,r=e.display_type;if(i){if(this.Views[i])return this.Views[i];if(o)return!1}var s=!1;if(n&&this.ViewList.length){var a=!1;this.forEachView(function(){t||this.referenceElement!=n||(t=this),this.referenceElement||(a=this)}),t?s=t:t||o||(s=a?a:this.addView(null,n,{display_type:r}))}return s=s?s:this.addView(null,n,{display_type:r}),"string"==typeof s?this.getView({cid:s,strict:!0}):s},forEachView:function(e,t){if("function"==typeof e)for(var i=this.ViewList,n=0;n<i.length;n++){var o=i[n];!!this.Views[o]&&e.apply(this.Views[o],t)}},focus:function(e,t){this.do_standard_interaction("focus",e,t)},blur:function(e,t){this.do_standard_interaction("blur",e,t)},activate:function(e,t){this.do_standard_interaction("activate",e,t)},select:function(e,t){this.do_standard_interaction("select",e,t)},deselect:function(e,t){this.do_standard_interaction("deselect",e,t)},deactivate:function(e,t){this.do_standard_interaction("deactivate",e,t)},do_standard_interaction:function(e,t,i){e=e||"focus";var n,o=!1,r=e,s=e;switch(e){case"blur":o=!0;case"focus":s="focus",r="focused_Views",n="focused";break;case"deselect":o=!0;case"select":s="select",r="selected_Views",n="selected";break;case"deactivate":o=!0;case"activate":s="activate",r="activated_Views",n="active";break;default:return!1}2!=arguments.length&&"undefined"!=typeof i||"object"!=typeof t||!t.cid||(i=t);var a=this.type,l=this.Wrapper||Sm.Entities[a].Wrapper,c=this,d={MvCombo:c};this.ViewMaps[r]=this.ViewMaps[r]||{};var u=this.ViewMaps[r],p=0;for(var h in u)u.hasOwnProperty(h)&&p++;var f=function(){if(this[e]){var t=this.queryPermission(s);if(null===t&&(t=this.queryPermission("view")),!t&&null!==t)return Sm.CONFIG.DEBUG&&console.log(s,t),!1;if("focus"==e&&i&&i!=this)return c.blur(this);o?u[this.cid]&&(p--,delete u[this.cid]):(u[this.cid]=this.Identity,p++),this[e]()}};if(i?f.call(i):this.forEachView(f),this.queryStatus(n)!==!!p&&(this.setStatus(n,!!p),l[e+"_MV"])){if("focus"==e){var m=l.MvMaps.focused_MVs;for(var _ in m)if(m.hasOwnProperty(_)&&_!=this.Identity.r_id){var v=m[_].getResource();v&&v.blur()}}l[e+"_MV"](d)}},getRelationship:function(e){if(!e)return!1;e.Identity&&(e=e.Identity);var t="string"==typeof e?e:e.r_id;return this.relationship_map[t]||!1},_get_relationship_details:function(e){e=e||{};var t,i,n,o=e.MvCombo,r=o.type,s=this.type,a=!!e.is_reciprocal,l=e.map||{},c=r.toLowerCase(),d=this._relationship_detail_hook(r,e,l,c),u=!!d.reciprocity_matters,p=d.self_index,h=d.other_index;return a&&u?(t=h,i=p):(t=p,i=h),t&&i&&(n=new Sm.Core.Relationship({linked_entities:[s,r],rel_indexes:[t,i]}),l[t]=this.Identity.id,l[i]=o.Identity.id),{relationship:n||!1,self_map_index:t||!1,secondary_map_index:i||!1}},_relationship_detail_hook:function(e,t,i,n){var o=!1,r=n+"_id",s=this.type.toLowerCase()+"_id";return r==s&&(o=!0,t.is_reciprocal?(s="secondary_"+s,r="primary_"+r):(s="primary_"+s,r="secondary_"+r)),{map:i,reciprocity_matters:o,self_index:s,other_index:r}},add_relationship:function(e,t,i){this.relationship_map=this.relationship_map||{},t=t||{};var n=!!t.silent,o=t.map||{},r=t.relationship_index,s=t.prompt||!e||!r,a="undefined"!=typeof t.update_indices?!!t.update_indices:!0;if(s)return this._prompt_relationship_add(e,t);var l=!!t.is_reciprocal,c=!1,d=this.type,u=Sm.Entities[d];if(e&&e.r_id&&e.getResource&&(e=e.getResource()),!u)throw"No Sm for "+this.type;var p;if(p=u.Meta,!p)throw"No Meta for "+this.type+" trying to add relationship";p.relationship_aliases[r]&&(r=p.relationship_aliases[r]);var h=p.get_possible_relationship_indices({is_reciprocal:l,OtherMvCombo:e});if(1==h.length)r||(r=h[0]);else if(h.length&&!h[0]){r=r||h[1];var f=p.get_possible_relationship_indices({is_reciprocal:!l,OtherMvCombo:e});l&&null===h[0]&&f.length&&1==f.length&&(c=f[0])}if(!u)throw"No Sm for "+this.type;if(!p)throw"No Meta for "+this.type+" trying to add relationship";if(!o)throw"No Map for "+this.type;if(!r)throw"No RelationshipIndex for "+this.type;if(!e)throw"No OtherMvCombo for "+this.type;0===r.indexOf("reciprocal_")&&(l=!0,t.relationship_index=r=r.split("_")[1]);var m=l?this.reciprocal_relationships:this.relationships,_=l?this.relationships:this.reciprocal_relationships,v=m[r];if(!e.Identity)return Promise.reject("There is no Identity to accompany the MvCombo");if(!v)return Promise.reject("No relationship index to match "+r+" in "+this.type);var g,y=this,b={result:!1,SelfMvCombo:y,OtherMvCombo:e,RelationshipIndex:v,OtherView:t.OtherView,map_indices:[]};if(c&&(g=_[c]),i)return b.result=!!v.add_item(i,e.Identity.r_id,t.context_r_id||0,a,n),g&&g.add_item(i,e.Identity.r_id,t.context_r_id||0,a,n),this.relationship_map[e.Identity.r_id]=i,b.Relationship=i,Promise.resolve(b);var S=this._get_relationship_details({map:o,MvCombo:e,is_reciprocal:l,relationship_index:r}),C=S.relationship||new Sm.Core.Relationship,w=S.self_map_index,E=S.secondary_map_index;if(e.Identity===this.Identity)return Promise.reject("Cannot add the same MV");o.position=t.position||o.position,C.setMap(o).link_Mv(this,w).link_Mv(e,E),b.Relationship=C,b.map_indices=[w,E];var x=b.result=!!v.add_item(C,e.Identity.r_id,t.context_r_id||0,a,n);return g&&g.add_item(C,e.Identity.r_id,t.context_r_id||0,a,n),t.is_reciprocal=!l,this.relationship_map[e.Identity.r_id]=C,e.add_relationship(this,t,C).then(function(e){if(y.emit("add_relationship",b),x&&e.result)return b;throw Sm.CONFIG.DEBUG&&console.log(e,x),"Could not add relationship index"})},_continue_prompt_relationship_add:function(e,t){var i=Sm.Entities[this.type];if(!i)return Promise.reject("No SM");var n=i.Meta,o=!1;return new Promise(function(i,r){var s=n.get_possible_relationship_indices({OtherMvCombo:e,is_reciprocal:t.is_reciprocal});if(1==s.length&&(t.relationship_index=s[0]),!t.relationship_index){if(!n||!n.get_relationship_type)return void r();t.relationship_index=prompt("What is the relationship type?"),(0===t.relationship_index.indexOf("reciprocal_")||0===t.relationship_index.indexOf("!"))&&(t.relationship_index=t.relationship_index.replace("reciprocal_","").replace("!",""),o=!0,Sm.CONFIG.DEBUG&&console.log(t.relationship_index,o)),t.relationship_index=n.get_relationship_type({type:"index"},t.relationship_index)}if(!t.relationship_index)return void(r&&r());if(t.position||0===t.position||(t.position=prompt("At which position should we add the relationship?"),t.position=t.position||0,t.map.position=t.position),t.OtherView&&t.OtherView.MvCombo){var a=!0;t.OtherView.MvCombo.blur(),a&&(t.OtherView=t.OtherView.clone())}i({opposite:o})})},_build_other_MV:function(e,t){return e.build_MV(t)},_prompt_relationship_add:function(e,t){t=t||{},t.map=t.map||{},t.position=t.map.position=t.position||t.map.position;var i=this;if(t.prompt_called=t.prompt_called||0,t.prompt_called++,3==t.prompt_called)return Promise.reject("Error adding relationship");if(!e&&!t.type)return Promise.reject("No relationship and no type");if(!e){var n=Sm.Entities[t.type];if(!n)return Promise.reject("No type to accompany "+t.type);var o=n.Wrapper;return o&&2!=t.prompt_called?this._build_other_MV(o,t).then(function(e){return i.add_relationship(e,t)})["catch"](function(e){throw Sm.CONFIG.DEBUG&&console.log(e),e}):Promise.reject("Called twice and still no MvCombo")}return t.prompt=!1,i.blur(),this._continue_prompt_relationship_add(e,t).then(function(n){return n&&n.opposite?(Sm.CONFIG.DEBUG&&console.log(n,e),e.add_relationship(i,t)):i.add_relationship(e,t)})["catch"](function(e){throw Sm.CONFIG.DEBUG&&console.log(e),e})},_prompt_destroy:function(e){return confirm("Are you sure you want to delete "+this.type+" "+this.Identity.ent_id)?this._continue_destroy(e):Promise.reject("canceled destroy")},_prompt_save:function(e){return confirm("Are you sure you want to save "+this.type+" "+this.Identity.ent_id)?this._continue_save(e):Promise.reject("Canceled save")},_continue_save:function(e){var t=this.Model;if(!t)return Promise.reject(Sm.Errors.NonexistentModelError);var i=t.save(null,{patch:!0,wait:!0,silent:!!e.silent}).then(function(e){return Sm.CONFIG.DEBUG&&console.log(e),e});return i?i:Promise.reject("Could not save the model")},_continue_destroy:function(e){var t=this.Model;if(!t)return Promise.reject(Sm.Errors.NonexistentModelError);var i=Sm.Entities[this.type].Wrapper,n=t.destroy(),o=this;return(n?n:Promise.reject()).then(function(e){if(e&&e.success)return e;throw e.error}).then(i.destroy_MV.bind(i)).then(function(){o.setStatus("destroyed",!0)})},save:function(e){try{e=e||{};var t=!!e.prompt,i=Sm.Entities[this.type].Wrapper;return i?t?this._prompt_save(e):this._continue_save(e):Promise.reject("No Wrapper to match "+this.type)}catch(n){return Sm.CONFIG.DEBUG&&console.log(n),Promise.reject(n)}},destroy:function(e,t){var i=!!e.prompt,n=(Sm.Entities[this.type].Wrapper,this);return Sm.Entities[this.type].Wrapper?(i?this._prompt_destroy({View:t}):this._continue_destroy(e)).then(function(e){return n.forEachView(function(){this.destroy()}),e}):Promise.reject("No Wrapper to match "+this.type)},getRelationshipIndex:function(e,t){t=!!t;var i=t?this.reciprocal_relationships:this.relationships;return i[e]?i[e]:!1},toJSON:function(){var e=this.Model;return e.attributes}}),Sm.Core.MvCombo.replace_MV=function(e){var t,i,n,o=e.MvCombo,r=e.replace_effective,s=!!e.is_reciprocal,a=e.relationship,l=e.list_items_fn||function(){};e.replaced_MVs=e.replaced_MVs||[],e.replacement_MVs=e.replacement_MVs||[],e.items=e.items||{};var c=e.is_not_first||!1,d=e.replaced_relationships||[],u=e.replacement_relationships||[],p=function(t){var i={items:e.items,replacement_MVs:s?e.replaced_MVs:e.replacement_MVs,replaced_MVs:s?e.replacement_MVs:e.replaced_MVs,replacement_relationships:s?d:u,replaced_relationships:s?u:d};if(t&&!c){if(r&&i.replaced_MVs.length>1){var n=o.r_id,a=i.replaced_MVs.indexOf(n);a>-1&&(i.replaced_MVs.splice(a,1),i.replaced_relationships.splice(a,1))}Sm.Core.MvWrapper.register_MV_replacement(i.replaced_MVs,i.replacement_MVs,e.replacement_indices)}return i};if(e.iterations>10)return p();var h=l(o,s,p()),f=h.relationships||[],m=h.items||[];if(n=s?e.replaced_MVs:e.replacement_MVs,i=s?e.replacement_MVs:e.replaced_MVs,t=s?u:d,r){e.replace_effective=!1;for(var _=Sm.Core.MvWrapper.get_effective_MV(o),v=_.MVs,g=0;g<v.length;g++){var y=v[g];e.items[y]||(i.push(y),e.items[y]=Sm.Core.MvWrapper.convert_to_MvCombo(y),t.push(a||null))}}else e.items[o.r_id]=o,i.push(o.r_id),t.push(a||null);for(var b=0;b<m.length;b++){var S=m[b];n.indexOf(S.Identity.r_id)<0&&(e.MvCombo=S,e.is_reciprocal=!s,e.relationship=f[b],e.is_not_first=!0,Sm.Core.MvCombo.replace_MV(e))}return p(!0)},Sm.loaded.when_loaded("Core_MvWrapper",function(){Sm.loaded.add("Core_MvCombo")},"Core_MvCombo")}),define("Sm-Core-MvCombo",function(){}),define("Sm/urls/api",["require","Sm","Sm/urls/main"],function(e){var t=function(e,t){var i="";return e.user_id&&(i+="users/"+e.user_id+"/"),e.page_id&&(i+="pages/"+e.page_id+"/"),e.concept_id&&(i+="concepts/"+e.concept_id+"/"),e.dimension_id&&(i+="dimensions/"+e.dimension_id+"/"),e.collection_id&&(i+="collections/"+e.collection_id+"/"),e.dictionary_id&&(i+="dictionaries/"+e.dictionary_id+"/"),e.primary_id&&e.primary_id!=id&&(i+=t+"/"+e.primary_id+"/"),e.secondary_id&&e.secondary_id!=id&&(i+=t+"/"+e.secondary_id+"/"),i};return Sm.urls=Sm.urls||{},Sm.urls.api={generate:function(e){try{e=e&&"object"==typeof e?e:{};var i=Sm.urls.base_url+"api/";if(e.Relationship){var n=e.Relationship,o=n._map_links,r=[];for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];Sm.CONFIG.DEBUG&&console.log(a),a.type&&a.id&&r.push(a.type+"/"+a.id)}return i+r.join("/")}if(e.url)return i+e.url.replace("//","/");var l=e.MvCombo,c=e.id;!c&&l&&(c=l.id),c=c||null;var d=e.fetch,u=e.context||{page_id:null,section_id:null,concept_id:null,primary_id:null,secondary_id:null,collection_id:null,dimension_id:null,dictionary_id:null},p=l?l.type:e.type,h="",f=!!e.find_usages,m=Sm.Entities[p];if(!m)return!1;var _=m.Meta.lower_plural[p];if(h+=t(u,_),h+=d?d.toLowerCase()+"/":_+"/"+(c?c+"/":""),!h.length)return!1;var v=[];return f&&v.push("usages=1"),!!e.relationship_type&&v.push("relationship_type="+e.relationship_type),v.length&&(h+="?"+v.join("&")),i+h.replace("//","/")}catch(g){return Sm.CONFIG.DEBUG&&console.log(g),""}}},Sm.urls.api}),define("Sm/urls/main",["require","Sm/urls/api"],function(e){Sm.urls=Sm.urls||{},Sm.urls.base_url="http://s.dev.spwashi.com/",Sm.urls.entity_urls={page:function(e,t){var i=arguments.join("/");return i&&i.length?Sm.urls.base_url+"p/"+i.replace(/^\/|\/+$/gm,""):!1}},Sm.loaded.add("urls"),e("Sm/urls/api")}),define("Sm-Core-SmModel",["backbone","Sm/urls/main"],function(e){Sm.Core.SmModel=e.Model.extend({defaults:{_permissions:{edit:!1,view:!1,destroy:!1}},initialize:function(e){e=e||{},this.MvCombo=e.MvCombo||null,"MvCombo"in this.attributes&&(delete this.attributes.MvCombo,delete e.MvCombo),Object.defineProperties(this,{id:{get:function(){return this.attributes.id}},ent_id:{get:function(){return this.attributes.ent_id}}})},toJSON:function(){var e=Sm.Core.util.merge_objects({},this.attributes);return"MvCombo"in e&&delete e.MvCombo,e},url:function(){var e=this,t=this.context;return Sm.urls.api.generate({MvCombo:e,context:t})}}),Sm.loaded.add("Core_SmModel")}),require(["require","Emitter","Sm"],function(e,t){e("Sm"),e(["require","Sm/Extras/ViewAid"],function(){}),Sm.loaded.when_loaded("Extras_ViewAid",function(){"use strict";var e=function(){},t={template_string:'<div class="modal">\n    <div class="modal-content"></div>\n</div>',content_element_selector:".modal-content",click_events:[],events:{save:!1,open:e,close:e,edit:e,add:e},closeKey:27},i=function(e){var t=Sm.Extras.Modal.open_modals[Sm.Extras.Modal.open_modals.length-1];if(!t)return!0;if("number"!=typeof t.settings.closeKey&&(t.settings.closeKey=27),27==e.which)t.close();else if(e.ctrlKey&&83==e.which)return e.stopPropagation(),e.preventDefault(),Sm.Extras.Modal.sm_modal_save?!1:(Sm.Extras.Modal.sm_modal_save=!0,t.emit("save",t,t.content_element),window.setTimeout(function(){Sm.Extras.Modal.sm_modal_save=!1},1500),!1)};Sm.Extras.Modal=Sm.Extras.ViewAid.extend({init:function(e){e=e||{},this.element=null,t.click_events=[],this.settings=Sm.Core.util.merge_objects(t,e),this.settings.action_classname="modal-button",Sm.Extras.Modal.open_modals=Sm.Extras.Modal.open_modals||[],Sm.Extras.ViewAid.prototype.init.apply(this,arguments)},init_events:function(){Sm.Extras.ViewAid.prototype.init_events.apply(this,arguments)&&document.addEventListener("keydown",i)},get_content_element:function(e){return this.$content_element=this.$content_element||$(this.content_element),e?this.$content_element:this.content_element},close:function(){$("body").removeClass("modal-blur"),this.element.removeEventListener("click",this.get_bound("click_handler")),this.element&&this.element.parentNode.removeChild(this.element),this.emit("before_close",this,this.content_element),this.element=this.content_element=null,this.status.is_open=!1,Sm.Extras.Modal.open_modals.splice(Sm.Extras.Modal.open_modals.indexOf(this),1),Sm.Extras.Modal.open_modals.length||document.removeEventListener("keydown",i),this.emit("close",this,this.content_element)},open:function(){if(this.emit("before_open",this),this.element="string"==typeof this.settings.template_string?Sm.Core.util.createElement(_.template(this.settings.template_string)(),!0):!1,!this.element)return Sm.CONFIG.DEBUG&&console.log("no open"),!1;$("body").addClass("modal-blur");var e=$(this.element),t=this.content_element=e.find(this.settings.content_element_selector)[0];if(t&&(this.content_element.innerHTML=this.html),!this.content_element)return!1;this.init_events(),this.status.is_open=!0,Sm.Extras.Modal.open_modals.push(this);try{document.documentElement.appendChild(this.element)}catch(i){console.log(i)}this.emit("open",this,this.content_element)},set_errors:function(e,t,i){var n=this.get_content_element(!0);if(void 0!=i)for(var o=n.find("[data-attribute="+e+"]"),r=0;r<o.length;r++){var s=o[r],a=s.parentNode,l=$(a).find(".error"),c=l[0];s.hasOwnProperty("checked")?s.checked=!!i:($(s).val(i),s.innerHTML&&(s.innerHTML=i)),c&&(c.innerHTML=t)}},clear_errors:function(){for(var e=this.get_content_element(!0).find(".error"),t=0;t<e.length;t++){var i=e[t];i&&(i.innerHTML="")}}}),Sm.loaded.add("Extras_Modal")},"Extras_Modal")}),define("Sm/Extras/Modal",function(){}),require(["require","Class","Sm","Sm/Extras/Modal"],function(e,t){Sm.loaded.when_loaded("Extras_Modal",function(){Sm.Entities.Abstraction.Modal=Sm.Entities.Abstraction.Modal||{},Sm.Entities.Abstraction.Modal.Edit=Sm.Extras.Modal.extend({init:function(e){e=e||{};var t=e.MvCombo;this.self_type=e.self_type||!1,t&&t.constructor!==Array&&(t=[t]),this.display_type=e.display_type||"full.modal",this.MvComboArr=t||!1,this.ViewArr=[];var i=Sm.Extras.Modal.prototype.init.apply(this,arguments);Sm.Entities.Abstraction.Modal.Edit.generate_element.call(this);for(var n=["save","before_save","after_save","open","close","view_relationships","add_entity","select"],o=0;o<n.length;o++){var r=n[o],s=Sm.Entities.Abstraction.Modal.Edit["on_"+r]||function(){};this.on(r,s.bind(this))}return this.changed_attributes={},i},update:function(){},success:function(e,t){var i=(this.get_content_element(!0),this.MvComboArr);if(1===i.length){var n=i[0],o=this.ViewArr[0];e=e||{message:{text:"Undefined error",changed:[],defaulted:[],deferred:[],errors:[]},success:!1},e.message=e.message||{};var r=e.message.changed||[],s=e.message.model||{},a=e.message.defaulted||{},l=e.message.errors||{},c=n.Model||{};c.clear({silent:!0}),c.set(s,{silent:!0}),Sm.CONFIG.DEBUG&&console.log(s.content_location),this.update();var d=[];for(var u in t)if(t.hasOwnProperty(u))if(r.indexOf(u)<0){var p="Unknown error (1)";a[u]?p=a[u]:l[u]&&(p=l[u]);var h=s[u];this.set_errors(u,p,h)}else d.push(u);var f=this;return Sm.CONFIG.DEBUG&&console.log(t,s,c.attributes,c),n.forEachView(function(){var e=this;!e||o&&f.cid==e.cid||(e.update(d),e.refresh_all())}),Promise.resolve(d)}return Promise.reject("Not sure what to do with multiple MvCombos")},get_info_from_form:function(){var e=this.get_content_element(!0);if(1===this.MvComboArr.length){for(var t=e.find(".model.edit"),i={},n=this.MvComboArr[0].Model,o=0;o<t.length;o++){var r=$(t[o]),s=t[o],a=r.val();a.trim&&(a=a.trim());var l=r.attr("name");"has_title"==l&&(a=s.checked?1:0),l&&a!=n.get(l)&&(i[l]=a);var c={};c[l]=a+""}return n.set(i),this.changed_attributes=n.changedAttributes()}return{}}}),Sm.Entities.Abstraction.Modal.Edit.generate_element=function(){if(1===this.MvComboArr.length){var e=this.MvComboArr[0],t=this,i=this.self_type;return Sm.Entities[i].Garage.generate(this.display_type+".modal",e)["catch"](function(e){alert("There was an error - 1 - "+e)}).then(function(e){t.status.is_open?t._changeElement(e):(t.element=e,t.setElement(e))})["catch"](function(e){alert("There was an error - "+e)})}return Promise.reject("Could ot figure out what to do")},Sm.Entities.Abstraction.Modal.Edit.on_before_save=function(){this.clear_errors();var e=this.get_content_element(!0);e.addClass("saving"),this.changed_attributes=this.get_info_from_form()},Sm.Entities.Abstraction.Modal.Edit.on_save=function(){this.emit("before_save",this,this.content_element);var e=this,t=this.MvComboArr;if(1===t.length){var i=t[0];return i.save({silent:!0,patch:!0}).then(function(t){return e.resolve("after_save",t)})}return Promise.reject("Not sure what to do with multiple MvCombos yet")},Sm.Entities.Abstraction.Modal.Edit.on_after_save=function(e){return this.$content_element.removeClass("saving"),Sm.CONFIG.DEBUG&&console.log(e),this.success(e,this.changed_attributes),this.changed_attributes={},e},Sm.Entities.Abstraction.Modal.Edit.on_open=function(){var e=this.content_element,t=this;this.MvComboArr.forEach(function(i,n){t.ViewArr.push(i.addView(e,!1,{display_type:t.display_type}))})},Sm.Entities.Abstraction.Modal.Edit.on_close=function(){for(var e=this.ViewArr,t=0;t<e.length;t++){var i=e[t];i&&i.destroy()}},Sm.Entities.Abstraction.Modal.Edit.on_view_relationships=function(){if(this.self_type){if(1!==this.MvComboArr.length)return void(Sm.CONFIG.DEBUG&&console.log("Not sure what to do in this situation!"));var e=this.self_type,t=this.MvComboArr[0],i=this.get_content_element(!0),n=i.find(".view_relationship-container")[0];Sm.Entities[e]&&Sm.Entities[e].Garage.generate("relationships",t)["catch"](function(e){Sm.CONFIG.DEBUG&&console.log(e)}).then(function(e){if(n)if("string"==typeof e)Sm.CONFIG.DEBUG&&console.log(e),n.innerHTML="<hr>"+e;else{n.innerHTML="<hr>";try{n.appendChild(e)}catch(t){Sm.CONFIG.DEBUG&&console.log(t)}}})["catch"](function(e){Sm.CONFIG.DEBUG&&console.log(e)})}},Sm.Entities.Abstraction.Modal.Edit.on_add_entity=function(){},Sm.Entities.Abstraction.Modal.Edit.on_select=function(){var e=this;this.resolve("save").then(function(t){Sm.CONFIG.DEBUG&&console.log(t),Sm.Entities.Abstraction.Modal.Edit.generate_element.call(e)})["catch"](function(e){Sm.CONFIG.DEBUG&&console.log(e)})}},"Entities_Abstraction_Modal_Edit")}),define("Sm-Entities-Abstraction-ModalEdit",function(){}),require(["require","backbone","jquery","underscore","Cocktail","Sm-Entities-Abstraction-ModalEdit"],function(e,t,i,n,o){e(["require","Sm/Extras/DraggableMixin"],function(){}),e(["require","Sm/Extras/Modal"],function(){});var r=window.Sm;r.Core.SmView=t.View.extend({type:"",identifier:".spwashi-entity",relationship_index_obj:{collections:!1,children:"child_holder",composition:"composition",micros:!1,pivots:!1},elements:{},initial_events:{click:function(){r.CONFIG.DEBUG&&console.log(this)}},additional_events:{click:function(){r.CONFIG.DEBUG&&console.log(this)}},setPermission:function(e,t){if("string"==typeof e)this._permissions[e]=t;else if("object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&this.setPermission(i,e[i])},setStatus:function(e,t){if(this.status=this.status||{},"string"==typeof e)this.status[e]=t;else if("object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&this.setStatus(i,e[i])},queryPermission:function(e){if(!this.MvCombo)return!1;if("relate"==e&&(e="edit"),e in this._permissions)return this._permissions[e];var t=this.MvCombo.queryPermission(e);return null!=t&&(this._permissions[e]=t),e in this._permissions?this._permissions[e]:null},queryStatus:function(e){if(!this.MvCombo)return null;if("relate"==e&&(e="edit"),e in this.status)return this.status[e];var t=this.MvCombo.queryStatus(e);return null!=t&&(this.status[e]=t),e in this.status?this.status[e]:null},outerHTML:function(){return this.get_rendered("Element").outerHTML},init_permissions:function(e){return this.MvCombo?(e=e||{},this.status.is_permissions_init&&e.if_not_init?this:(this.queryPermission("destroy")&&this.$el.addClass("can-delete"),this.queryPermission("view")&&this.$el.addClass("can-view"),this.queryPermission("relate")&&this.$el.addClass("can-relate"),this.queryPermission("edit")&&this.$el.addClass("can-edit"),this.queryPermission("drag")&&this.$el.addClass("can-drag"),this.queryPermission("focus")&&this.$el.addClass("can-focus"),this.status.is_permissions_init=!0,this)):this},initialize:function(e){e=e||{},n.extend(this,t.Events),this.elements={},this._rendering_callbacks=this._rendering_callbacks||{},this._permissions={},this._cache={},this.status={},this.reference_to=[];var i=this,o=this.type;this.Identity=r.Core.Identifier.get_or_init({id:!1,r_id:i.cid,type:o+"View",Resource:i}),e.el&&(this.setStatus({rendered:!0,up_to_date:!0,init_from_el:!0}),e.el.sm_View=this,e.el.parentNode&&(this.referenceElement=e.el.parentNode),this.old_el=e.el,this.init_elements(),this.Identity&&(e.el.dataset.view_r_id=this.Identity.r_id)),e.model&&this.setStatus("has_model",!0),this._to_update=[],this._relationships={},this._reciprocal_relationships={},this.MvCombo=e.MvCombo||null,this.display_type=e.display_type?e.display_type:this.display_type?this.display_type:"full",n.extend(this,t.Events),r.loaded.when_loaded("Extras_Draggable",function(){r.Extras.Draggable.mixin.call(i,{can_start:function(){return r.CONFIG.DRAG_MODE},can_accept:function(e,t){return!0},data:i});e.el||i.el;i.makeElementDraggable&&i.makeElementDraggable(e.el||i.el,!0)},"_SmView_Init",2e4),this.init_button_control_events()},init_elements:function(){var e=this._rendering_callbacks;for(var t in e)e.hasOwnProperty(t)&&this.get_rendered(t);
},events:function(){return this.initial_events=this.initial_events||{},this.additional_events=this.additional_events||{},r.Core.util.merge_objects(this.initial_events,this.additional_events)},setMvCombo:function(e){e&&(this.MvCombo=e)},delegateEvents:function(){return t.View.prototype.delegateEvents.apply(this,arguments)},remove:function(){return this.MvCombo.blur(this),this.setStatus("rendered",!1),this.mark_unrendered(),this.undelegateEvents(),t.View.prototype.remove.apply(this,arguments)},refresh_all:function(e,t){e=e||{},t=t||[];var i=this.get_rendered("Element");this.delegateEvents(this.events());var n=this,o=this.MvCombo;if(!o)return this;var s=function(i,o){if(i&&o){o.innerHTML="";for(var s=i._meta._list.length;s--;){var a=i._meta._list[s];n.add_relationship({render:!0,Relationship:i.items[a],RelationshipIndex:i}).then(function(i){i.OtherView&&(i.OtherView.refresh_element(i.otherElement),i.OtherView.refresh_all(e,t))})["catch"](function(e){r.CONFIG.DEBUG&&console.log("error - ",e)})}}else r.CONFIG.DEBUG&&console.log("refresh no",i,o)};this.refresh_element(i);var a=o.relationships;for(var l in a)if(a.hasOwnProperty(l)){var c=a[l],d=this.get_rendered(this.relationship_index_obj[l]);d&&s(c,d)}return this},mark_unrendered:function(){this.setStatus({rendered:!1,permissions_init:!1});var e=this.elements;for(var t in e)e.hasOwnProperty(t)&&(e[t]=null)},mark_added:function(){this.setStatus({rendered:!0}),this.post_add_hook()},refresh_element:function(e){e&&(this.undelegateEvents(),this.setElement(e),this.init_elements(),this.setStatus({rendered:!0,up_to_date:!0}),this.delegateEvents(this.events()),this.init_button_control_events.call(this),this.post_add_hook())},post_add_hook:function(){var e=this;r.loaded.when_loaded("Vendor_MathJax",function(){e.setStatus&&e.setStatus("math_init",!0),MathJax.Hub.Queue(["Typeset",MathJax.Hub])})},render:function(e){e=e||{};var t=!!e.synchronous;if(!this.MvCombo||this.queryStatus("destroyed"))return t?!1:Promise.reject("There is no longer an existent MvCombo for this View");if(this.queryStatus("rendered")&&e.if_not_rendered||this.queryStatus("rendering"))return r.CONFIG.DEBUG&&console.log("ignore"),t?this.el:Promise.resolve(this.el);this.setStatus("rendering",!0);var n=this.MvCombo,o=this.type,s=this,a=function(e){var t=i(e);return s.old_el=s.el,s.setElement(t,"render"),s.setStatus({rendered:!0,rendering:!1,up_to_date:!0}),s.init_elements(),s.delegateEvents(s.events()),t[0]},l=r.Entities[o].Garage;return this.display_type=e.display_type||this.display_type||"full",t?a(l.generate(this.display_type,n,!0)):l.generate(this.display_type,n,!1).then(a)["catch"](function(e){r.CONFIG.DEBUG&&console.log(e)})},get_rendered:function(e){return e?"Element"==e?(this.queryStatus("rendered")||this.render({synchronous:!0,if_not_rendered:!0}),this.el):"$Element"==e?this.$el=i(this.get_rendered("Element")):this._rendering_callbacks[e]?this._rendering_callbacks[e].call(this):(e.indexOf("_element")<0&&(e+="_element"),this._rendering_callbacks[e]?this._rendering_callbacks[e].call(this):(e.indexOf("rendered_")<0&&(e="rendered_"+e),this._rendering_callbacks[e]?this._rendering_callbacks[e].call(this):!1)):!1},begin_add_relationship:function(e){e=e||{};var t,i;e.View?(t=e.View,i=e.MvCombo||t.MvCombo):e.MvCombo&&(i=e.MvCombo,t=i.getView({reference_element:this.referenceElement}));var n=this;return this.MvCombo.add_relationship(i,{type:e.type,OtherView:t,prompt:!!e.prompt})["catch"](function(e){throw r.CONFIG.DEBUG&&console.log(e),e}).then(function(e){if(e&&e.RelationshipIndex){var i=(e.SelfMvCombo,e.OtherMvCombo,e.OtherView),o=e.Relationship,s=e.RelationshipIndex,a=e.map_indices[0],l=e.map_indices[1];if(o){var c={};c[a]=n,c[l]=i||t,o.register_view_relationship(c),n.add_relationship({render:!0,Relationship:o,RelationshipIndex:s})["catch"](function(e){r.CONFIG.DEBUG&&console.log("error - ",e)})}return e}})["catch"](function(e){throw r.CONFIG.DEBUG&&console.log(e),e}).then(function(e){if(e&&e.RelationshipIndex){if(e.Relationship)return e.Relationship.save();var t=e.RelationshipIndex,i=0;t.save({context_id:i})["catch"](function(e){throw r.CONFIG.DEBUG&&console.log(e),e})}})["catch"](function(e){throw console.log(e),e})},add_relationship:function(e){var t,n=!!e.render,o=e.relationship_type_index||!1,s=e.map_index||!1,a=e.self_map_index||!1,l=e.Relationship||!1,c=this.MvCombo,d=e.RelationshipIndex||!1,u=!!e.is_reciprocal,p=e.container_template||!1;if(l&&d&&(!o&&d._meta&&d._meta._index&&(o=d._meta._index),t=e.MvCombo||l.get_Mv({SelfMvCombo:c,map_index:s}),!s&&t&&(s=l.get_map_index_of_Mv(t)),!a&&c&&(a=l.get_map_index_of_Mv(c))),!(s&&a&&o&&l&&c))return Promise.reject("Could not identify details");var h=this,f=e.relationship_obj||{};if(f[s]=null,f[a]=this,t=t||e.MvCombo||l.get_Mv({SelfMvCombo:c,map_index:s}),!t)return Promise.reject("There is no other MV");var m=l.getView(this,s);if(!m){if(m=t.getView({reference_element:h.referenceElement}),!m)return Promise.reject("There is no other View");f[s]=m,l.register_view_relationship(f)}this[o]=this[o]||{},this[o][t.Identity.r_id]=m,e.is_reciprocal?(this._reciprocal_relationships[o]=this._reciprocal_relationships[o]||{},this._reciprocal_relationships[o][t.Identity.r_id]=m):(e.is_reciprocal=!0,e.render=!1,e.map_index=s,e.self_map_index=a,this._relationships[o]=this._relationships[o]||{},this._relationships[o][t.Identity.r_id]=m,m.add_relationship(e)["catch"](console.log));var _=u?c.reciprocal_relationships[o]:c.relationships[o];if(!_)return Promise.reject("There is no index to match "+o+" in "+c.type);var v=_.locate(t.Identity,e.context_r_id||0);v=v||0;var g=Promise.resolve([null]);if(!n)return g;var y=this.wrap_element_for_relationship(m,o,l,p),b=(this.get_rendered("Element"),this.relationship_index_obj[o]),S=this.get_rendered(b);if(!y)return Promise.reject("There is no other element");if(S){var C=i(S),w=C.children(".content");w[0]&&(C=i(w[0]));var E,x,M=C.children(),T=M.length;if(T&&T>v)x=M,E=x[v],E.parentNode.insertBefore(y,E),m.mark_added();else try{S.appendChild(y),m.mark_added()}catch(D){throw r.CONFIG.DEBUG&&console.log(D),D}}return Promise.resolve({self_index_element:S,OtherView:m,otherElement:y}).then(function(e){var i=t.r_id,n=r.Core.MvWrapper.get_effective_MV(i,!1,!0);return r.CONFIG.DEBUG&&console.log(n,i),n?r.Core.SmView.replace_with_elements({referenceElement:S,replacement_MVs:n.MVs,replaced_MVs:[i],replaced_relationships:[],replacement_relationships:[]}).then(function(){return e})["catch"](function(e){r.CONFIG.DEBUG&&console.log(e)}):e})},accept_drop:function(e){return this.begin_add_relationship({View:e})},init_button_control_events:function(){var e=this,t=this.get_rendered("button_control");t&&"object"==typeof t&&(t.onclick=function(t){var n=t.target,o=i(n);e.queryPermission("edit")&&o.hasClass("edit")&&o.hasClass("button")?e.prompt_edit():e.queryPermission("relate")&&o.hasClass("add")&&o.hasClass("button")&&this.begin_add_relationship()})},clone:function(){var e=this.get_rendered("Element").cloneNode(!0),t=this.prototype?this.prototype.constructor:this.constructor,i=this.MvCombo,n=this.type,o=new t({type:n,MvCombo:i,el:e}),s=this;return r.loaded.when_loaded("Extras_Draggable",function(){s.setDraggingStatus(!1)}),i.addView(o,this.referenceElement),o},handle:!0,setElement:function(e){e&&(e=e[0]||e),e&&(e.sm_View=this),this.Identity&&(e.dataset.view_r_id=this.Identity.r_id),this.referenceElement=e.parentNode?e.parentNode:null;var i=this;t.View.prototype.setElement.apply(this,arguments),this.init_permissions(),r.loaded.when_loaded("Extras_Draggable",function(){i.makeElementDraggable&&i.makeElementDraggable(null,i.handle||void 0===i.handle?i.handle:!0)},"_SmView_SetElement",2e4)},renderDragMirror:function(e){var t=e.cloneNode(!0),i=t.getBoundingClientRect(),n=document.createElement("div");return n.style.position="absolute",t.style.width=i.width+"px",n.appendChild(t),n.className="sm-mirror",n},wrap_element_for_relationship:function(e,t,i,n){return e.get_rendered("Element")},find_closest_relationship:function(){var e=this.$el.closest("[data-relationship-r_id]"),t=!1;if(e.length){var i=e.data("relationship-r_id");t=r.Core.Identifier.identify({r_id:i}),r.CONFIG.DEBUG&&console.log(t,i)}return{Relationship:t,el:e[0]}},replaceOldElement:function(){var e=this.el,t=this.render({display_type:this.display_type,synchronous:!0});this.old_el&&this.old_el!=t&&this.old_el.parentNode&&this.old_el.parentNode.replaceChild(t,this.old_el),this.old_el=e,this.refresh_element(t),this.refresh_all()},focus:function(){return this.queryStatus("focused")?this:(this.init_permissions({if_not_init:!0}),this.setStatus("focused",!0),this.get_rendered("$Element").addClass("focused"),this)},blur:function(){return this.queryStatus("focused")?(this.setStatus("focused",!1),this.$el.removeClass("focused"),this):this},select:function(){return this.setStatus("selected",!0),this.get_rendered("$Element").addClass("selected"),this},deselect:function(){return this.setStatus("selected",!1),this.get_rendered("$Element").removeClass("selected"),this},activate:function(){return this.setStatus("active",!0),this.get_rendered("$Element").addClass("activated"),this},deactivate:function(){return this.setStatus("active",!1),this.get_rendered("$Element").removeClass("activated"),this},destroy:function(){return this.undelegateEvents(),r.CONFIG.DEBUG&&console.log("removing - ",this.cid),this.$el.removeData().unbind(),this.remove(),this.MvCombo.removeView(this.cid),t.View.prototype.remove.call(this),this},prompt_edit:function(e){e=e||{},e.display_type=e.display_type||"full";var t=this.MvCombo;if(t){var i=r.Core.Meta.get_MVs("selected"),n=[];for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];n.push(s.getResource())}var a=new r.Entities.Abstraction.Modal.Edit({MvCombo:[t],self_type:t.type});a.open()}},update:function(e){if(this.display_type.indexOf("modal")>-1)return this;if(!this.MvCombo)return this;if(this.model=this.model||this.MvCombo.Model,!this.model)return r.CONFIG.DEBUG&&console.log("There was no model!"),this;e||(this.init_elements(),e=Object.keys(this.elements)),r.CONFIG.DEBUG&&console.log(e);var t=this.type.toLowerCase(),i=t+"_type";if(r.CONFIG.DEBUG&&console.log(i),e.indexOf(i)>-1)return this.mark_unrendered(),this.replaceOldElement(),this;for(var n=0;n<e.length;n++){var o=e[n];this._updateElementFromModelProperty(o,this.get_rendered(o))}return this},_updateElementFromModelProperty:function(e,t){if(t){var i=this.model.get(e);void 0!=i&&(t.innerHTML=this.model.escape(e))}},add_bound:function(e,t,i){return this._fns=this._fns||{},"function"==typeof t||this._fns[e]?this._fns[e]=this._fns[e]||t.bind(i||this):(r.CONFIG.DEBUG&&console.log(t,e),function(){})},get_bound:function(e,t){return this._fns=this._fns||{},this._fns[e]?this._fns[e]:t?!1:function(){}.bind(this)}}),r.Core.SmView.replace_with_elements=function(e){var t=e.referenceElement,i=e.replaced_MVs||[],n=e.replacement_MVs||[],o=(e.replaced_relationships||[],e.replacement_relationships||[],e.items||{}),s="function"==typeof e.forEachView?e.forEachView:!1;if(!n.length)return Promise.reject("No replacement Views specified");for(var a,l=i.length;l--;){var c=i[l];r.CONFIG.DEBUG&&console.log(c);var d=o[c]||r.Core.Identifier.identify(c);if(d){var u=d.getView({strict:!0,reference_element:t});r.CONFIG.DEBUG&&console.log(c,u),a?u.remove():a=u}}var p,h=Promise.resolve(a),f=!1,m=function(e,i,n){if(!n&&!i)return e;if("string"==typeof i)if(o[i])i=o[i];else{var l=r.Core.Identifier.retrieve(i);l&&(i=l.getResource())}if(!i||!i.getView)return e;var c=i.getView({reference_element:t}),d=function(e){return c.render({if_not_rendered:!0,synchronous:!1}).then(function(t){c.refresh_all(),e||r.CONFIG.DEBUG&&console.log("Previous View does not exist ",e,c);var i=e.el;return r.Core.util.insertAfter(c.el,i),c.mark_added(),c.referenceElement=t.parentNode,f||e.cid!=a.cid||(a.remove(),f=!0),p||(p=c),s&&s.call(c),c})};return e.then(d)};return n.reduce(m,h).then(function(){return p&&p.MvCombo.focus(p),!0})},r.loaded.add("Core_SmView"),function(e){var t=!1,i=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];t.push(n.ent_id?n.type+": "+n.ent_id:n.type+": "+(n.id?n.id:n.r_id))}return t.length&&confirm("Are you sure you want to delete "+t.join(", "))?Promise.resolve():Promise.reject()},n=function(){var e=r.Core.Meta.MvMaps.selected_MVs,t=[];for(var n in e)if(e.hasOwnProperty(n)){var o=e[n].getResource(),s=o.ViewMaps.selected_Views,a=!1;for(var l in s)if(s.hasOwnProperty(l)){var c,d=s[l].getResource(),u=d.find_closest_relationship();u&&(c=u.Relationship)?t.push(c.Identity):a||t.push(o.Identity)}}i(t).then(function(){for(var e=0;e<t.length;e++){var i=t[e],n=i.getResource();n.destroy({silent:!1})}}),r.CONFIG.DEBUG&&console.log(t)};e.addEventListener("keydown",function(e){76==e.keyCode&&e.shiftKey?0==t?t=setTimeout(function(){t=!1},500):(t=!1,clearTimeout(t),r.CONFIG.DEBUG&&console.log(" ---------------------------------------- "),r.CONFIG.DEBUG&&console.log(" ")):46==e.keyCode&&n()}),e.addEventListener("keyup",function(e){16==e.keyCode&&t!==!1&&(clearTimeout(t),t=!1)})}(document)}),define("Sm-Core-SmView",function(){}),define("Sm-Core-Meta",["Emitter"],function(e){var t=e.extend({CONFIG:{DEBUG:!1,EDIT:!1,DRAG_N_DROP:!1},MvMaps:{},init:function(e){this.events=[],this._callbacks={},this.MvMaps={loaded_MVs:{},focused_MVs:{},selected_MVs:{},active_MVs:{},deleted_MVs:{}},this.loaded_ent_ids={},e=e||{},this.type=e.type,this.lower_plural=this.lower_plural||{},this.lower_singular=this.lower_singular||{};var t=Sm.Entities;for(var i in t)t.hasOwnProperty(i)&&(this.lower_singular[i]=this.lower_singular[i]||i.toLowerCase(),this.lower_plural[i]=this.lower_plural[i]||(t[i].plural||i+"s").toLowerCase())},relationship_types:{children:1,composition:2,macros:3,micros:4,pivots:5},relationship_subtypes:{eli5:1,thing_explainer:2,image:3,video:4,audio:5,text:6},relationship_type_obj:{},types:{standard:1},relationship_aliases:{},get_type:function(e,t){var i=this.types;for(var n in i)if(i.hasOwnProperty(n)&&(n==t||i[n]==t))return"index"==e?n:i[n];return!1},get_possible_relationship_indices:function(e){return[]},get_relationship_type:function(e,t){var i=!!e.is_reciprocal,n=e.type||"index";t=t||e.identifier||!1;var o,r=e.map||{},s=e.sub?this.relationship_subtypes:this.relationship_type_obj,a="id"==n;t=t||r.relationship_type||!1;var l=Sm.Entities;if(!t)return!1;for(var c in s)if(s.hasOwnProperty(c)){var d=s[c];if(o=a&&d.id?d.id:c,a&&(o=d.id?d.id:parseInt(d)),d==t)return o;if(t==c)return o;if("object"==typeof d){if(d.index_singular=d.index_singular||"",d.id=d.id||"",t==d.index_singular||d.index_singular.toLowerCase().search(new RegExp("\\|?"+t.toLowerCase()+"\\|?"))>-1)return o;if(d.id&&t==d.id)return o}}for(var u in l)if(l.hasOwnProperty(u)&&u==this.type){var p=this.lower_singular[u]+"_id";if(p in r)return i?this.lower_plural[u]:this.lower_plural[this.type]}return e.sub&&Sm.CONFIG.DEBUG&&console.log(d),!1},get_MVs:function(e){return/loaded|active|focused|selected|deleted/.test(e)?this.MvMaps[e+"_MVs"]:void 0},add_MV_as:function(e,t){if(!t)return this;var i=t.ent_id||t.getResource().ent_id,n=t.r_id;if(!n)return this;var o=this.MvMaps;switch(this.type!==!1&&Sm.Core.Meta.add_MV_as(e,t),e){case"loaded":o.loaded_MVs[n]=t;break;case"active":case"focused":case"selected":if(!(e+"_MVs"in o))return Sm.CONFIG.DEBUG&&console.log(e,o),this;o[e+"_MVs"][n]=t,!(n in o.loaded_MVs)&&(o.loaded_MVs[n]=t),!(n in o.active_MVs)&&(o.active_MVs[n]=t)}return!!i&&(this.loaded_ent_ids[i]=t),this},remove_MV_as:function(e,t){var i=t.r_id;if(!i)return this;var n=e+"_MVs",o=this.MvMaps;return o[n]?(this.type!==!1&&Sm.Core.Meta.remove_MV_as(e,t),i in this.MvMaps[n]&&delete this.MvMaps[n][i],"loaded"==n?(i in this.MvMaps.active_MVs&&delete this.MvMaps.active_MVs[i],i in this.MvMaps.selected_MVs&&delete this.MvMaps.selected_MVs[i],i in this.MvMaps.focused_MVs&&delete this.MvMaps.focused_MVs[i]):"active"==n&&(i in this.MvMaps.selected_MVs&&delete this.MvMaps.selected_MVs[i],i in this.MvMaps.focused_MVs&&delete this.MvMaps.focused_MVs[i]),!0):!1}});Sm.Core.Meta=new t({type:!1}),Sm.Core.Meta.base_constructor=t,Sm.loaded.add("Core_Meta")}),require(["require","Sm-Core-RelationshipIndex","Sm-Core-Relationship","Sm-Core-MvWrapper","Sm-Core-MvCombo","Sm-Core-Identifier","Sm-Core-SmModel","Sm-Core-SmView","Sm-Core-Meta"],function(e){e(["Sm-Core-RelationshipIndex"],function(){}),e(["Sm-Core-Relationship"],function(){}),e(["Sm-Core-MvWrapper"],function(){}),e(["Sm-Core-MvCombo"],function(){}),e(["Sm-Core-Identifier"],function(){}),e(["Sm-Core-SmModel"],function(){}),e(["Sm-Core-SmView"],function(){}),e(["Sm-Core-Meta"],function(){}),Sm.loaded.when_loaded(["Core_Identifier","Core_Meta","Core_MvCombo","Core_MvWrapper","Core_Relationship","Core_RelationshipIndex","Core_SmModel","Core_SmView"],Sm,"Core").then(function(e){Sm.CONFIG.DEBUG&&console.log(e)})["catch"](function(e){Sm.CONFIG.DEBUG&&console.log("ERROR:",e)})}),define("Sm-Core-Core",function(){}),"undefined"==typeof global)var global="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};var event_map=[],regex_on=/^on/;for(var event_name in global)regex_on.test(event_name)&&event_map.push(event_name.slice(2));require(["require","Sm"],function(e){e("Sm");var t,i;global.addEventListener?(t=function(e,t,i,n){return e?e.addEventListener(t,i,n):!1},i=function(e,t,i,n){return e?e.removeEventListener(t,i,n):(console.log(arguments),!1)}):(t=function(e,t,i){return e.attachEvent("on"+t,s(e,t,i))},i=function(e,t,i){var n=a(e,t,i);return n?e.detachEvent("on"+t,n):void 0});var n=[],o=function(e,t,i){var n;-1===event_map.indexOf(t)?n=new CustomEvent(t,{detail:i}):doc.createEvent?(n=doc.createEvent("Event"),n.initEvent(t,!0,!0)):doc.createEventObject&&(n=doc.createEventObject()),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+t,n)},r=function(e,t,i){return function(t){var n=t||global.event;n.target=n.target||n.srcElement,n.preventDefault=n.preventDefault||function(){n.returnValue=!1},n.stopPropagation=n.stopPropagation||function(){n.cancelBubble=!0},n.which=n.which||n.keyCode,i.call(e,n)}},s=function(e,t,i){var o=a(e,t,i)||r(e,t,i);return n.push({wrapper:o,element:e,type:t,fn:i}),o},a=function(e,t,i){var o=l(e,t,i);if(o){var r=n[o].wrapper;return n.splice(o,1),r}},l=function(e,t,i){var o,r;for(o=0;o<n.length;o++)if(r=n[o],r.element===e&&r.type===t&&r.fn===i)return o};Sm.loaded.when_loaded("core_util",function(){Sm.Core.util.crossvent={add:t,remove:i,fabricate:o},Sm.loaded.add("Core_util_crossvent")},"Core_util_crossvent")}),define("crossvent",function(){}),function(e,t,i){function n(t,i){this.bodyOverflowX,this.callbacks={hide:[],show:[]},this.checkInterval=null,this.Content,this.$el=e(t),this.$elProxy,this.elProxyPosition,this.enabled=!0,this.options=e.extend({},l,i),this.mouseIsOverProxy=!1,this.namespace="tooltipster-"+Math.round(1e5*Math.random()),this.Status="hidden",this.timerHide=null,this.timerShow=null,this.$tooltip,this.options.iconTheme=this.options.iconTheme.replace(".",""),this.options.theme=this.options.theme.replace(".",""),this._init()}function o(t,i){var n=!0;return e.each(t,function(e,o){return"undefined"==typeof i[e]||t[e]!==i[e]?(n=!1,!1):void 0}),n}function r(){return!d&&c}function s(){var e=i.body||i.documentElement,t=e.style,n="transition";if("string"==typeof t[n])return!0;v=["Moz","Webkit","Khtml","O","ms"],n=n.charAt(0).toUpperCase()+n.substr(1);for(var o=0;o<v.length;o++)if("string"==typeof t[v[o]+n])return!0;return!1}var a="tooltipster",l={animation:"fade",arrow:!0,arrowColor:"",autoClose:!0,content:null,contentAsHTML:!1,contentCloning:!0,debug:!0,delay:200,minWidth:0,maxWidth:null,functionInit:function(e,t){},functionBefore:function(e,t){t()},functionReady:function(e,t){},functionAfter:function(e){},hideOnClick:!1,icon:"(?)",iconCloning:!0,iconDesktop:!1,iconTouch:!1,iconTheme:"tooltipster-icon",interactive:!1,interactiveTolerance:350,multiple:!1,offsetX:0,offsetY:0,onlyOne:!1,position:"top",positionTracker:!1,positionTrackerCallback:function(e){"hover"==this.option("trigger")&&this.option("autoClose")&&this.hide()},restoration:"current",speed:350,timer:0,theme:"tooltipster-default",touchDevices:!0,trigger:"hover",updateAnimation:!0};n.prototype={_init:function(){var t=this;if(i.querySelector){var n=null;void 0===t.$el.data("tooltipster-initialTitle")&&(n=t.$el.attr("title"),void 0===n&&(n=null),t.$el.data("tooltipster-initialTitle",n)),null!==t.options.content?t._content_set(t.options.content):t._content_set(n);var o=t.options.functionInit.call(t.$el,t.$el,t.Content);"undefined"!=typeof o&&t._content_set(o),t.$el.removeAttr("title").addClass("tooltipstered"),!c&&t.options.iconDesktop||c&&t.options.iconTouch?("string"==typeof t.options.icon?(t.$elProxy=e('<span class="'+t.options.iconTheme+'"></span>'),t.$elProxy.text(t.options.icon)):t.options.iconCloning?t.$elProxy=t.options.icon.clone(!0):t.$elProxy=t.options.icon,t.$elProxy.insertAfter(t.$el)):t.$elProxy=t.$el,"hover"==t.options.trigger?(t.$elProxy.on("mouseenter."+t.namespace,function(){(!r()||t.options.touchDevices)&&(t.mouseIsOverProxy=!0,t._show())}).on("mouseleave."+t.namespace,function(){(!r()||t.options.touchDevices)&&(t.mouseIsOverProxy=!1)}),c&&t.options.touchDevices&&t.$elProxy.on("touchstart."+t.namespace,function(){t._showNow()})):"click"==t.options.trigger&&t.$elProxy.on("click."+t.namespace,function(){(!r()||t.options.touchDevices)&&t._show()})}},_show:function(){var e=this;"shown"!=e.Status&&"appearing"!=e.Status&&(e.options.delay?e.timerShow=setTimeout(function(){("click"==e.options.trigger||"hover"==e.options.trigger&&e.mouseIsOverProxy)&&e._showNow()},e.options.delay):e._showNow())},_showNow:function(i){var n=this;n.options.functionBefore.call(n.$el,n.$el,function(){if(n.enabled&&null!==n.Content){i&&n.callbacks.show.push(i),n.callbacks.hide=[],clearTimeout(n.timerShow),n.timerShow=null,clearTimeout(n.timerHide),n.timerHide=null,n.options.onlyOne&&e(".tooltipstered").not(n.$el).each(function(t,i){var n=e(i),o=n.data("tooltipster-ns");e.each(o,function(e,t){var i=n.data(t),o=i.status(),r=i.option("autoClose");"hidden"!==o&&"disappearing"!==o&&r&&i.hide()})});var o=function(){n.Status="shown",e.each(n.callbacks.show,function(e,t){t.call(n.$el)}),n.callbacks.show=[]};if("hidden"!==n.Status){var r=0;"disappearing"===n.Status?(n.Status="appearing",s()?(n.$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-"+n.options.animation+"-show"),n.options.speed>0&&n.$tooltip.delay(n.options.speed),n.$tooltip.queue(o)):n.$tooltip.stop().fadeIn(o)):"shown"===n.Status&&o()}else{n.Status="appearing";var r=n.options.speed;n.bodyOverflowX=e("body").css("overflow-x"),e("body").css("overflow-x","hidden");var a="tooltipster-"+n.options.animation,l="-webkit-transition-duration: "+n.options.speed+"ms; -webkit-animation-duration: "+n.options.speed+"ms; -moz-transition-duration: "+n.options.speed+"ms; -moz-animation-duration: "+n.options.speed+"ms; -o-transition-duration: "+n.options.speed+"ms; -o-animation-duration: "+n.options.speed+"ms; -ms-transition-duration: "+n.options.speed+"ms; -ms-animation-duration: "+n.options.speed+"ms; transition-duration: "+n.options.speed+"ms; animation-duration: "+n.options.speed+"ms;",d=n.options.minWidth?"min-width:"+Math.round(n.options.minWidth)+"px;":"",u=n.options.maxWidth?"max-width:"+Math.round(n.options.maxWidth)+"px;":"",p=n.options.interactive?"pointer-events: auto;":"";if(n.$tooltip=e('<div class="tooltipster-base '+n.options.theme+'" style="'+d+" "+u+" "+p+" "+l+'"><div class="tooltipster-content"></div></div>'),s()&&n.$tooltip.addClass(a),n._content_insert(),n.$tooltip.appendTo("body"),n.reposition(),n.options.functionReady.call(n.$el,n.$el,n.$tooltip),s()?(n.$tooltip.addClass(a+"-show"),n.options.speed>0&&n.$tooltip.delay(n.options.speed),n.$tooltip.queue(o)):n.$tooltip.css("display","none").fadeIn(n.options.speed,o),n._interval_set(),e(t).on("scroll."+n.namespace+" resize."+n.namespace,function(){n.reposition()}),n.options.autoClose)if(e("body").off("."+n.namespace),"hover"==n.options.trigger){if(c&&setTimeout(function(){e("body").on("touchstart."+n.namespace,function(){n.hide()})},0),n.options.interactive){c&&n.$tooltip.on("touchstart."+n.namespace,function(e){e.stopPropagation()});var h=null;n.$elProxy.add(n.$tooltip).on("mouseleave."+n.namespace+"-autoClose",function(){clearTimeout(h),h=setTimeout(function(){n.hide()},n.options.interactiveTolerance)}).on("mouseenter."+n.namespace+"-autoClose",function(){clearTimeout(h)})}else n.$elProxy.on("mouseleave."+n.namespace+"-autoClose",function(){n.hide()});n.options.hideOnClick&&n.$elProxy.on("click."+n.namespace+"-autoClose",function(){n.hide()})}else"click"==n.options.trigger&&(setTimeout(function(){e("body").on("click."+n.namespace+" touchstart."+n.namespace,function(){n.hide()})},0),n.options.interactive&&n.$tooltip.on("click."+n.namespace+" touchstart."+n.namespace,function(e){e.stopPropagation()}))}n.options.timer>0&&(n.timerHide=setTimeout(function(){n.timerHide=null,n.hide()},n.options.timer+r))}})},_interval_set:function(){var t=this;t.checkInterval=setInterval(function(){if(0===e("body").find(t.$el).length||0===e("body").find(t.$elProxy).length||"hidden"==t.Status||0===e("body").find(t.$tooltip).length)("shown"==t.Status||"appearing"==t.Status)&&t.hide(),t._interval_cancel();else if(t.options.positionTracker){var i=t._repositionInfo(t.$elProxy),n=!1;o(i.dimension,t.elProxyPosition.dimension)&&("fixed"===t.$elProxy.css("position")?o(i.position,t.elProxyPosition.position)&&(n=!0):o(i.offset,t.elProxyPosition.offset)&&(n=!0)),n||(t.reposition(),t.options.positionTrackerCallback.call(t,t.$el))}},200)},_interval_cancel:function(){clearInterval(this.checkInterval),this.checkInterval=null},_content_set:function(e){"object"==typeof e&&null!==e&&this.options.contentCloning&&(e=e.clone(!0)),this.Content=e},_content_insert:function(){var e=this,t=this.$tooltip.find(".tooltipster-content");"string"!=typeof e.Content||e.options.contentAsHTML?t.empty().append(e.Content):t.text(e.Content)},_update:function(e){var t=this;t._content_set(e),null!==t.Content?"hidden"!==t.Status&&(t._content_insert(),t.reposition(),t.options.updateAnimation&&(s()?(t.$tooltip.css({width:"","-webkit-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-moz-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-o-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-ms-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms",transition:"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms"}).addClass("tooltipster-content-changing"),setTimeout(function(){"hidden"!=t.Status&&(t.$tooltip.removeClass("tooltipster-content-changing"),setTimeout(function(){"hidden"!==t.Status&&t.$tooltip.css({"-webkit-transition":t.options.speed+"ms","-moz-transition":t.options.speed+"ms","-o-transition":t.options.speed+"ms","-ms-transition":t.options.speed+"ms",transition:t.options.speed+"ms"})},t.options.speed))},t.options.speed)):t.$tooltip.fadeTo(t.options.speed,.5,function(){"hidden"!=t.Status&&t.$tooltip.fadeTo(t.options.speed,1)}))):t.hide()},_repositionInfo:function(e){return{dimension:{height:e.outerHeight(!1),width:e.outerWidth(!1)},offset:e.offset(),position:{left:parseInt(e.css("left")),top:parseInt(e.css("top"))}}},hide:function(i){var n=this;i&&n.callbacks.hide.push(i),n.callbacks.show=[],clearTimeout(n.timerShow),n.timerShow=null,clearTimeout(n.timerHide),n.timerHide=null;var o=function(){e.each(n.callbacks.hide,function(e,t){t.call(n.$el)}),n.callbacks.hide=[]};if("shown"==n.Status||"appearing"==n.Status){n.Status="disappearing";var r=function(){n.Status="hidden","object"==typeof n.Content&&null!==n.Content&&n.Content.detach(),n.$tooltip.remove(),n.$tooltip=null,e(t).off("."+n.namespace),e("body").off("."+n.namespace).css("overflow-x",n.bodyOverflowX),e("body").off("."+n.namespace),n.$elProxy.off("."+n.namespace+"-autoClose"),n.options.functionAfter.call(n.$el,n.$el),o()};s()?(n.$tooltip.clearQueue().removeClass("tooltipster-"+n.options.animation+"-show").addClass("tooltipster-dying"),n.options.speed>0&&n.$tooltip.delay(n.options.speed),n.$tooltip.queue(r)):n.$tooltip.stop().fadeOut(n.options.speed,r)}else"hidden"==n.Status&&o();return n},show:function(e){return this._showNow(e),this},update:function(e){return this.content(e)},content:function(e){return"undefined"==typeof e?this.Content:(this._update(e),this)},reposition:function(){function i(){var i=e(t).scrollLeft();0>D-i&&(r=D-i,D=i),D+l-i>s&&(r=D-(s+i-l),D=s+i-l)}function n(i,n){a.offset.top-e(t).scrollTop()-c-I-12<0&&n.indexOf("top")>-1&&(N=i),a.offset.top+a.dimension.height+c+12+I>e(t).scrollTop()+e(t).height()&&n.indexOf("bottom")>-1&&(N=i,$=a.offset.top-c-I-12)}var o=this;if(0!==e("body").find(o.$tooltip).length){o.$tooltip.css("width",""),o.elProxyPosition=o._repositionInfo(o.$elProxy);var r=null,s=e(t).width(),a=o.elProxyPosition,l=o.$tooltip.outerWidth(!1),c=(o.$tooltip.innerWidth()+1,o.$tooltip.outerHeight(!1));if(o.$elProxy.is("area")){var d=o.$elProxy.attr("shape"),u=o.$elProxy.parent().attr("name"),p=e('img[usemap="#'+u+'"]'),h=p.offset().left,f=p.offset().top,m=void 0!==o.$elProxy.attr("coords")?o.$elProxy.attr("coords").split(","):void 0;if("circle"==d){var _=parseInt(m[0]),v=parseInt(m[1]),g=parseInt(m[2]);a.dimension.height=2*g,a.dimension.width=2*g,a.offset.top=f+v-g,a.offset.left=h+_-g}else if("rect"==d){var _=parseInt(m[0]),v=parseInt(m[1]),y=parseInt(m[2]),b=parseInt(m[3]);a.dimension.height=b-v,a.dimension.width=y-_,a.offset.top=f+v,a.offset.left=h+_}else if("poly"==d){for(var S=0,C=0,w=0,E=0,x="even",M=0;M<m.length;M++){var T=parseInt(m[M]);"even"==x?(T>w&&(w=T,0===M&&(S=w)),S>T&&(S=T),x="odd"):(T>E&&(E=T,1==M&&(C=E)),C>T&&(C=T),x="even")}a.dimension.height=E-C,a.dimension.width=w-S,a.offset.top=f+C,a.offset.left=h+S}else a.dimension.height=p.outerHeight(!1),a.dimension.width=p.outerWidth(!1),a.offset.top=f,a.offset.left=h}var D=0,O=0,$=0,I=parseInt(o.options.offsetY),k=parseInt(o.options.offsetX),N=o.options.position;if("top"==N){var A=a.offset.left+l-(a.offset.left+a.dimension.width);D=a.offset.left+k-A/2,$=a.offset.top-c-I-12,i(),n("bottom","top")}if("top-left"==N&&(D=a.offset.left+k,$=a.offset.top-c-I-12,i(),n("bottom-left","top-left")),"top-right"==N&&(D=a.offset.left+a.dimension.width+k-l,$=a.offset.top-c-I-12,i(),n("bottom-right","top-right")),"bottom"==N){var A=a.offset.left+l-(a.offset.left+a.dimension.width);D=a.offset.left-A/2+k,$=a.offset.top+a.dimension.height+I+12,i(),n("top","bottom")}if("bottom-left"==N&&(D=a.offset.left+k,$=a.offset.top+a.dimension.height+I+12,i(),n("top-left","bottom-left")),"bottom-right"==N&&(D=a.offset.left+a.dimension.width+k-l,$=a.offset.top+a.dimension.height+I+12,i(),n("top-right","bottom-right")),"left"==N){D=a.offset.left-k-l-12,O=a.offset.left+k+a.dimension.width+12;var P=a.offset.top+c-(a.offset.top+a.dimension.height);if($=a.offset.top-P/2-I,0>D&&O+l>s){var V=2*parseFloat(o.$tooltip.css("border-width")),R=l+D-V;o.$tooltip.css("width",R+"px"),c=o.$tooltip.outerHeight(!1),D=a.offset.left-k-R-12-V,P=a.offset.top+c-(a.offset.top+a.dimension.height),$=a.offset.top-P/2-I}else 0>D&&(D=a.offset.left+k+a.dimension.width+12,r="left")}if("right"==N){D=a.offset.left+k+a.dimension.width+12,O=a.offset.left-k-l-12;var P=a.offset.top+c-(a.offset.top+a.dimension.height);if($=a.offset.top-P/2-I,D+l>s&&0>O){var V=2*parseFloat(o.$tooltip.css("border-width")),R=s-D-V;o.$tooltip.css("width",R+"px"),c=o.$tooltip.outerHeight(!1),P=a.offset.top+c-(a.offset.top+a.dimension.height),$=a.offset.top-P/2-I}else D+l>s&&(D=a.offset.left-k-l-12,r="right")}if(o.options.arrow){var j="tooltipster-arrow-"+N;if(o.options.arrowColor.length<1)var q=o.$tooltip.css("background-color");else var q=o.options.arrowColor;if(r?"left"==r?(j="tooltipster-arrow-right",r=""):"right"==r?(j="tooltipster-arrow-left",r=""):r="left:"+Math.round(r)+"px;":r="","top"==N||"top-left"==N||"top-right"==N)var L=parseFloat(o.$tooltip.css("border-bottom-width")),G=o.$tooltip.css("border-bottom-color");else if("bottom"==N||"bottom-left"==N||"bottom-right"==N)var L=parseFloat(o.$tooltip.css("border-top-width")),G=o.$tooltip.css("border-top-color");else if("left"==N)var L=parseFloat(o.$tooltip.css("border-right-width")),G=o.$tooltip.css("border-right-color");else if("right"==N)var L=parseFloat(o.$tooltip.css("border-left-width")),G=o.$tooltip.css("border-left-color");else var L=parseFloat(o.$tooltip.css("border-bottom-width")),G=o.$tooltip.css("border-bottom-color");
L>1&&L++;var U="";if(0!==L){var H="",F="border-color: "+G+";";-1!==j.indexOf("bottom")?H="margin-top: -"+Math.round(L)+"px;":-1!==j.indexOf("top")?H="margin-bottom: -"+Math.round(L)+"px;":-1!==j.indexOf("left")?H="margin-right: -"+Math.round(L)+"px;":-1!==j.indexOf("right")&&(H="margin-left: -"+Math.round(L)+"px;"),U='<span class="tooltipster-arrow-border" style="'+H+" "+F+';"></span>'}o.$tooltip.find(".tooltipster-arrow").remove();var B='<div class="'+j+' tooltipster-arrow" style="'+r+'">'+U+'<span style="border-color:'+q+';"></span></div>';o.$tooltip.append(B)}o.$tooltip.css({top:Math.round($)+"px",left:Math.round(D)+"px"})}return o},enable:function(){return this.enabled=!0,this},disable:function(){return this.hide(),this.enabled=!1,this},destroy:function(){var t=this;t.hide(),t.$el[0]!==t.$elProxy[0]&&t.$elProxy.remove(),t.$el.removeData(t.namespace).off("."+t.namespace);var i=t.$el.data("tooltipster-ns");if(1===i.length){var n=null;"previous"===t.options.restoration?n=t.$el.data("tooltipster-initialTitle"):"current"===t.options.restoration&&(n="string"==typeof t.Content?t.Content:e("<div></div>").append(t.Content).html()),n&&t.$el.attr("title",n),t.$el.removeClass("tooltipstered").removeData("tooltipster-ns").removeData("tooltipster-initialTitle")}else i=e.grep(i,function(e,i){return e!==t.namespace}),t.$el.data("tooltipster-ns",i);return t},elementIcon:function(){return this.$el[0]!==this.$elProxy[0]?this.$elProxy[0]:void 0},elementTooltip:function(){return this.$tooltip?this.$tooltip[0]:void 0},option:function(e,t){return"undefined"==typeof t?this.options[e]:(this.options[e]=t,this)},status:function(){return this.Status}},e.fn[a]=function(){var t=arguments;if(0===this.length){if("string"==typeof t[0]){var i=!0;switch(t[0]){case"setDefaults":e.extend(l,t[1]);break;default:i=!1}return i?!0:this}return this}if("string"==typeof t[0]){var o="#*$~&";return this.each(function(){var i=e(this).data("tooltipster-ns"),n=i?e(this).data(i[0]):null;if(!n)throw new Error("You called Tooltipster's \""+t[0]+'" method on an uninitialized element');if("function"!=typeof n[t[0]])throw new Error('Unknown method .tooltipster("'+t[0]+'")');var r=n[t[0]](t[1],t[2]);return r!==n?(o=r,!1):void 0}),"#*$~&"!==o?o:this}var r=[],s=t[0]&&"undefined"!=typeof t[0].multiple,a=s&&t[0].multiple||!s&&l.multiple,c=t[0]&&"undefined"!=typeof t[0].debug,d=c&&t[0].debug||!c&&l.debug;return this.each(function(){var i=!1,o=e(this).data("tooltipster-ns"),s=null;o?a?i=!0:d&&console.log('Tooltipster: one or more tooltips are already attached to this element: ignoring. Use the "multiple" option to attach more tooltips.'):i=!0,i&&(s=new n(this,t[0]),o||(o=[]),o.push(s.namespace),e(this).data("tooltipster-ns",o),e(this).data(s.namespace,s)),r.push(s)}),a?r:this};var c=!!("ontouchstart"in t),d=!1;e("body").one("mousemove",function(){d=!0})}(jQuery,window,document),define("tooltipster",function(){}),console.log("BOONMAN"),!function(e){"function"==typeof define&&define.amd?define("select2",["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;var t;return function(){if(!t||!t.requirejs){t?i=t:t={};var e,i,n;!function(t){function o(e,t){return b.call(e,t)}function r(e,t){var i,n,o,r,s,a,l,c,d,u,p,h=t&&t.split("/"),f=g.map,m=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),s=e.length-1,g.nodeIdCompat&&C.test(e[s])&&(e[s]=e[s].replace(C,"")),e=h.slice(0,h.length-1).concat(e),d=0;d<e.length;d+=1)if(p=e[d],"."===p)e.splice(d,1),d-=1;else if(".."===p){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||m)&&f){for(i=e.split("/"),d=i.length;d>0;d-=1){if(n=i.slice(0,d).join("/"),h)for(u=h.length;u>0;u-=1)if(o=f[h.slice(0,u).join("/")],o&&(o=o[n])){r=o,a=d;break}if(r)break;!l&&m&&m[n]&&(l=m[n],c=d)}!r&&l&&(r=l,a=c),r&&(i.splice(0,a,r),e=i.join("/"))}return e}function s(e,i){return function(){var n=S.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),h.apply(t,n.concat([e,i]))}}function a(e){return function(t){return r(t,e)}}function l(e){return function(t){_[e]=t}}function c(e){if(o(v,e)){var i=v[e];delete v[e],y[e]=!0,p.apply(t,i)}if(!o(_,e)&&!o(y,e))throw new Error("No "+e);return _[e]}function d(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function u(e){return function(){return g&&g.config&&g.config[e]||{}}}var p,h,f,m,_={},v={},g={},y={},b=Object.prototype.hasOwnProperty,S=[].slice,C=/\.js$/;f=function(e,t){var i,n=d(e),o=n[0];return e=n[1],o&&(o=r(o,t),i=c(o)),o?e=i&&i.normalize?i.normalize(e,a(t)):r(e,t):(e=r(e,t),n=d(e),o=n[0],e=n[1],o&&(i=c(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:i}},m={require:function(e){return s(e)},exports:function(e){var t=_[e];return"undefined"!=typeof t?t:_[e]={}},module:function(e){return{id:e,uri:"",exports:_[e],config:u(e)}}},p=function(e,i,n,r){var a,d,u,p,h,g,b=[],S=typeof n;if(r=r||e,"undefined"===S||"function"===S){for(i=!i.length&&n.length?["require","exports","module"]:i,h=0;h<i.length;h+=1)if(p=f(i[h],r),d=p.f,"require"===d)b[h]=m.require(e);else if("exports"===d)b[h]=m.exports(e),g=!0;else if("module"===d)a=b[h]=m.module(e);else if(o(_,d)||o(v,d)||o(y,d))b[h]=c(d);else{if(!p.p)throw new Error(e+" missing "+d);p.p.load(p.n,s(r,!0),l(d),{}),b[h]=_[d]}u=n?n.apply(_[e],b):void 0,e&&(a&&a.exports!==t&&a.exports!==_[e]?_[e]=a.exports:u===t&&g||(_[e]=u))}else e&&(_[e]=n)},e=i=h=function(e,i,n,o,r){if("string"==typeof e)return m[e]?m[e](i):c(f(e,i).f);if(!e.splice){if(g=e,g.deps&&h(g.deps,g.callback),!i)return;i.splice?(e=i,i=n,n=null):e=t}return i=i||function(){},"function"==typeof n&&(n=o,o=r),o?p(t,e,i,n):setTimeout(function(){p(t,e,i,n)},4),h},h.config=function(e){return h(e)},e._defined=_,n=function(e,t,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(i=t,t=[]),o(_,e)||o(v,e)||(v[e]=[e,t,i])},n.amd={jQuery:!0}}(),t.requirejs=e,t.require=i,t.define=n}}(),t.define("almond",function(){}),t.define("jquery",[],function(){var t=e||$;return null==t&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t}),t.define("select2/utils",["jquery"],function(e){function t(e){var t=e.prototype,i=[];for(var n in t){var o=t[n];"function"==typeof o&&"constructor"!==n&&i.push(n)}return i}var i={};i.Extend=function(e,t){function i(){this.constructor=e}var n={}.hasOwnProperty;for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},i.Decorate=function(e,i){function n(){var t=Array.prototype.unshift,n=i.prototype.constructor.length,o=e.prototype.constructor;n>0&&(t.call(arguments,e.prototype.constructor),o=i.prototype.constructor),o.apply(this,arguments)}function o(){this.constructor=n}var r=t(i),s=t(e);i.displayName=e.displayName,n.prototype=new o;for(var a=0;a<s.length;a++){var l=s[a];n.prototype[l]=e.prototype[l]}for(var c=(function(e){var t=function(){};e in n.prototype&&(t=n.prototype[e]);var o=i.prototype[e];return function(){var e=Array.prototype.unshift;return e.call(arguments,t),o.apply(this,arguments)}}),d=0;d<r.length;d++){var u=r[d];n.prototype[u]=c(u)}return n};var n=function(){this.listeners={}};return n.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},n.prototype.trigger=function(e){var t=Array.prototype.slice;this.listeners=this.listeners||{},e in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},n.prototype.invoke=function(e,t){for(var i=0,n=e.length;n>i;i++)e[i].apply(this,t)},i.Observable=n,i.generateChars=function(e){for(var t="",i=0;e>i;i++){var n=Math.floor(36*Math.random());t+=n.toString(36)}return t},i.bind=function(e,t){return function(){e.apply(t,arguments)}},i._convertData=function(e){for(var t in e){var i=t.split("-"),n=e;if(1!==i.length){for(var o=0;o<i.length;o++){var r=i[o];r=r.substring(0,1).toLowerCase()+r.substring(1),r in n||(n[r]={}),o==i.length-1&&(n[r]=e[t]),n=n[r]}delete e[t]}}return e},i.hasScroll=function(t,i){var n=e(i),o=i.style.overflowX,r=i.style.overflowY;return o!==r||"hidden"!==r&&"visible"!==r?"scroll"===o||"scroll"===r?!0:n.innerHeight()<i.scrollHeight||n.innerWidth()<i.scrollWidth:!1},i.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},i.appendMany=function(t,i){if("1.7"===e.fn.jquery.substr(0,3)){var n=e();e.map(i,function(e){n=n.add(e)}),i=n}t.append(i)},i}),t.define("select2/results",["jquery","./utils"],function(e,t){function i(e,t,n){this.$element=e,this.data=n,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=e('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(t){var i=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=e('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),o=this.options.get("translations").get(t.message);n.append(i(o(t.args))),n[0].className+=" select2-results__message",this.$results.append(n)},i.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},i.prototype.append=function(e){this.hideLoading();var t=[];if(null==e.results||0===e.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));e.results=this.sort(e.results);for(var i=0;i<e.results.length;i++){var n=e.results[i],o=this.option(n);t.push(o)}this.$results.append(t)},i.prototype.position=function(e,t){var i=t.find(".select2-results");i.append(e)},i.prototype.sort=function(e){var t=this.options.get("sorter");return t(e)},i.prototype.setClasses=function(){var t=this;this.data.current(function(i){var n=e.map(i,function(e){return e.id.toString()}),o=t.$results.find(".select2-results__option[aria-selected]");o.each(function(){var t=e(this),i=e.data(this,"data"),o=""+i.id;null!=i.element&&i.element.selected||null==i.element&&e.inArray(o,n)>-1?t.attr("aria-selected","true"):t.attr("aria-selected","false")});var r=o.filter("[aria-selected=true]");r.length>0?r.first().trigger("mouseenter"):o.first().trigger("mouseenter")})},i.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching"),i={disabled:!0,loading:!0,text:t(e)},n=this.option(i);n.className+=" loading-results",this.$results.prepend(n)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(t){var i=document.createElement("li");i.className="select2-results__option";var n={role:"treeitem","aria-selected":"false"};t.disabled&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==t.id&&delete n["aria-selected"],null!=t._resultId&&(i.id=t._resultId),t.title&&(i.title=t.title),t.children&&(n.role="group",n["aria-label"]=t.text,delete n["aria-selected"]);for(var o in n){var r=n[o];i.setAttribute(o,r)}if(t.children){var s=e(i),a=document.createElement("strong");a.className="select2-results__group",e(a),this.template(t,a);for(var l=[],c=0;c<t.children.length;c++){var d=t.children[c],u=this.option(d);l.push(u)}var p=e("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});p.append(l),s.append(a),s.append(p)}else this.template(t,i);return e.data(i,"data",t),i},i.prototype.bind=function(t,i){var n=this,o=t.id+"-results";this.$results.attr("id",o),t.on("results:all",function(e){n.clear(),n.append(e.data),t.isOpen()&&n.setClasses()}),t.on("results:append",function(e){n.append(e.data),t.isOpen()&&n.setClasses()}),t.on("query",function(e){n.hideMessages(),n.showLoading(e)}),t.on("select",function(){t.isOpen()&&n.setClasses()}),t.on("unselect",function(){t.isOpen()&&n.setClasses()}),t.on("open",function(){n.$results.attr("aria-expanded","true"),n.$results.attr("aria-hidden","false"),n.setClasses(),n.ensureHighlightVisible()}),t.on("close",function(){n.$results.attr("aria-expanded","false"),n.$results.attr("aria-hidden","true"),n.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=n.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=n.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?n.trigger("close",{}):n.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=n.getHighlightedResults(),t=n.$results.find("[aria-selected]"),i=t.index(e);if(0!==i){var o=i-1;0===e.length&&(o=0);var r=t.eq(o);r.trigger("mouseenter");var s=n.$results.offset().top,a=r.offset().top,l=n.$results.scrollTop()+(a-s);0===o?n.$results.scrollTop(0):0>a-s&&n.$results.scrollTop(l)}}),t.on("results:next",function(){var e=n.getHighlightedResults(),t=n.$results.find("[aria-selected]"),i=t.index(e),o=i+1;if(!(o>=t.length)){var r=t.eq(o);r.trigger("mouseenter");var s=n.$results.offset().top+n.$results.outerHeight(!1),a=r.offset().top+r.outerHeight(!1),l=n.$results.scrollTop()+a-s;0===o?n.$results.scrollTop(0):a>s&&n.$results.scrollTop(l)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){n.displayMessage(e)}),e.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=n.$results.scrollTop(),i=n.$results.get(0).scrollHeight-n.$results.scrollTop()+e.deltaY,o=e.deltaY>0&&t-e.deltaY<=0,r=e.deltaY<0&&i<=n.$results.height();o?(n.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):r&&(n.$results.scrollTop(n.$results.get(0).scrollHeight-n.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(t){var i=e(this),o=i.data("data");return"true"===i.attr("aria-selected")?void(n.options.get("multiple")?n.trigger("unselect",{originalEvent:t,data:o}):n.trigger("close",{})):void n.trigger("select",{originalEvent:t,data:o})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(t){var i=e(this).data("data");n.getHighlightedResults().removeClass("select2-results__option--highlighted"),n.trigger("results:focus",{data:i,element:e(this)})})},i.prototype.getHighlightedResults=function(){var e=this.$results.find(".select2-results__option--highlighted");return e},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]"),i=t.index(e),n=this.$results.offset().top,o=e.offset().top,r=this.$results.scrollTop()+(o-n),s=o-n;r-=2*e.outerHeight(!1),2>=i?this.$results.scrollTop(0):(s>this.$results.outerHeight()||0>s)&&this.$results.scrollTop(r)}},i.prototype.template=function(t,i){var n=this.options.get("templateResult"),o=this.options.get("escapeMarkup"),r=n(t,i);null==r?i.style.display="none":"string"==typeof r?i.innerHTML=o(r):e(i).append(r)},i}),t.define("select2/keys",[],function(){var e={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return e}),t.define("select2/selection/base",["jquery","../utils","../keys"],function(e,t,i){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),t.attr("title",this.$element.attr("title")),t.attr("tabindex",this._tabindex),this.$selection=t,t},n.prototype.bind=function(e,t){var n=this,o=(e.id+"-container",e.id+"-results");this.container=e,this.$selection.on("focus",function(e){n.trigger("focus",e)}),this.$selection.on("blur",function(e){n._handleBlur(e)}),this.$selection.on("keydown",function(e){n.trigger("keypress",e),e.which===i.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){n.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){n.update(e.data)}),e.on("open",function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",o),n._attachCloseHandler(e)}),e.on("close",function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.focus(),n._detachCloseHandler(e)}),e.on("enable",function(){n.$selection.attr("tabindex",n._tabindex)}),e.on("disable",function(){n.$selection.attr("tabindex","-1")})},n.prototype._handleBlur=function(t){var i=this;window.setTimeout(function(){document.activeElement==i.$selection[0]||e.contains(i.$selection[0],document.activeElement)||i.trigger("blur",t)},1)},n.prototype._attachCloseHandler=function(t){e(document.body).on("mousedown.select2."+t.id,function(t){var i=e(t.target),n=i.closest(".select2"),o=e(".select2.select2-container--open");o.each(function(){var t=e(this);if(this!=n[0]){var i=t.data("element");i.select2("close")}})})},n.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},n.prototype.position=function(e,t){var i=t.find(".selection");i.append(e)},n.prototype.destroy=function(){this._detachCloseHandler(this.container)},n.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},n}),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,i,n){function o(){o.__super__.constructor.apply(this,arguments)}return i.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},o.prototype.bind=function(e,t){var i=this;o.__super__.bind.apply(this,arguments);var n=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",n),this.$selection.attr("aria-labelledby",n),this.$selection.on("mousedown",function(e){1===e.which&&i.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),e.on("selection:update",function(e){i.update(e.data)})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var i=this.options.get("templateSelection"),n=this.options.get("escapeMarkup");return n(i(e,t))},o.prototype.selectionContainer=function(){return e("<span></span>")},o.prototype.update=function(e){if(0===e.length)return void this.clear();var t=e[0],i=this.$selection.find(".select2-selection__rendered"),n=this.display(t,i);i.empty().append(n),i.prop("title",t.title||t.text)},o}),t.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,t,i){function n(e,t){n.__super__.constructor.apply(this,arguments)}return i.Extend(n,t),n.prototype.render=function(){var e=n.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},n.prototype.bind=function(t,i){var o=this;n.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){o.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(t){if(!o.options.get("disabled")){var i=e(this),n=i.parent(),r=n.data("data");o.trigger("unselect",{originalEvent:t,data:r})}})},n.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},n.prototype.display=function(e,t){var i=this.options.get("templateSelection"),n=this.options.get("escapeMarkup");return n(i(e,t))},n.prototype.selectionContainer=function(){var t=e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return t},n.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],n=0;n<e.length;n++){var o=e[n],r=this.selectionContainer(),s=this.display(o,r);r.append(s),r.prop("title",o.title||o.text),r.data("data",o),t.push(r)}var a=this.$selection.find(".select2-selection__rendered");i.appendMany(a,t)}},n}),t.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,i){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),e.call(this,t,i)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var i=this.selectionContainer();return i.html(this.display(t)),i.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),i},t.prototype.update=function(e,t){var i=1==t.length&&t[0].id!=this.placeholder.id,n=t.length>1;if(n||i)return e.call(this,t);this.clear();var o=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(o)},t}),t.define("select2/selection/allowClear",["jquery","../keys"],function(e,t){function i(){}return i.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){n._handleClear(e)}),t.on("keypress",function(e){n._handleKeyboardClear(e,t)})},i.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var i=this.$selection.find(".select2-selection__clear");if(0!==i.length){t.stopPropagation();for(var n=i.data("data"),o=0;o<n.length;o++){var r={data:n[o]};if(this.trigger("unselect",r),r.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},i.prototype._handleKeyboardClear=function(e,i,n){n.isOpen()||(i.which==t.DELETE||i.which==t.BACKSPACE)&&this._handleClear(i)},i.prototype.update=function(t,i){if(t.call(this,i),!(this.$selection.find(".select2-selection__placeholder").length>0||0===i.length)){var n=e('<span class="select2-selection__clear">&times;</span>');n.data("data",i),this.$selection.find(".select2-selection__rendered").prepend(n)}},i}),t.define("select2/selection/search",["jquery","../utils","../keys"],function(e,t,i){function n(e,t,i){e.call(this,t,i)}return n.prototype.render=function(t){var i=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=i,this.$search=i.find("input");var n=t.call(this);return this._transferTabIndex(),n},n.prototype.bind=function(e,t,n){var o=this;e.call(this,t,n),t.on("open",function(){o.$search.trigger("focus")}),t.on("close",function(){o.$search.val(""),o.$search.removeAttr("aria-activedescendant"),o.$search.trigger("focus")}),t.on("enable",function(){o.$search.prop("disabled",!1),o._transferTabIndex()}),t.on("disable",function(){o.$search.prop("disabled",!0)}),t.on("focus",function(e){o.$search.trigger("focus")}),t.on("results:focus",function(e){o.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){o.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){o._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){e.stopPropagation(),o.trigger("keypress",e),o._keyUpPrevented=e.isDefaultPrevented();var t=e.which;if(t===i.BACKSPACE&&""===o.$search.val()){var n=o.$searchContainer.prev(".select2-selection__choice");if(n.length>0){var r=n.data("data");o.searchRemoveChoice(r),e.preventDefault()}}});var r=document.documentMode,s=r&&11>=r;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){return s?void o.$selection.off("input.search input.searchcheck"):void o.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(s&&"input"===e.type)return void o.$selection.off("input.search input.searchcheck");var t=e.which;t!=i.SHIFT&&t!=i.CTRL&&t!=i.ALT&&t!=i.TAB&&o.handleSearch(e)})},n.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},n.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},n.prototype.update=function(e,t){var i=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),i&&this.$search.focus()},n.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},n.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},n.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";if(""!==this.$search.attr("placeholder"))e=this.$selection.find(".select2-selection__rendered").innerWidth();else{var t=this.$search.val().length+1;e=.75*t+"em"}this.$search.css("width",e)},n}),t.define("select2/selection/eventRelay",["jquery"],function(e){function t(){}return t.prototype.bind=function(t,i,n){var o=this,r=["open","opening","close","closing","select","selecting","unselect","unselecting"],s=["opening","closing","selecting","unselecting"];t.call(this,i,n),i.on("*",function(t,i){if(-1!==e.inArray(t,r)){i=i||{};var n=e.Event("select2:"+t,{params:i});o.$element.trigger(n),-1!==e.inArray(t,s)&&(i.prevented=n.isDefaultPrevented())}})},t}),t.define("select2/translation",["jquery","require"],function(e,t){function i(e){this.dict=e||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(e){return this.dict[e]},i.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},i._cache={},i.loadPath=function(e){if(!(e in i._cache)){var n=t(e);i._cache[e]=n}return new i(i._cache[e])},i}),t.define("select2/diacritics",[],function(){var e={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o",
"ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};return e}),t.define("select2/data/base",["../utils"],function(e){function t(e,i){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(e,t){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,i){var n=t.id+"-result-";return n+=e.generateChars(4),n+=null!=i.id?"-"+i.id.toString():"-"+e.generateChars(4)},t}),t.define("select2/data/select",["./base","../utils","jquery"],function(e,t,i){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,e),n.prototype.current=function(e){var t=[],n=this;this.$element.find(":selected").each(function(){var e=i(this),o=n.item(e);t.push(o)}),e(t)},n.prototype.select=function(e){var t=this;if(e.selected=!0,i(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(n){var o=[];e=[e],e.push.apply(e,n);for(var r=0;r<e.length;r++){var s=e[r].id;-1===i.inArray(s,o)&&o.push(s)}t.$element.val(o),t.$element.trigger("change")});else{var n=e.id;this.$element.val(n),this.$element.trigger("change")}},n.prototype.unselect=function(e){var t=this;return this.$element.prop("multiple")?(e.selected=!1,i(e.element).is("option")?(e.element.selected=!1,void this.$element.trigger("change")):void this.current(function(n){for(var o=[],r=0;r<n.length;r++){var s=n[r].id;s!==e.id&&-1===i.inArray(s,o)&&o.push(s)}t.$element.val(o),t.$element.trigger("change")})):void 0},n.prototype.bind=function(e,t){var i=this;this.container=e,e.on("select",function(e){i.select(e.data)}),e.on("unselect",function(e){i.unselect(e.data)})},n.prototype.destroy=function(){this.$element.find("*").each(function(){i.removeData(this,"data")})},n.prototype.query=function(e,t){var n=[],o=this,r=this.$element.children();r.each(function(){var t=i(this);if(t.is("option")||t.is("optgroup")){var r=o.item(t),s=o.matches(e,r);null!==s&&n.push(s)}}),t({results:n})},n.prototype.addOptions=function(e){t.appendMany(this.$element,e)},n.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup"),t.label=e.text):(t=document.createElement("option"),void 0!==t.textContent?t.textContent=e.text:t.innerText=e.text),e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var n=i(t),o=this._normalizeItem(e);return o.element=t,i.data(t,"data",o),n},n.prototype.item=function(e){var t={};if(t=i.data(e[0],"data"),null!=t)return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var n=e.children("option"),o=[],r=0;r<n.length;r++){var s=i(n[r]),a=this.item(s);o.push(a)}t.children=o}return t=this._normalizeItem(t),t.element=e[0],i.data(e[0],"data",t),t},n.prototype._normalizeItem=function(e){i.isPlainObject(e)||(e={id:e,text:e}),e=i.extend({},{text:""},e);var t={selected:!1,disabled:!1};return null!=e.id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),i.extend({},t,e)},n.prototype.matches=function(e,t){var i=this.options.get("matcher");return i(e,t)},n}),t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,i){function n(e,t){var i=t.get("data")||[];n.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(i))}return t.Extend(n,e),n.prototype.select=function(e){var t=this.$element.find("option").filter(function(t,i){return i.value==e.id.toString()});0===t.length&&(t=this.option(e),this.addOptions(t)),n.__super__.select.call(this,e)},n.prototype.convertToOptions=function(e){function n(e){return function(){return i(this).val()==e.id}}for(var o=this,r=this.$element.find("option"),s=r.map(function(){return o.item(i(this)).id}).get(),a=[],l=0;l<e.length;l++){var c=this._normalizeItem(e[l]);if(i.inArray(c.id,s)>=0){var d=r.filter(n(c)),u=this.item(d),p=i.extend(!0,{},u,c),h=this.option(p);d.replaceWith(h)}else{var f=this.option(c);if(c.children){var m=this.convertToOptions(c.children);t.appendMany(f,m)}a.push(f)}}return a},n}),t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,i){function n(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,e,t)}return t.Extend(n,e),n.prototype._applyDefaults=function(e){var t={data:function(e){return i.extend({},e,{q:e.term})},transport:function(e,t,n){var o=i.ajax(e);return o.then(t),o.fail(n),o}};return i.extend({},t,e,!0)},n.prototype.processResults=function(e){return e},n.prototype.query=function(e,t){function n(){var n=r.transport(r,function(n){var r=o.processResults(n,e);o.options.get("debug")&&window.console&&console.error&&(r&&r.results&&i.isArray(r.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),t(r)},function(){});o._request=n}var o=this;null!=this._request&&(i.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var r=i.extend({type:"GET"},this.ajaxOptions);"function"==typeof r.url&&(r.url=r.url.call(this.$element,e)),"function"==typeof r.data&&(r.data=r.data.call(this.$element,e)),this.ajaxOptions.delay&&""!==e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(n,this.ajaxOptions.delay)):n()},n}),t.define("select2/data/tags",["jquery"],function(e){function t(t,i,n){var o=n.get("tags"),r=n.get("createTag");if(void 0!==r&&(this.createTag=r),t.call(this,i,n),e.isArray(o))for(var s=0;s<o.length;s++){var a=o[s],l=this._normalizeItem(a),c=this.option(l);this.$element.append(c)}}return t.prototype.query=function(e,t,i){function n(e,r){for(var s=e.results,a=0;a<s.length;a++){var l=s[a],c=null!=l.children&&!n({results:l.children},!0),d=l.text===t.term;if(d||c)return r?!1:(e.data=s,void i(e))}if(r)return!0;var u=o.createTag(t);if(null!=u){var p=o.option(u);p.attr("data-select2-tag",!0),o.addOptions([p]),o.insertTag(s,u)}e.results=s,i(e)}var o=this;return this._removeOldTags(),null==t.term||null!=t.page?void e.call(this,t,i):void e.call(this,t,n)},t.prototype.createTag=function(t,i){var n=e.trim(i.term);return""===n?null:{id:n,text:n}},t.prototype.insertTag=function(e,t,i){t.unshift(i)},t.prototype._removeOldTags=function(t){var i=(this._lastTag,this.$element.find("option[data-select2-tag]"));i.each(function(){this.selected||e(this).remove()})},t}),t.define("select2/data/tokenizer",["jquery"],function(e){function t(e,t,i){var n=i.get("tokenizer");void 0!==n&&(this.tokenizer=n),e.call(this,t,i)}return t.prototype.bind=function(e,t,i){e.call(this,t,i),this.$search=t.dropdown.$search||t.selection.$search||i.find(".select2-search__field")},t.prototype.query=function(e,t,i){function n(e){o.trigger("select",{data:e})}var o=this;t.term=t.term||"";var r=this.tokenizer(t,this.options,n);r.term!==t.term&&(this.$search.length&&(this.$search.val(r.term),this.$search.focus()),t.term=r.term),e.call(this,t,i)},t.prototype.tokenizer=function(t,i,n,o){for(var r=n.get("tokenSeparators")||[],s=i.term,a=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};a<s.length;){var c=s[a];if(-1!==e.inArray(c,r)){var d=s.substr(0,a),u=e.extend({},i,{term:d}),p=l(u);null!=p?(o(p),s=s.substr(a+1)||"",a=0):a++}else a++}return{term:s}},t}),t.define("select2/data/minimumInputLength",[],function(){function e(e,t,i){this.minimumInputLength=i.get("minimumInputLength"),e.call(this,t,i)}return e.prototype.query=function(e,t,i){return t.term=t.term||"",t.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):void e.call(this,t,i)},e}),t.define("select2/data/maximumInputLength",[],function(){function e(e,t,i){this.maximumInputLength=i.get("maximumInputLength"),e.call(this,t,i)}return e.prototype.query=function(e,t,i){return t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):void e.call(this,t,i)},e}),t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,i){this.maximumSelectionLength=i.get("maximumSelectionLength"),e.call(this,t,i)}return e.prototype.query=function(e,t,i){var n=this;this.current(function(o){var r=null!=o?o.length:0;return n.maximumSelectionLength>0&&r>=n.maximumSelectionLength?void n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}}):void e.call(n,t,i)})},e}),t.define("select2/dropdown",["jquery","./utils"],function(e,t){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},i.prototype.bind=function(){},i.prototype.position=function(e,t){},i.prototype.destroy=function(){this.$dropdown.remove()},i}),t.define("select2/dropdown/search",["jquery","../utils"],function(e,t){function i(){}return i.prototype.render=function(t){var i=t.call(this),n=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),i.prepend(n),i},i.prototype.bind=function(t,i,n){var o=this;t.call(this,i,n),this.$search.on("keydown",function(e){o.trigger("keypress",e),o._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(t){e(this).off("keyup")}),this.$search.on("keyup input",function(e){o.handleSearch(e)}),i.on("open",function(){o.$search.attr("tabindex",0),o.$search.focus(),window.setTimeout(function(){o.$search.focus()},0)}),i.on("close",function(){o.$search.attr("tabindex",-1),o.$search.val("")}),i.on("results:all",function(e){if(null==e.query.term||""===e.query.term){var t=o.showSearch(e);t?o.$searchContainer.removeClass("select2-search--hide"):o.$searchContainer.addClass("select2-search--hide")}})},i.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},i.prototype.showSearch=function(e,t){return!0},i}),t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,i,n){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),e.call(this,t,i,n)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var i=t.slice(0),n=t.length-1;n>=0;n--){var o=t[n];this.placeholder.id===o.id&&i.splice(n,1)}return i},e}),t.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function t(e,t,i,n){this.lastParams={},e.call(this,t,i,n),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},t.prototype.bind=function(t,i,n){var o=this;t.call(this,i,n),i.on("query",function(e){o.lastParams=e,o.loading=!0}),i.on("query:append",function(e){o.lastParams=e,o.loading=!0}),this.$results.on("scroll",function(){var t=e.contains(document.documentElement,o.$loadingMore[0]);if(!o.loading&&t){var i=o.$results.offset().top+o.$results.outerHeight(!1),n=o.$loadingMore.offset().top+o.$loadingMore.outerHeight(!1);i+50>=n&&o.loadMore()}})},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),i=this.options.get("translations").get("loadingMore");return t.html(i(this.lastParams)),t},t}),t.define("select2/dropdown/attachBody",["jquery","../utils"],function(e,t){function i(t,i,n){this.$dropdownParent=n.get("dropdownParent")||e(document.body),t.call(this,i,n)}return i.prototype.bind=function(e,t,i){var n=this,o=!1;e.call(this,t,i),t.on("open",function(){n._showDropdown(),n._attachPositioningHandler(t),o||(o=!0,t.on("results:all",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("results:append",function(){n._positionDropdown(),n._resizeDropdown()}))}),t.on("close",function(){n._hideDropdown(),n._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},i.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},i.prototype.position=function(e,t,i){t.attr("class",i.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=i},i.prototype.render=function(t){var i=e("<span></span>"),n=t.call(this);return i.append(n),this.$dropdownContainer=i,i},i.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},i.prototype._attachPositioningHandler=function(i,n){var o=this,r="scroll.select2."+n.id,s="resize.select2."+n.id,a="orientationchange.select2."+n.id,l=this.$container.parents().filter(t.hasScroll);l.each(function(){e(this).data("select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})}),l.on(r,function(t){var i=e(this).data("select2-scroll-position");e(this).scrollTop(i.y)}),e(window).on(r+" "+s+" "+a,function(e){o._positionDropdown(),o._resizeDropdown()})},i.prototype._detachPositioningHandler=function(i,n){var o="scroll.select2."+n.id,r="resize.select2."+n.id,s="orientationchange.select2."+n.id,a=this.$container.parents().filter(t.hasScroll);a.off(o),e(window).off(o+" "+r+" "+s)},i.prototype._positionDropdown=function(){var t=e(window),i=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),o=null,r=(this.$container.position(),this.$container.offset());r.bottom=r.top+this.$container.outerHeight(!1);var s={height:this.$container.outerHeight(!1)};s.top=r.top,s.bottom=r.top+s.height;var a={height:this.$dropdown.outerHeight(!1)},l={top:t.scrollTop(),bottom:t.scrollTop()+t.height()},c=l.top<r.top-a.height,d=l.bottom>r.bottom+a.height,u={left:r.left,top:s.bottom};if("static"!==this.$dropdownParent[0].style.position){var p=this.$dropdownParent.offset();u.top-=p.top,u.left-=p.left}i||n||(o="below"),d||!c||i?!c&&d&&i&&(o="below"):o="above",("above"==o||i&&"below"!==o)&&(u.top=s.top-a.height),null!=o&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+o),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+o)),this.$dropdownContainer.css(u)},i.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.width="auto"),this.$dropdown.css(e)},i.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},i}),t.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(t){for(var i=0,n=0;n<t.length;n++){var o=t[n];o.children?i+=e(o.children):i++}return i}function t(e,t,i,n){this.minimumResultsForSearch=i.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,i,n)}return t.prototype.showSearch=function(t,i){return e(i.data.results)<this.minimumResultsForSearch?!1:t.call(this,i)},t}),t.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i),t.on("close",function(){n._handleSelectOnClose()})},e.prototype._handleSelectOnClose=function(){var e=this.getHighlightedResults();if(!(e.length<1)){var t=e.data("data");null!=t.element&&t.element.selected||null==t.element&&t.selected||this.trigger("select",{data:t})}},e}),t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i),t.on("select",function(e){n._selectTriggered(e)}),t.on("unselect",function(e){n._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var i=t.originalEvent;i&&i.ctrlKey||this.trigger("close",{})},e}),t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,i="Please delete "+t+" character";return 1!=t&&(i+="s"),i},inputTooShort:function(e){var t=e.minimum-e.input.length,i="Please enter "+t+" or more characters";return i},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}}),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(e,t,i,n,o,r,s,a,l,c,d,u,p,h,f,m,_,v,g,y,b,S,C,w,E,x,M,T,D){function O(){this.reset()}O.prototype.apply=function(u){if(u=e.extend({},this.defaults,u),null==u.dataAdapter){if(null!=u.ajax?u.dataAdapter=f:null!=u.data?u.dataAdapter=h:u.dataAdapter=p,u.minimumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,v)),u.maximumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,g)),u.maximumSelectionLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,y)),u.tags&&(u.dataAdapter=c.Decorate(u.dataAdapter,m)),(null!=u.tokenSeparators||null!=u.tokenizer)&&(u.dataAdapter=c.Decorate(u.dataAdapter,_)),null!=u.query){var D=t(u.amdBase+"compat/query");u.dataAdapter=c.Decorate(u.dataAdapter,D)}if(null!=u.initSelection){var O=t(u.amdBase+"compat/initSelection");u.dataAdapter=c.Decorate(u.dataAdapter,O)}}if(null==u.resultsAdapter&&(u.resultsAdapter=i,null!=u.ajax&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,w)),null!=u.placeholder&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,C)),u.selectOnClose&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,M))),null==u.dropdownAdapter){if(u.multiple)u.dropdownAdapter=b;else{var $=c.Decorate(b,S);u.dropdownAdapter=$}if(0!==u.minimumResultsForSearch&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,x)),u.closeOnSelect&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,T)),null!=u.dropdownCssClass||null!=u.dropdownCss||null!=u.adaptDropdownCssClass){var I=t(u.amdBase+"compat/dropdownCss");u.dropdownAdapter=c.Decorate(u.dropdownAdapter,I)}u.dropdownAdapter=c.Decorate(u.dropdownAdapter,E)}if(null==u.selectionAdapter){if(u.multiple?u.selectionAdapter=o:u.selectionAdapter=n,null!=u.placeholder&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,r)),u.allowClear&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,s)),u.multiple&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,a)),null!=u.containerCssClass||null!=u.containerCss||null!=u.adaptContainerCssClass){var k=t(u.amdBase+"compat/containerCss");u.selectionAdapter=c.Decorate(u.selectionAdapter,k)}u.selectionAdapter=c.Decorate(u.selectionAdapter,l)}if("string"==typeof u.language)if(u.language.indexOf("-")>0){var N=u.language.split("-"),A=N[0];u.language=[u.language,A]}else u.language=[u.language];if(e.isArray(u.language)){var P=new d;u.language.push("en");for(var V=u.language,R=0;R<V.length;R++){var j=V[R],q={};try{q=d.loadPath(j)}catch(L){try{j=this.defaults.amdLanguageBase+j,q=d.loadPath(j)}catch(G){u.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+j+'" could not be automatically loaded. A fallback will be used instead.');continue}}P.extend(q)}u.translations=P}else{var U=d.loadPath(this.defaults.amdLanguageBase+"en"),H=new d(u.language);H.extend(U),u.translations=H}return u},O.prototype.reset=function(){function t(e){function t(e){return u[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function i(n,o){if(""===e.trim(n.term))return o;if(o.children&&o.children.length>0){for(var r=e.extend(!0,{},o),s=o.children.length-1;s>=0;s--){var a=o.children[s],l=i(n,a);null==l&&r.children.splice(s,1)}return r.children.length>0?r:i(n,r)}var c=t(o.text).toUpperCase(),d=t(n.term).toUpperCase();return c.indexOf(d)>-1?o:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:c.escapeMarkup,language:D,matcher:i,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},O.prototype.set=function(t,i){var n=e.camelCase(t),o={};o[n]=i;var r=c._convertData(o);e.extend(this.defaults,r)};var $=new O;return $}),t.define("select2/options",["require","jquery","./defaults","./utils"],function(e,t,i,n){function o(t,o){if(this.options=t,null!=o&&this.fromElement(o),this.options=i.apply(this.options),o&&o.is("input")){var r=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=n.Decorate(this.options.dataAdapter,r)}}return o.prototype.fromElement=function(e){var i=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var o={};o=t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset?t.extend(!0,{},e[0].dataset,e.data()):e.data();var r=t.extend(!0,{},o);r=n._convertData(r);for(var s in r)t.inArray(s,i)>-1||(t.isPlainObject(this.options[s])?t.extend(this.options[s],r[s]):this.options[s]=r[s]);return this},o.prototype.get=function(e){return this.options[e]},o.prototype.set=function(e,t){this.options[e]=t},o}),t.define("select2/core",["jquery","./options","./utils","./keys"],function(e,t,i,n){var o=function(e,i){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),i=i||{},this.options=new t(i,e),o.__super__.constructor.call(this);var n=e.attr("tabindex")||0;e.data("old-tabindex",n),e.attr("tabindex","-1");var r=this.options.get("dataAdapter");this.dataAdapter=new r(e,this.options);var s=this.render();this._placeContainer(s);var a=this.options.get("selectionAdapter");this.selection=new a(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,s);var l=this.options.get("dropdownAdapter");this.dropdown=new l(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,s);var c=this.options.get("resultsAdapter");this.results=new c(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var d=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){d.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return i.Extend(o,i.Observable),o.prototype._generateId=function(e){var t="";return t=null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+i.generateChars(2):i.generateChars(4),t="select2-"+t},o.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},o.prototype._resolveWidth=function(e,t){var i=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var n=this._resolveWidth(e,"style");return null!=n?n:this._resolveWidth(e,"element")}if("element"==t){var o=e.outerWidth(!1);return 0>=o?"auto":o+"px"}if("style"==t){var r=e.attr("style");if("string"!=typeof r)return null;for(var s=r.split(";"),a=0,l=s.length;l>a;a+=1){var c=s[a].replace(/\s/g,""),d=c.match(i);if(null!==d&&d.length>=1)return d[1]}return null}return t},o.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},o.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this._sync=i.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=n?(this._observer=new n(function(i){e.each(i,t._sync)}),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",t._sync,!1)},o.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",function(t,i){e.trigger(t,i)})},o.prototype._registerSelectionEvents=function(){var t=this,i=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()}),this.selection.on("focus",function(e){t.focus(e)}),this.selection.on("*",function(n,o){-1===e.inArray(n,i)&&t.trigger(n,o)})},o.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",function(t,i){e.trigger(t,i)})},o.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",function(t,i){e.trigger(t,i)})},o.prototype._registerEvents=function(){var e=this;this.on("open",function(){e.$container.addClass("select2-container--open")}),this.on("close",function(){e.$container.removeClass("select2-container--open")}),this.on("enable",function(){e.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){e.$container.addClass("select2-container--disabled")}),this.on("blur",function(){e.$container.removeClass("select2-container--focus")}),this.on("query",function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,function(i){e.trigger("results:all",{data:i,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(i){e.trigger("results:append",{data:i,query:t})})}),this.on("keypress",function(t){var i=t.which;e.isOpen()?i===n.ESC||i===n.TAB||i===n.UP&&t.altKey?(e.close(),t.preventDefault()):i===n.ENTER?(e.trigger("results:select",{}),t.preventDefault()):i===n.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):i===n.UP?(e.trigger("results:previous",{}),t.preventDefault()):i===n.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(i===n.ENTER||i===n.SPACE||i===n.DOWN&&t.altKey)&&(e.open(),t.preventDefault())})},o.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},o.prototype.trigger=function(e,t){var i=o.__super__.trigger,n={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===t&&(t={}),e in n){var r=n[e],s={prevented:!1,name:e,args:t};if(i.call(this,r,s),s.prevented)return void(t.prevented=!0)}i.call(this,e,t)},o.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},o.prototype.open=function(){this.isOpen()||this.trigger("query",{})},o.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},o.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},o.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},o.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},o.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),(null==e||0===e.length)&&(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},o.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var e=[];return this.dataAdapter.current(function(t){
e=t}),e},o.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==t||0===t.length)return this.$element.val();var i=t[0];e.isArray(i)&&(i=e.map(i,function(e){return e.toString()})),this.$element.val(i).trigger("change")},o.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},o.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),t.data("element",this.$element),t},o}),t.define("select2/compat/utils",["jquery"],function(e){function t(t,i,n){var o,r,s=[];o=e.trim(t.attr("class")),o&&(o=""+o,e(o.split(/\s+/)).each(function(){0===this.indexOf("select2-")&&s.push(this)})),o=e.trim(i.attr("class")),o&&(o=""+o,e(o.split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&(r=n(this),null!=r&&s.push(r))})),t.attr("class",s.join(" "))}return{syncCssClasses:t}}),t.define("select2/compat/containerCss",["jquery","./utils"],function(e,t){function i(e){return null}function n(){}return n.prototype.render=function(n){var o=n.call(this),r=this.options.get("containerCssClass")||"";e.isFunction(r)&&(r=r(this.$element));var s=this.options.get("adaptContainerCssClass");if(s=s||i,-1!==r.indexOf(":all:")){r=r.replace(":all:","");var a=s;s=function(e){var t=a(e);return null!=t?t+" "+e:e}}var l=this.options.get("containerCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(o,this.$element,s),o.css(l),o.addClass(r),o},n}),t.define("select2/compat/dropdownCss",["jquery","./utils"],function(e,t){function i(e){return null}function n(){}return n.prototype.render=function(n){var o=n.call(this),r=this.options.get("dropdownCssClass")||"";e.isFunction(r)&&(r=r(this.$element));var s=this.options.get("adaptDropdownCssClass");if(s=s||i,-1!==r.indexOf(":all:")){r=r.replace(":all:","");var a=s;s=function(e){var t=a(e);return null!=t?t+" "+e:e}}var l=this.options.get("dropdownCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(o,this.$element,s),o.css(l),o.addClass(r),o},n}),t.define("select2/compat/initSelection",["jquery"],function(e){function t(e,t,i){i.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=i.get("initSelection"),this._isInitialized=!1,e.call(this,t,i)}return t.prototype.current=function(t,i){var n=this;return this._isInitialized?void t.call(this,i):void this.initSelection.call(null,this.$element,function(t){n._isInitialized=!0,e.isArray(t)||(t=[t]),i(t)})},t}),t.define("select2/compat/inputData",["jquery"],function(e){function t(e,t,i){this._currentData=[],this._valueSeparator=i.get("valueSeparator")||",","hidden"===t.prop("type")&&i.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),e.call(this,t,i)}return t.prototype.current=function(t,i){function n(t,i){var o=[];return t.selected||-1!==e.inArray(t.id,i)?(t.selected=!0,o.push(t)):t.selected=!1,t.children&&o.push.apply(o,n(t.children,i)),o}for(var o=[],r=0;r<this._currentData.length;r++){var s=this._currentData[r];o.push.apply(o,n(s,this.$element.val().split(this._valueSeparator)))}i(o)},t.prototype.select=function(t,i){if(this.options.get("multiple")){var n=this.$element.val();n+=this._valueSeparator+i.id,this.$element.val(n),this.$element.trigger("change")}else this.current(function(t){e.map(t,function(e){e.selected=!1})}),this.$element.val(i.id),this.$element.trigger("change")},t.prototype.unselect=function(e,t){var i=this;t.selected=!1,this.current(function(e){for(var n=[],o=0;o<e.length;o++){var r=e[o];t.id!=r.id&&n.push(r.id)}i.$element.val(n.join(i._valueSeparator)),i.$element.trigger("change")})},t.prototype.query=function(e,t,i){for(var n=[],o=0;o<this._currentData.length;o++){var r=this._currentData[o],s=this.matches(t,r);null!==s&&n.push(s)}i({results:n})},t.prototype.addOptions=function(t,i){var n=e.map(i,function(t){return e.data(t[0],"data")});this._currentData.push.apply(this._currentData,n)},t}),t.define("select2/compat/matcher",["jquery"],function(e){function t(t){function i(i,n){var o=e.extend(!0,{},n);if(null==i.term||""===e.trim(i.term))return o;if(n.children){for(var r=n.children.length-1;r>=0;r--){var s=n.children[r],a=t(i.term,s.text,s);a||o.children.splice(r,1)}if(o.children.length>0)return o}return t(i.term,n.text,n)?o:null}return i}return t}),t.define("select2/compat/query",[],function(){function e(e,t,i){i.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),e.call(this,t,i)}return e.prototype.query=function(e,t,i){t.callback=i;var n=this.options.get("query");n.call(null,t)},e}),t.define("select2/dropdown/attachContainer",[],function(){function e(e,t,i){e.call(this,t,i)}return e.prototype.position=function(e,t,i){var n=i.find(".dropdown-wrapper");n.append(t),t.addClass("select2-dropdown--below"),i.addClass("select2-container--below")},e}),t.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,i){e.call(this,t,i);var n=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$dropdown.on(n.join(" "),function(e){e.stopPropagation()})},e}),t.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,i){e.call(this,t,i);var n=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$selection.on(n.join(" "),function(e){e.stopPropagation()})},e}),function(i){"function"==typeof t.define&&t.define.amd?t.define("jquery-mousewheel",["jquery"],i):"object"==typeof exports?module.exports=i:i(e)}(function(e){function t(t){var s=t||window.event,a=l.call(arguments,1),c=0,u=0,p=0,h=0,f=0,m=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(p=-1*s.detail),"wheelDelta"in s&&(p=s.wheelDelta),"wheelDeltaY"in s&&(p=s.wheelDeltaY),"wheelDeltaX"in s&&(u=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(u=-1*p,p=0),c=0===p?u:p,"deltaY"in s&&(p=-1*s.deltaY,c=p),"deltaX"in s&&(u=s.deltaX,0===p&&(c=-1*u)),0!==p||0!==u){if(1===s.deltaMode){var _=e.data(this,"mousewheel-line-height");c*=_,p*=_,u*=_}else if(2===s.deltaMode){var v=e.data(this,"mousewheel-page-height");c*=v,p*=v,u*=v}if(h=Math.max(Math.abs(p),Math.abs(u)),(!r||r>h)&&(r=h,n(s,h)&&(r/=40)),n(s,h)&&(c/=40,u/=40,p/=40),c=Math[c>=1?"floor":"ceil"](c/r),u=Math[u>=1?"floor":"ceil"](u/r),p=Math[p>=1?"floor":"ceil"](p/r),d.settings.normalizeOffset&&this.getBoundingClientRect){var g=this.getBoundingClientRect();f=t.clientX-g.left,m=t.clientY-g.top}return t.deltaX=u,t.deltaY=p,t.deltaFactor=r,t.offsetX=f,t.offsetY=m,t.deltaMode=0,a.unshift(t,c,u,p),o&&clearTimeout(o),o=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function i(){r=null}function n(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var o,r,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var c=s.length;c;)e.event.fixHooks[s[--c]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(e,t,i,n){if(null==e.fn.select2){var o=["open","close","destroy"];e.fn.select2=function(t){if(t=t||{},"object"==typeof t)return this.each(function(){var n=e.extend(!0,{},t);new i(e(this),n)}),this;if("string"==typeof t){var n;return this.each(function(){var i=e(this).data("select2");null==i&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2.");var o=Array.prototype.slice.call(arguments,1);n=i[t].apply(i,o)}),e.inArray(t,o)>-1?this:n}throw new Error("Invalid arguments for Select2: "+t)}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=n),i}),{define:t.define,require:t.require}}(),i=t.require("jquery.select2");return e.fn.select2.amd=t,i}),function(e,t){"function"==typeof define&&define.amd?define("inflection",["underscore"],t):"function"==typeof require&&"object"==typeof exports?module.exports=t(require("underscore")):t(e._)}(this,function(e,t){var i=[],n=[],o=[],r={gsub:function(e,t,i){var n=new RegExp(t.source||t,"gi");return n.test(e)?e.replace(n,i):null},plural:function(e,t){i.unshift([e,t])},pluralize:function(n,r,s){var a;if(r!==t)r=parseFloat(r),a=1===r?this.singularize(n):this.pluralize(n),a=s?[r,a].join(" "):a;else{if(e(o).include(n))return n;a=n,e(i).detect(function(e){var t=this.gsub(n,e[0],e[1]);return t?a=t:!1},this)}return a},singular:function(e,t){n.unshift([e,t])},singularize:function(t){if(e(o).include(t))return t;var i=t;return e(n).detect(function(e){var n=this.gsub(t,e[0],e[1]);return n?i=n:!1},this),i},irregular:function(e,t){this.plural("\\b"+e+"\\b",t),this.singular("\\b"+t+"\\b",e)},uncountable:function(e){o.unshift(e)},ordinalize:function(e){if(isNaN(e))return e;e=e.toString();var t=e.slice(-1),i=e.slice(-2);if("11"===i||"12"===i||"13"===i)return e+"th";switch(t){case"1":return e+"st";case"2":return e+"nd";case"3":return e+"rd";default:return e+"th"}},titleize:function(e){return"string"!=typeof e?e:e.replace(/\S+/g,function(e){return e.charAt(0).toUpperCase()+e.slice(1)})},resetInflections:function(){return i=[],n=[],o=[],this.plural(/$/,"s"),this.plural(/s$/,"s"),this.plural(/(ax|test)is$/,"$1es"),this.plural(/(octop|vir)us$/,"$1i"),this.plural(/(octop|vir)i$/,"$1i"),this.plural(/(alias|status)$/,"$1es"),this.plural(/(bu)s$/,"$1ses"),this.plural(/(buffal|tomat)o$/,"$1oes"),this.plural(/([ti])um$/,"$1a"),this.plural(/([ti])a$/,"$1a"),this.plural(/sis$/,"ses"),this.plural(/(?:([^f])fe|([lr])?f)$/,"$1$2ves"),this.plural(/(hive)$/,"$1s"),this.plural(/([^aeiouy]|qu)y$/,"$1ies"),this.plural(/(x|ch|ss|sh)$/,"$1es"),this.plural(/(matr|vert|ind)(?:ix|ex)$/,"$1ices"),this.plural(/([m|l])ouse$/,"$1ice"),this.plural(/([m|l])ice$/,"$1ice"),this.plural(/^(ox)$/,"$1en"),this.plural(/^(oxen)$/,"$1"),this.plural(/(quiz)$/,"$1zes"),this.singular(/s$/,""),this.singular(/(n)ews$/,"$1ews"),this.singular(/([ti])a$/,"$1um"),this.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/,"$1$2sis"),this.singular(/(^analy)ses$/,"$1sis"),this.singular(/([^f])ves$/,"$1fe"),this.singular(/(hive)s$/,"$1"),this.singular(/(tive)s$/,"$1"),this.singular(/([lr])ves$/,"$1f"),this.singular(/([^aeiouy]|qu)ies$/,"$1y"),this.singular(/(s)eries$/,"$1eries"),this.singular(/(m)ovies$/,"$1ovie"),this.singular(/(ss)$/,"$1"),this.singular(/(x|ch|ss|sh)es$/,"$1"),this.singular(/([m|l])ice$/,"$1ouse"),this.singular(/(bus)es$/,"$1"),this.singular(/(o)es$/,"$1"),this.singular(/(shoe)s$/,"$1"),this.singular(/(cris|ax|test)es$/,"$1is"),this.singular(/(octop|vir)i$/,"$1us"),this.singular(/(alias|status)es$/,"$1"),this.singular(/^(ox)en/,"$1"),this.singular(/(vert|ind)ices$/,"$1ex"),this.singular(/(matr)ices$/,"$1ix"),this.singular(/(quiz)zes$/,"$1"),this.singular(/(database)s$/,"$1"),this.irregular("person","people"),this.irregular("man","men"),this.irregular("child","children"),this.irregular("sex","sexes"),this.irregular("move","moves"),this.irregular("cow","kine"),this.uncountable("equipment"),this.uncountable("information"),this.uncountable("rice"),this.uncountable("money"),this.uncountable("species"),this.uncountable("series"),this.uncountable("fish"),this.uncountable("sheep"),this.uncountable("jeans"),this}};return e.mixin(r.resetInflections()),r}),require(["require","Class","Sm"],function(e,t){e("Sm"),e("Class"),Sm.loaded.when_loaded("Core",function(){Sm.Entities.Abstraction.Garage=t.extend({init:function(e,t){this.type=e,this.subtype_identifier=t},_default:function(e){Sm.CONFIG.DEBUG&&console.log(e);var t=document.createElement("div");return t.className="empty",t},_get_details_from_MvCombo:function(e){e&&"object"==typeof e||(e={});var t=e.Model,i=t?t.attributes:e.attributes?e.attributes:e;i||(i={});var n=i[this.subtype_identifier];n||(n="standard");var o=Sm.Entities[this.type].Meta.get_type("index",n);return o||(o="standard"),{Model:t,attributes:Sm.Core.util.merge_objects(i,{_type:o}),subtype:n,template_type:o}},_rt:function(e,t,i,n){t=t||{};var o=t.is_modal,r=t.fallback||"full",s=t.outer_string_name||(o?"modal_outer":"outer"),a=t.outer_template_string||!1,l=(t.template_index||r||"").trim().toLowerCase(),c=t.inner_string_name;i=void 0!=i?!!i:!0;var d=this,u=this._get_details_from_MvCombo(e);if(!u){var p=d._default("could not validate");return i?p:new Promise(function(e){e(p)})}var h,f=this.type,m=u.attributes||e,v=(u.subtype,u.template_type),g=!0,y=!1,b=function(){if(!g)return!1;var e,t,i,d=o?"modal":"body";a&&n||(t=Sm.Entities[f].templates[v],e=Sm.Entities[f].templates._template,t||(t="standard"!=v&&Sm.loaded.is_loaded("Entities_"+f+"_templates_standard")&&Sm.Entities[f].templates.standard?Sm.Entities[f].templates.standard:e),c&&(t[c]||"").length?n=t[c]:c&&(e[c]||"").length&&(n=e[c])),a||(t[s]&&("string"==typeof t[s]&&(a=t[s]),!a&&t[s]&&t[s][l]?a=t[s][l]:Sm.CONFIG.DEBUG&&console.log("Error checking ",v," ",l," ",s)),!a&&e[s]&&(a||"string"!=typeof e[s]||(a=e[s]),!a&&e[s][l]&&(a=e[s][l]),!a&&l!=r&&e[s][r]&&(a=e[s][r]))),a||(a="<div>__CONTENT__</div>");var u=s+l+(c||d);if(a.length||(a="__CONTENT__"),!n){if(t.cache=t.cache||{},t.cache[u])return y&&clearTimeout(parseInt(y)),h=t.cache[u](m);if(t[d]&&t[d][l]||!e[d]||!e[d][l]||(t[d]=t[d]||{},t[d][l]=e[d][l]),!t[d]){if("standard"==v||!Sm.loaded.is_loaded("Entities_"+f+"_templates_standard")||!Sm.Entities[f].templates.standard[d])throw"No Index Template  '"+d+"'  to match in "+f+" Garage";t[d]=Sm.Entities[f].templates.standard[d]}if(i=t[d][l]||t[d].full,!e)throw"No Template to match "+f;if(!i)throw"No Index Template '"+d+"."+l+"' to match "+f;if(!e[s])throw"No Outer Template to match "+s+" - ";n=i}var p=o&&t.modal_button_control?t.modal_button_control:t.button_control;p||(p=o&&e.modal_button_control?e.modal_button_control:e.button_control);var b;b="string"==typeof p?p:p?p[l]:!1,!b&&l!=r&&e.button_control[r]&&(b=e.button_control[r]),a=a.replace("__CONTENT__",n).replace("__BUTTON_CONTROL__",b||"");var S=_.template(a);return t.cache[l+d]=S,y&&clearTimeout(parseInt(y)),h=S(m)};try{if(i)return b();var S="Entities_"+f+"_templates__template",C="_Entities_"+f+"_Garage."+l;return Sm.loaded.when_loaded(S,b,C,7e3)["catch"](function(){var e="Could not load '"+S+"' in time for '"+C+"'";throw Sm.CONFIG.DEBUG&&console.log(e),e})}catch(w){return this._default(w)}},generate:function(e,t,i,n){"object"==typeof e&&(n=e,e=n.type||n.outer_string_name,t=n.MvCombo||n.data||{},i=n.synchronous),n=n||{},e=(e||" ").toLowerCase();var o=e.indexOf("modal")>-1;e=e.replace(".modal","");var r=e.split(".");e=r[0],n.inner_string_name=r[0]||n.inner_string_name;arguments;return this[e]?this[e].apply(this,[t,i,n]):this._rt(t,{template_index:e,is_modal:o,fallback:n.fallback||"full",outer_string_name:n.outer_string_name,inner_string_name:n.inner_string_name,inner_template_string:n.inner_template_string,template_type:n.template_type,outer_template_string:n.outer_template_string},!!i)},relationships:function(e,t,i){if(i=i||{},!e)return t?!1:Promise.resolve(!1);var n=i.relationship_index_list||[];if(!n.length){var o=e.relationships||[];for(var r in o)o.hasOwnProperty(r)&&n.push(r)}var s=Sm.Entities[this.type].templates._template;if(s.relationship_index_container=s.relationship_index_container||"__CONTENT__",!s||!s.relationship_container||!s.relationship_outer)return t?"":Promise.resolve("");for(var a=i.context_id||0,l=s.relationship_index_container,c="",d={},u=i.listed_relationships_obj||{},p=0;p<n.length;p++){var h=n[p];if(h){var f="",m=[],_=[],v=h.charAt(0).toUpperCase()+h.slice(1),g=s.relationship_container.replace("__TITLE__",v),y=e.getRelationshipIndex(h);if(y){var b=u[h]||y.get_listed_items(a);_=b.items||[],m=b.relationships||[],d[h]=[];for(var S=i.display_type||"preview",C=0;C<_.length;C++){var w=_[C],E=m[C],x=w.getView({display_type:S});x.render({synchronous:!0,display_type:S}),d[h].push({MvCombo:w,Relationship:E,View:x})}c+=g.replace("__CONTENT__",f).replace("__TYPE__",h).replace("__R_ID__",e.r_id)}}}var M=l.replace("__BUTTON_CONTROL__","").replace("__CONTENT__",c);return this._continue_relationship_render(d,M,t,i.on_append,e)},_continue_relationship_render:function(e,t,i,n,o){var r=$(t),s=Sm.Entities[this.type].templates._template;n="function"==typeof n?n:!1;var a=[];for(var l in e)if(e.hasOwnProperty(l)){var c=r.children("."+l+"-container");if(c[0])for(var d=e[l],u=0;u<d.length;u++){var p=d[u].View,h=d[u].Relationship;if(p.MvCombo){a.indexOf(p.MvCombo.r_id)>-1&&(p=p.clone());var f=s.relationship_outer.replace("__CONTENT__","").replace("__R_ID__",h.Identity.r_id).replace("__MV_R_ID__",o?o.r_id:"null"),m=$(f),_=m.find(".content");_[0]?(_[0].appendChild(p.get_rendered("Element")),c[0].appendChild(m[0]),a.push(p.MvCombo.r_id),p.mark_added()):Sm.CONFIG.DEBUG&&console.log(m,_,p),n&&n(p.MvCombo,p,l)}}else Sm.CONFIG.DEBUG&&console.log(c)}var v=r[0];return i?v:Promise.resolve(v)}}),Sm.loaded.add("Entities_Abstraction_Garage")},"Entities_Abstraction_Garage")}),define("Sm/Entities/Abstraction/Garage",function(){});var BASE_URL="/resource/js/",CHI_URL=BASE_URL+"chi/";require.config({paths:{jquery:BASE_URL+"vendor/jquery.min",Promise:BASE_URL+"std/Promise",backbone:BASE_URL+"vendor/backbone",Cocktail:BASE_URL+"vendor/Cocktail",underscore:BASE_URL+"vendor/underscore",crossvent:BASE_URL+"vendor/crossvent",inflection:BASE_URL+"vendor/underscore.inflection",tooltipster:BASE_URL+"vendor/jquery.tooltipster.min",select2:BASE_URL+"vendor/jquery.select2.full",SmHighlight:BASE_URL+"std/sm_highlight",Class:CHI_URL+"abstraction/Class",Emitter:CHI_URL+"abstraction/Emitter",Sm:CHI_URL+"Sm","Sm-Core-View":CHI_URL+"Sm/Core/View","Sm-Core-Core":CHI_URL+"Sm/Core/Core","Sm-Core-Identifier":CHI_URL+"Sm/Core/Identifier","Sm-Core-Meta":CHI_URL+"Sm/Core/Meta","Sm-Core-MvCombo":CHI_URL+"Sm/Core/MvCombo","Sm-Core-MvWrapper":CHI_URL+"Sm/Core/MvWrapper","Sm-Core-Relationship":CHI_URL+"Sm/Core/Relationship","Sm-Core-RelationshipIndex":CHI_URL+"Sm/Core/RelationshipIndex","Sm-Core-SmModel":CHI_URL+"Sm/Core/SmModel","Sm-Core-SmView":CHI_URL+"Sm/Core/SmView","Sm-Core-util":CHI_URL+"Sm/Core/util","Sm-Entities-Abstraction-ModalEdit":CHI_URL+"Sm/Entities/Abstraction/ModalEdit","Sm-Entities-Abstraction-mixins-SidebarModule":CHI_URL+"Sm/Entities/Abstraction/SidebarModule","Sm-Entities-Page-Wrapper":CHI_URL+"Sm/Entities/Page/Wrapper","Sm-Entities-Page-MvCombo":CHI_URL+"Sm/Entities/Page/MvCombo","Sm-Entities-Page-View":CHI_URL+"Sm/Entities/Page/View","Sm-Entities-Page-Model":CHI_URL+"Sm/Entities/Page/Model","Sm-Entities-Page-Meta":CHI_URL+"Sm/Entities/Page/Meta","Sm-Entities-Page-Garage":CHI_URL+"Sm/Entities/Page/Garage","Sm-Entities-Page-main":CHI_URL+"Sm/Entities/Page/main","Sm-Entities-Section-main":CHI_URL+"Sm/Entities/Section/main","Sm-Entities-Collection-main":CHI_URL+"Sm/Entities/Collection/main","Sm-Entities-Dimension-main":CHI_URL+"Sm/Entities/Dimension/main","Sm-Entities-Dictionary-main":CHI_URL+"Sm/Entities/Dictionary/main","Sm-Entities-Concept-main":CHI_URL+"Sm/Entities/Concept/main","Sm-Entities-Page-templates-_template":CHI_URL+"Sm/Entities/Page/templates/_template","Sm-Entities-Page-templates-standard":CHI_URL+"Sm/Entities/Page/templates/standard","Sm-Entities-Collection-MvCombo":CHI_URL+"Sm/Entities/Collection/MvCombo","Sm-Entities-Collection-Wrapper":CHI_URL+"Sm/Entities/Collection/Wrapper","Sm-Entities-Collection-View":CHI_URL+"Sm/Entities/Collection/View","Sm-Entities-Collection-Model":CHI_URL+"Sm/Entities/Collection/Model","Sm-Entities-Collection-Meta":CHI_URL+"Sm/Entities/Collection/Meta","Sm-Entities-Collection-Garage":CHI_URL+"Sm/Entities/Collection/Garage","Sm-Entities-Collection-templates-_template":CHI_URL+"Sm/Entities/Collection/templates/_template","Sm-Entities-Collection-templates-standard":CHI_URL+"Sm/Entities/Collection/templates/standard","Sm-Entities-Dictionary-MvCombo":CHI_URL+"Sm/Entities/Dictionary/MvCombo","Sm-Entities-Dictionary-Wrapper":CHI_URL+"Sm/Entities/Dictionary/Wrapper","Sm-Entities-Dictionary-View":CHI_URL+"Sm/Entities/Dictionary/View","Sm-Entities-Dictionary-Model":CHI_URL+"Sm/Entities/Dictionary/Model","Sm-Entities-Dictionary-Meta":CHI_URL+"Sm/Entities/Dictionary/Meta","Sm-Entities-Dictionary-Garage":CHI_URL+"Sm/Entities/Dictionary/Garage","Sm-Entities-Dictionary-templates-_template":CHI_URL+"Sm/Entities/Dictionary/templates/_template","Sm-Entities-Dictionary-templates-standard":CHI_URL+"Sm/Entities/Dictionary/templates/standard","Sm-Entities-Dimension-MvCombo":CHI_URL+"Sm/Entities/Dimension/MvCombo","Sm-Entities-Dimension-Wrapper":CHI_URL+"Sm/Entities/Dimension/Wrapper","Sm-Entities-Dimension-View":CHI_URL+"Sm/Entities/Dimension/View","Sm-Entities-Dimension-Model":CHI_URL+"Sm/Entities/Dimension/Model","Sm-Entities-Dimension-Meta":CHI_URL+"Sm/Entities/Dimension/Meta","Sm-Entities-Dimension-Garage":CHI_URL+"Sm/Entities/Dimension/Garage","Sm-Entities-Dimension-templates-_template":CHI_URL+"Sm/Entities/Dimension/templates/_template","Sm-Entities-Dimension-templates-standard":CHI_URL+"Sm/Entities/Dimension/templates/standard","Sm-Entities-Section-MvCombo":CHI_URL+"Sm/Entities/Section/MvCombo","Sm-Entities-Section-Wrapper":CHI_URL+"Sm/Entities/Section/Wrapper","Sm-Entities-Section-View":CHI_URL+"Sm/Entities/Section/View","Sm-Entities-Section-Model":CHI_URL+"Sm/Entities/Section/Model","Sm-Entities-Section-Meta":CHI_URL+"Sm/Entities/Section/Meta","Sm-Entities-Section-Garage":CHI_URL+"Sm/Entities/Section/Garage","Sm-Entities-Section-templates-_template":CHI_URL+"Sm/Entities/Section/templates/_template","Sm-Entities-Section-templates-standard":CHI_URL+"Sm/Entities/Section/templates/standard","Sm-Entities-Section-templates-definition":CHI_URL+"Sm/Entities/Section/templates/definition","Sm-Entities-Section-templates-image":CHI_URL+"Sm/Entities/Section/templates/image","Sm-Entities-Section-RelationshipAbstraction-pivots_RelationshipIndex":CHI_URL+"Sm/Entities/Section/RelationshipAbstraction/pivots_RelationshipIndex","Sm-Entities-Concept-MvCombo":CHI_URL+"Sm/Entities/Concept/MvCombo","Sm-Entities-Concept-Wrapper":CHI_URL+"Sm/Entities/Concept/Wrapper","Sm-Entities-Concept-View":CHI_URL+"Sm/Entities/Concept/View","Sm-Entities-Concept-Model":CHI_URL+"Sm/Entities/Concept/Model","Sm-Entities-Concept-Meta":CHI_URL+"Sm/Entities/Concept/Meta","Sm-Entities-Concept-Garage":CHI_URL+"Sm/Entities/Concept/Garage","Sm-Entities-Concept-templates-_template":CHI_URL+"Sm/Entities/Concept/templates/_template","Sm-Entities-Concept-templates-standard":CHI_URL+"Sm/Entities/Concept/templates/standard"}}),define("require_config",function(){}),require(["require","Sm","Sm-Core-Core","Sm/Entities/Abstraction/Garage"],function(e){Sm.Entities.Collection=Sm.Entities.Collection||{},Sm.Entities.Collection.templates=Sm.Entities.Collection.templates||{},e(["Sm-Entities-Collection-MvCombo"],function(){}),e(["Sm-Entities-Collection-Garage"],function(){}),e(["Sm-Entities-Collection-Wrapper"],function(){}),e(["Sm-Entities-Collection-View"],function(){}),e(["Sm-Entities-Collection-Model"],function(){}),e(["Sm-Entities-Collection-Meta"],function(){}),Sm.loaded.when_loaded(["Entities_Collection_MvCombo","Entities_Collection_Wrapper","Entities_Collection_View","Entities_Collection_Model","Entities_Collection_Meta","Entities_Collection_Garage"],function(){var e=$(document.body);Sm.Entities.Collection.Wrapper.hydrate({elements:e.find(".spwashi-collection")}),Sm.loaded.add("Collection__core"),Sm.loaded.when_loaded(["Entities_Collection_Garage"],function(){Sm.loaded.add("Collection")}),Sm.CONFIG.DEBUG&&console.log(" --- Collection has been loaded!"),Sm.Extras.visual_debug("Collection has been loaded!")},"Collection")}),define("Sm-Entities-Collection-main",function(){}),require(["require","Sm","Sm-Core-Core","Sm/Entities/Abstraction/Garage"],function(e){Sm.Entities.Dictionary=Sm.Entities.Dictionary||{},Sm.Entities.Dictionary.templates=Sm.Entities.Dictionary.templates||{},Sm.Entities.Dictionary.plural="Dictionaries",e(["Sm-Entities-Dictionary-MvCombo"],function(){}),e(["Sm-Entities-Dictionary-Wrapper"],function(){}),e(["Sm-Entities-Dictionary-View"],function(){}),e(["Sm-Entities-Dictionary-Garage"],function(){}),e(["Sm-Entities-Dictionary-Model"],function(){}),e(["Sm-Entities-Dictionary-Meta"],function(){}),Sm.loaded.when_loaded(["Entities_Dictionary_MvCombo","Entities_Dictionary_Wrapper","Entities_Dictionary_View","Entities_Dictionary_Model","Entities_Dictionary_Meta","Entities_Dictionary_Garage"],function(){var e=$(document.body),t=e.find(".spwashi-dictionary");Sm.Entities.Dictionary.Wrapper.hydrate({elements:t}),Sm.loaded.add("Dictionary__core"),Sm.loaded.when_loaded(["Entities_Dictionary_Garage"],function(){Sm.loaded.add("Dictionary")});for(var i=0;i<t.length;i++){var n=t[i],o=$(n),r=o.find("input[type=checkbox]")[0];if(r&&r.checked){var s=Sm.Core.Identifier.retrieve(n.dataset.ent_id);if(s){var a=s.getResource();a&&a.activate()}}}Sm.CONFIG.DEBUG&&console.log(" --- Dictionary has been loaded!"),Sm.Extras.visual_debug("Dictionary has been loaded!")},"Dictionary")}),define("Sm-Entities-Dictionary-main",function(){}),require(["require","Sm","Sm-Core-Core","Sm/Entities/Abstraction/Garage"],function(e){Sm.Entities.Page=Sm.Entities.Page||{},Sm.Entities.Page.templates=Sm.Entities.Page.templates||{},e(["Sm-Entities-Page-MvCombo"],function(){}),e(["Sm-Entities-Page-Wrapper"],function(){}),e(["Sm-Entities-Page-View"],function(){}),e(["Sm-Entities-Page-Garage"],function(){}),e(["Sm-Entities-Page-Model"],function(){}),e(["Sm-Entities-Page-Meta"],function(){}),Sm.loaded.when_loaded(["Entities_Page_MvCombo","Entities_Page_Wrapper","Entities_Page_View","Entities_Page_Model","Entities_Page_Garage","Entities_Page_Meta"],function(){var e=$(document.body);Sm.Entities.Page.Wrapper.hydrate({elements:e.find(".spwashi-page")}),Sm.loaded.add("Page"),Sm.loaded.add("Page__core"),Sm.CONFIG.DEBUG&&console.log(" --- Page has been loaded!"),Sm.Extras.visual_debug("Page has been loaded!")},"Page")}),define("Sm-Entities-Page-main",function(){}),require(["require","Sm","Sm-Core-Core"],function(e){Sm.Entities.Dimension=Sm.Entities.Dimension||{},Sm.Entities.Dimension.templates=Sm.Entities.Dimension.templates||{},e(["Sm-Entities-Dimension-MvCombo"],function(){}),e(["Sm-Entities-Dimension-Wrapper"],function(){}),e(["Sm-Entities-Dimension-View"],function(){}),e(["Sm-Entities-Dimension-Garage"],function(){}),e(["Sm-Entities-Dimension-Model"],function(){}),e(["Sm-Entities-Dimension-Meta"],function(){}),Sm.loaded.when_loaded(["Entities_Dimension_MvCombo","Entities_Dimension_Wrapper","Entities_Dimension_View","Entities_Dimension_Model","Entities_Dimension_Meta"],function(){var e=$(document.body);Sm.Entities.Dimension.Wrapper.hydrate({elements:e.find(".spwashi-dimension")});var t=Sm.Entities.Dimension.Wrapper.MvMaps.active_MVs;for(var i in t)if(t.hasOwnProperty(i)&&t[i].MvCombo){t[i].MvCombo.focus();break}Sm.loaded.add("Dimension__core"),Sm.loaded.when_loaded(["Entities_Dimension_Garage"],function(){Sm.loaded.add("Dimension")}),Sm.CONFIG.DEBUG&&console.log(" --- Dimension has been loaded!"),Sm.Extras.visual_debug("Dimension has been loaded!")},"Dimension")}),define("Sm-Entities-Dimension-main",function(){}),require(["require","Sm","Sm-Core-Core","Sm/Entities/Abstraction/Garage"],function(e){Sm.Entities.Concept=Sm.Entities.Concept||{},Sm.Entities.Concept.templates=Sm.Entities.Concept.templates||{},e(["Sm-Entities-Concept-MvCombo"],function(){}),e(["Sm-Entities-Concept-Wrapper"],function(){}),e(["Sm-Entities-Concept-View"],function(){}),e(["Sm-Entities-Concept-Garage"],function(){}),e(["Sm-Entities-Concept-Model"],function(){}),e(["Sm-Entities-Concept-Meta"],function(){}),Sm.loaded.when_loaded(["Entities_Concept_MvCombo","Entities_Concept_Wrapper","Entities_Concept_View","Entities_Concept_Model","Entities_Concept_Meta","Entities_Concept_Garage"],function(){var e=$(document.body);Sm.Entities.Concept.Wrapper.hydrate({elements:e.find(".spwashi-concept")}),Sm.loaded.add("Concept__core"),Sm.loaded.when_loaded(["Entities_Concept_Garage"],function(){Sm.loaded.add("Concept")},"Concept"),Sm.CONFIG.DEBUG&&console.log(" --- Concept has been loaded!"),Sm.Extras.visual_debug("Concept has been loaded!")},"Concept")}),define("Sm-Entities-Concept-main",function(){}),require(["require","Sm","Sm-Core-Core","Sm/Entities/Abstraction/Garage"],function(e){Sm.Entities.Section=Sm.Entities.Section||{},Sm.Entities.Section.templates=Sm.Entities.Section.templates||{},Sm.Entities.Section.RelationshipAbstraction=Sm.Entities.Section.RelationshipAbstraction||{},e(["Sm-Entities-Section-Meta"],function(){}),e(["Sm-Entities-Section-MvCombo"],function(){}),e(["Sm-Entities-Section-Wrapper"],function(){}),e(["Sm-Entities-Section-View"],function(){}),e(["Sm-Entities-Section-Garage"],function(){}),e(["Sm-Entities-Section-Model"],function(){}),e(["Sm-Entities-Section-RelationshipAbstraction-pivots_RelationshipIndex"],function(){}),Sm.loaded.when_loaded(["Entities_Section_MvCombo","Entities_Section_Wrapper","Entities_Section_View","Entities_Section_Model","Entities_Section_Meta","Entities_Section_Garage","Entities_Section_RelationshipAbstraction_pivots_RelationshipIndex"],function(){Sm.loaded.add("Section__core"),Sm.loaded.when_loaded(["Entities_Section_Garage","Entities_Section_RelationshipAbstraction_pivots_RelationshipIndex"],function(){
Sm.loaded.add("Section")});var e=$(document.body);Sm.Entities.Section.Wrapper.hydrate({elements:e.find(".spwashi-section")}),Sm.CONFIG.DEBUG&&console.log(" --- Section has been loaded!"),Sm.Extras.visual_debug("Section has been loaded!")},"Section")}),define("Sm-Entities-Section-main",function(){}),require(["require","Sm","crossvent"],function(e){var t=window.document.documentElement,i=document.body,n=$(window);Sm.loaded.when_loaded(["Core","Core_util_crossvent"],function(){var e=Sm.Core.util.crossvent,o={getNextElement:function(e){function t(){var t=e;do t=t.nextSibling;while(t&&1!==t.nodeType);return t}return e.nextElementSibling||t()},getRectHeight:function(e){return e.width||e.right-e.left},getRectWidth:function(e){return e.height||e.bottom-e.top},getOffset:function(e,t){var i=e.getBoundingClientRect(),n=this,o=n.getScroll("scrollLeft","pageXOffset"),r=n.getScroll("scrollTop","pageYOffset");return t&&(o*=0,r*=0),{left:i.left+o,top:i.top+r}},get_event_host:function(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e},get_coordinate:function(e,t){var i=this.get_event_host(t),n={pageX:"clientX",pageY:"clientY"};return e in n&&!(e in i)&&n[e]in i&&(e=n[e]),i[e]},is_input:function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName},getScroll:function(e,i){return"undefined"!=typeof global[i]?global[i]:t.clientHeight?t[e]:document.body[e]},getParent:function(e){return e&&e.parentNode&&e.parentNode!=document?e.parentNode:null},which_mouse_button:function(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.buttons)return e.buttons;if(void 0!==e.which)return e.which;var t=e.button;return void 0!==t?1&t?1:2&t?3:4&t?2:0:void 0},getElOffset:function(e){var t=0,i=0;do t+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent;while(e);return{top:t,left:i}},always:function(){return!0},never:function(){return!1},pn_touch:function(t,i,n,o){var r={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},s={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};global.navigator.msPointerEnabled&&e[i](t,s[n],o),e[i](t,r[n],o),e[i](t,n,o)}},r=Sm.Extras.Draggable={position:{mouse:{x:0,y:0}},mouse_event_listener:function(e){this.position.mouse.x=e.clientX,this.position.mouse.y=e.clientY},mixin:function(e){e=e||{},this.el=this.el||e.el||null,this.$el=this.$el||$(this.el);var s=this,a=o.never,l=o.never;e.can_start?e.can_start===!0?a=o.always:"function"==typeof e.can_start&&(a=e.can_start):a=o.never,e.can_accept?e.can_accept===!0?l=o.always:"function"==typeof e.can_accept&&(l=e.can_accept):l=o.never;var c=e.data||{};this.makeElementDraggable=function(e,t){var i=e||this.el;this.$el=this.$el||$(i),"boolean"==typeof t?t&&(t=this.$el.find(".handle")[0]):"string"==typeof t?t=this.$el.find(t)[0]:Sm.Core.util.isElement(t)||(t=!1),t="undefined"!=typeof t?t:i,i.sm_Draggable=this,i.dataset.sm_draggable=!0,this._draggable.data=c,t&&o.pn_touch(t,"add","mousedown",this.add_bound("grab",this._draggable.grab,this._draggable))},this.removeElementDraggable=function(e,t){var i=e||this.el;i.sm_Draggable=!1,i.dataset.sm_draggable=!1,this._draggable.data={},"boolean"==typeof t?t&&(t=this.$el.find(".handle")[0]):"string"==typeof t?t=this.$el.find(t)[0]:Sm.Core.util.isElement(t)||(t=!1),t="undefined"!==t?t:i,t&&o.pn_touch(t,"remove","mousedown",this.add_bound("grab",this._draggable.grab,this._draggable))},this.setDraggingStatus=function(e){e?this.$el.addClass("sm-transit"):this.$el.removeClass("sm-transit")},this.renderDragMirror=this.renderDragMirror||function(e){var t=e.cloneNode(!0);return t.style.position="absolute",t.style.width=e.offsetWidth,t.style.height=e.offsetHeight,t},this.add_bound=this.add_bound||function(e,t,i){return this._fns=this._fns||{},"function"!=typeof t?(Sm.CONFIG.DEBUG&&console.log(t,e),function(){}):this._fns[e]=this._fns[e]||t.bind(i||this)},this.get_bound=this.get_bound||function(e){return this._fns[e]?this._fns[e]:function(){}.bind(this)},this._draggable={status:{is_draggable:!1,is_dragging:!1,is_grabbed:!1,_grab_has_been_called:!1,is_animated:!1},position:{offset:{x:0,y:0},latest_mouse:{x:0,y:0}},elements:{last_hover:null,last_drop_target:null},known_droppables:{},data:{},mirror_contains:function(e){if(!e)return!1;if(this.elements.mirror){if(e==this.elements.mirror)return!0;if(e.dataset&&1==e.dataset.sm_drag_is_in_mirror)return!0;for(var t,n=!0;n;){if(t=e.parentNode,t==this.elements.mirror)return e.dataset&&(e.dataset.sm_drag_is_in_mirror=!0),!0;t&&t!==i&&t!==document?e=t:n=!1}}return e.dataset&&(e.dataset.sm_drag_is_in_mirror=!1),!1},find_drop_target:function(){for(var e,t,n=r.position.mouse,o=n.x,s=n.y,a=[],c=[],d=document.elementFromPoint(o,s),u=[];!e&&d&&d!==i&&d!==window&&d!==document&&d!==document.documentElement;)if(a.push(d),c.push(d.style.visibility),d.style.visibility="hidden",d=document.elementFromPoint(o,s),!this.mirror_contains(d)){if(d.dataset.sm_drag_find_drop_rand_id&&(t=d.dataset.sm_drag_find_drop_rand_id,this.known_droppables[t])){e=d;break}d.sm_Draggable&&l&&l.call(d.sm_Draggable,this,this.data)&&(u.push(d),t=d.dataset.sm_drag_find_drop_rand_id=Sm.Core.util.randomString(7),this.known_droppables[t]=d)}for(var p=0;p<a.length;p++)a[p].style.visibility=c[p];return e||!1},find_first_element:function(){var e,n,o=r.position.mouse,s=o.x,a=o.y;(n=this.elements.mirror)&&(e=n.style.visibility)&&(n.style.visibility="hidden");var l=document.elementFromPoint(s,a);!!n&&(n.style.visibility=e);for(var c,d=[],u=[];!c&&l&&l!==i&&l!==window&&l!==document&&l!==t;){if(l=document.elementFromPoint(s,a),!this.mirror_contains(l)){c=l;break}u.push(l.style.visibility),l.style.visibility="hidden",d.push(l)}for(var p=0;p<d.length;p++){var h=d[p];h.style.visibility=u[p]}return c||!1},grab:function(e){if(!this.status._grab_has_been_called){!this.position&&Sm.CONFIG.DEBUG&&console.log(this),this.position.latest_mouse.x=r.position.mouse.x,this.position.latest_mouse.y=r.position.mouse.y;var t=1!==o.which_mouse_button(e)||!!e.metaKey||!!e.ctrlKey;if(!t&&a(e)){if(e.stopPropagation(),"mousedown"===e.type){var i=e.target;if(o.is_input(i))return}this.manual_grab(e)}}},manual_grab:function(e){document.selection&&document.selection.empty&&document.selection.empty(),window.getSelection&&window.getSelection().removeAllRanges(),this.status._grab_has_been_called=!0,this.status.is_grabbed=!0;var i=s.$el,n=s.el,a=this.elements.mirror=s.renderDragMirror(n);if(!a)return this.release(),!1;!!e&&e.preventDefault&&e.preventDefault(),t.appendChild(a),i.addClass("sm-transit");var l=a.offsetWidth,c=a.offsetHeight;a.style.left=r.position.mouse.x-l/2+"px",a.style.top=r.position.mouse.y-c/2+"px",o.pn_touch(t,"add","mousemove",s.add_bound("drag",this.drag,this)),o.pn_touch(t,"add","mouseup",s.add_bound("release",this.release,this))},drag:function(e){o.get_coordinate("clientX",e),o.get_coordinate("clientY",e);this.cache=this.cache||{};var t=this.cache.window_height||n.innerHeight();this.status.is_dragging=!0;var i=this.position.latest_mouse.x,s=this.position.latest_mouse.y,a=r.position.mouse.x,l=r.position.mouse.y,c=a-i,d=l-s;if(!(Math.abs(c)<5&&Math.abs(d)<5)){this.position.latest_mouse.x=a,this.position.latest_mouse.y=l,Math.abs(t-e.clientY)<70?window.scrollBy(e.clientX,20):e.clientY<70&&window.scrollBy(e.clientX,-20);var u=this.elements.mirror;if(u){var p=u.style.left,h=u.style.top;h=parseFloat(h.substring(0,h.length-2)),p=parseFloat(p.substring(0,p.length-2));var f=this.find_drop_target(),m=this.elements.last_drop_target;return f?void(f!=m&&($(u).addClass("sm-dropping"),!this.status.is_animated&&this.animate_droppability(),m&&$(m).removeClass("sm-hover"),this.elements.last_drop_target=f,$(f).addClass("sm-hover"))):void(m&&(m&&$(m).removeClass("sm-hover"),this.elements.last_drop_target=null,$(u).removeClass("sm-dropping")))}}},animate_droppability:function(){var e=this.elements.mirror,t=e.style.left,i=e.style.top;i=parseFloat(i.substring(0,i.length-2)),t=parseFloat(t.substring(0,t.length-2));var n,o,s=this.status,a=e.getBoundingClientRect(),l=a.width,c=a.height,d=t+l/2,u=i-c/2,p=function(a,l){if(!s.is_dragging)return!1;n=r.position.mouse.y,o=r.position.mouse.x;var c=n-u,p=o-d;s.is_animated=!0,a=(a||16)/2;var h=Math.round(p/a),f=Math.round(c/a);t+=h,d+=h,i+=f,u+=f,e.style.top=i+"px",e.style.left=t+"px"};return Sm.Core.util.create_animation_loop(p),!0},drop:function(){var e=this.elements.last_drop_target;if(!e)return!1;var t=e.sm_Draggable;return t?(s.setDraggingStatus(!1),void("function"==typeof t.accept_drop&&t.accept_drop(this.data))):!1},release:function(){t.style.pointer="auto";var e=this.elements.last_drop_target;!!e&&$(e).removeClass("sm-hover"),this.drop(),this.elements.mirror&&this.elements.mirror.parentNode.removeChild(this.elements.mirror),this.elements.mirror=this.elements.last_hover=this.elements.last_drop_target=this.status.is_animated=this.status.is_dragging=this.status._grab_has_been_called=!1;var i=this.known_droppables;for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];r&&r.dataset&&(r.dataset.sm_drag_find_drop_rand_id=!1)}var a=s.$el;a.removeClass("sm-transit"),o.pn_touch(t,"remove","mousemove",s.add_bound("drag",this.drag,this)),o.pn_touch(t,"remove","mouseup",s.add_bound("release",this.release,this))}},this.grabElement=this._draggable.manual_grab.bind(this._draggable)}};Sm.loaded.add("Extras_Draggable"),document.addEventListener("mousemove",r.mouse_event_listener.bind(r))},"Extras_Draggable")}),define("Sm/Extras/DraggableMixin",function(){}),require(["require","Emitter","Sm"],function(e,t){e("Sm"),Sm.loaded.when_loaded("Core",function(){"use strict";Sm.Extras.ViewAid=t.extend({init:function(e){e=e||{},this.settings=this.settings||e,this.html="",this._callbacks=this._callbacks||{},this.status={is_open:!1},this.init_emitter_events(),this.element=e.element,this.action_classname="view_aid-button",Array.isArray(this.settings.click_events)||(this.settings.click_events=[this.settings.click_events]),this.settings.click_events.splice(0,0,this.default_click_handler.bind(this)),this.click_events=this.settings.click_events;var t=this.element;this.html=Sm.Core.util.isElement(t)?t.innerHTML:"string"==typeof t?t:"",e.is_open&&(this.status.is_open=!0,this.init_events())},_click_handler:function(e){if(this.status.is_open)for(var t=this.settings.click_events,i=0;i<t.length;i++){var n=t[i];if("function"==typeof n&&!1===n(e))break}return!0},init_events:function(){if(!this.element)return!1;var e=this.add_bound("outside_click",this._outsideClickHandler);this.element.addEventListener("click",e);var t=this.add_bound("click_handler",this._click_handler);return this.element.addEventListener("click",t,!0),!0},setElement:function(e){this.html=Sm.Core.util.isElement(e)?e.innerHTML:"string"==typeof e?e:""},_changeElement:function(e){this.html=Sm.Core.util.isElement(e)?e.innerHTML:"string"==typeof e?e:"";var t=this.get_content_element();t&&(t.innerHTML=this.html),this.init_events(),this.emit("open")},open:function(){this.emit("before_open",this),this.status.is_open=!0,this.init_events(),this.emit("open",this,this.content_element)},close:function(){this.emit("before_close",this,this.content_element),this.element&&$(this.element).remove(),this.status.is_open=!1,this.emit("close",this,this.content_element)},_outsideClickHandler:function(e){for(var t=e.target;t!=document.body&&t.parentNode;){if(t===this.get_content_element())return;t=t.parentNode}this.close()},default_click_handler:function(e){var t=e.target,i=$(t),n=this,o=!1,r=!1,s=[{c:i.hasClass("edit")&&i.hasClass(this.action_classname),f:function(){n.emit("edit",n,n.get_content_element())}},{c:i.hasClass("save")&&i.hasClass(this.action_classname),f:function(){n.emit("save",n,n.get_content_element())}},{c:i.hasClass("add")&&i.hasClass(this.action_classname),f:function(){n.emit("add",n,n.get_content_element())}},{c:i.hasClass("close")&&i.hasClass(this.action_classname),f:function(){n.close()}},{c:(o=i.hasClass("action"))||(r=i.parents(".action")).length,f:function(){return o||(i=r[0],t=i),t.dataset.action&&n.emit(t.dataset.action,n,n.get_content_element(),t.dataset.data||"",t.dataset,e),t.dataset.action&&e.stopPropagation(),!0}}];return Sm.Core.util.switch_(s)},get_content_element:function(e){return this.$element=this.$element||$(this.element),e?this.$element:this.element},init_emitter_events:function(){var e=this.settings.events;for(var t in e)if(e.hasOwnProperty(t)){var i,n=e[t];if(n.constructor===Array)for(var o=0;o<n.length;o++)i=n[o],i&&"function"==typeof i.bind?this.on(t,i.bind(this)):Sm.CONFIG.DEBUG&&console.log(i);else{if(i=n,!i||"function"!=typeof i.bind){Sm.CONFIG.DEBUG&&console.log(i);continue}this.on(t,i.bind(this))}}var r=this;this.on("open",function(){for(var e=r.get_content_element(),t=$(e).find("select"),i=0;i<t.length;i++){var n=t[i];n.addEventListener("change",function(e){r.emit("select",e)})}})}}),Sm.loaded.add("Extras_ViewAid")},"Extras_ViewAid")}),define("Sm/Extras/ViewAid",function(){}),require(["jquery"],function(e){Sm.Extras.Highlight={highlight:function(t,i){function n(t,i,o,r,s){var l=t.childNodes;if(l&&l.length)for(var c=0;c<l.length;c++){var d=l[c];e(d).hasClass("sm-highlight")&&1===d.childNodes.length&&d.childNodes[0].textContent&&d.childNodes[0].textContent.toLowerCase()==a.toLowerCase()||n(d,i,o,r,s)}else{var p=t.textContent||t.innerHTML;if(!t.splitText||!p||!p.length)return i;i.push(t),o.push(p),r.push(p.length),s[u++]={start:[],end:[],node:p}}return i}function o(e,t){for(var i,n,o,r=e.length,s=new RegExp(e+"\\b","gi"),a=[],l=[];null!=(i=s.exec(t));)n=i.index,o=n+r-1,a.push(n),l.push(o);return[a,l]}t=t&&"object"==typeof t?t:{},i=i&&"object"==typeof i?i:{};var r=t.element||document.body;if(Sm.Core.util.isElement(r)){var s=t.target||!1,a=t.word,l=t.className||"";l+=" sm-highlight";var c=t.dataset||{};c.word=c.word||a,a=a.trim();var d=a.length,u=0,p=i.on_init&&"function"==typeof i.on_init?i.on_init:!1,h=[],f=[],m=[],_={};n(r,h,f,m,_);var v=f.join(""),g=o(a,v),y=g[0],b=g[1];if(y||b){var S=function(e,t,i,n){var o=0,r=0,s=t[0];if(s)for(var a,l,c=s.length,u=c,p=0;p<e.length;p++){for(a=e[p],l=u-a;a>=u&&t[o];)o++,s=t[o],c=s.length,u+=c,l=u-a;r=c-l,0>r||(n?0>r-d&&i[o].end.push(r):i[o].start.push(r))}};S(y,f,_,0),S(b,f,_,1);for(var C=u-1;C+1;C--){var w,E,x=h[C],M=m[C],T=_[C].start,D=(_[C].end,0);if(T.length)for(var O=T.length-1;O+1;O--){D=T[O];var $;$=D+d>M?M:D+d,x.splitText($),E=x.splitText(D),x.normalize(),s?(w=document.createElement("a"),w.setAttribute("href",s)):w=document.createElement("span"),w.className=l;var I=E.cloneNode(!0);w.appendChild(I),c.word&&(w.dataset.word=c.word),Sm.CONFIG.DEBUG&&console.log(c.word),E.parentNode.replaceChild(w,E),p&&p(w)}}}}},un_highlight:function(t,i){t=t&&"object"==typeof t?t:{},i=i&&"object"==typeof i?i:{};var n=t.element||document.body;if(Sm.Core.util.isElement(n)){var o=t.word,r=t.dataset||{word:[],dictionary_ids:[]};r.word=r.word||[o],r.dictionary_ids=r.dictionary_ids||[],o=o.trim();for(var s=e(n),a=s.find(".sm-highlight[data-word="+o+"]"),l=0;l<a.length;l++){var c=a[l];e(c).replaceWith(c.childNodes)}return!0}}},Sm.loaded.add("Extras_SmHighlight")}),define("SmHighlight",function(){}),require(["require","Sm-Core-SmModel"],function(e){e("Sm-Core-SmModel"),Sm.Entities.Page.Model=Sm.Core.SmModel.extend({}),Sm.Entities.Page.Model.prototype.type="Page",Sm.loaded.add("Entities_Page_Model")}),define("Sm-Entities-Page-Model",function(){}),require(["require","Sm","Sm-Entities-Page-Model","Sm-Core-MvCombo"],function(e){Sm.loaded.when_loaded("Core_MvCombo",function(){Sm.Entities.Page.MvCombo=Sm.Core.MvCombo.extend({}),Sm.loaded.add("Entities_Page_MvCombo")},"Entities_Page_MvCombo")}),define("Sm-Entities-Page-MvCombo",function(){}),require(["require","Sm-Entities-Page-main","Sm-Core-MvWrapper"],function(e){Sm.loaded.when_loaded("Core_MvWrapper",function(){var e=Sm.Core.MvWrapper.extend({type:"Page",parentType:null,populate_container:function(e){}});Sm.Entities.Page.Wrapper=new e,Sm.loaded.add("Entities_Page_Wrapper")},"Entities_Page_Wrapper")}),define("Sm-Entities-Page-Wrapper",function(){}),require(["require"],function(e){Sm.loaded.when_loaded("Core_SmView",function(){Sm.Entities.Page.View=Sm.Core.SmView.extend({type:"Page",identifier:".spwashi-page",_rendering_callbacks:{button_control_element:function(){if(this.elements.button_control)return this.elements.button_control;var e=this.get_rendered("$Element").children(".button-control");return this.elements.button_control=e[0]?e[0]:!1}},additional_events:{click:function(e){this.MvCombo&&(this.handle_click(e.target),e.stopPropagation())}},handle_click:function(e){var t=$(e);if(!this.MvCombo)return!1;var i=this.find_closest_relationship(),n=i.Relationship;if(this.queryPermission("edit")&&t.hasClass("edit")&&t.hasClass("button"))this.prompt_edit({display_type:"inline"});else if(this.queryPermission("relate")&&t.hasClass("add")&&t.hasClass("button"))this.begin_add_relationship({type:"Dictionary"});else if(t.hasClass("add-section-button")){var o=Sm.Entities.Dimension.Wrapper.get_active();if(o){var r=o.getView();r.begin_add_relationship({type:"Section"})}}else t.hasClass("debug")&&t.hasClass("button")&&Sm.CONFIG.DEBUG?console.log(this.cid," -- ",this.MvCombo,this.MvCombo.Model.attributes):this.queryPermission("destroy")&&t.hasClass("delete")&&t.hasClass("button")&&(n?n.destroy({silent:!1}):this.MvCombo.destroy({prompt:!0},this))}}),Sm.loaded.add("Entities_Page_View")},"Entities_Page_View")}),define("Sm-Entities-Page-View",function(){}),require(["require","Sm-Core-Meta"],function(e){var t=Sm.Core.Meta.base_constructor.extend({relationship_type_obj:{concepts:{MvType:"Concept",index:"concept",id:null,primary_key:"page_id",secondary_key:"concept_id",is_reciprocal:!1,linked_entities:["Page","Concept"]},dimensions:{MvType:"Dimension",index:"dimension",id:null,primary_key:"page_id",secondary_key:"dimension_id",is_reciprocal:!1,linked_entities:["Page","Dimension"]},pages:{MvType:"Section|Concept",index:"section|concept",id:null,primary_key:"section_id|concept_id",secondary_key:"page_id",is_reciprocal:!0,linked_entities:["Page","Section|Concept"]}},get_possible_relationship_indices:function(e){if(!e)return[];e=e||{};var t=e.OtherMvCombo,i=(t?t.type:e.type)||!1,n=!!e.is_reciprocal;return n?[null,"pages"]:"Page"==i?["pages"]:"Collection"==i?["collections"]:"Section"==i?["sections"]:"Dimension"==i?["dimensions"]:"Concept"==i?["concepts"]:[]}});Sm.Entities.Page.Meta=new t({type:"Page"}),Sm.Entities.Page.Meta.base_constructor=t;var i="Page";Sm.loaded.add("Entities_"+i+"_Meta")}),define("Sm-Entities-Page-Meta",function(){}),require(["require","Sm-Entities-Page-main"],function(e){Sm.Entities.Page.templates._template={outer:{full:""},relationship_index_container:'<section class="relationship-index-container">\n    __CONTENT__\n</section>',relationship_container:'<div class="relationship-container __TYPE__-container" data-Mv-r_id="__R_ID__">\n    <header class="title">\n        <h2>__TITLE__</h2>\n    </header>\n    <div class="content">__CONTENT__</div>\n</div>',concept_relationship_outer:'<div class="relationship concept-relationship" data-Mv-r_id="__MV_R_ID__" data-Relationship-r_id="__R_ID__">\n    <div class="content">__CONTENT__</div>\n</div>',relationship_outer:'<div class="relationship" data-Relationship-r_id="__R_ID__" data-Mv-r_id="__MV_R_ID__">\n    <div class="content">__CONTENT__</div>\n</div>',modal_outer:{full:'<header>\n    <h3>Edit Page </h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" value="<%- id %>" name="id">\n\n    __CONTENT__\n\n    <div class="control-group view_relationship-container">\n        <button class="action modal-button" data-action="view_relationships">View Relationships</button>\n    </div>\n</div>'},button_control:{full:'<div class="icons button-control">\n    <i class="button edit fa fa-pencil"></i>\n    <i class="button delete close fa fa-remove"></i>\n    <i class="button add fa fa-plus"></i>\n    <i class="button handle fa fa-arrows"></i>\n    <i class="debug button fa fa-question"></i>\n</div>'}},Sm.loaded.add("Entities_Page_templates__template")}),define("Sm-Entities-Page-templates-_template",function(){}),require(["require","Sm-Entities-Page-main"],function(e){Sm.Entities.Page.templates.standard={modal:{full:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="subtitle">Subtitle:</label>\n    <input data-attribute="subtitle" class="model edit subtitle" type="text" name="subtitle"\n           placeholder="Section Subtitle" title="subtitle" value="<%- subtitle %>">\n    <span class="error" id="subtitle-error"></span>\n</div>\n<div class="control-group">\n    <label for="description">Description: </label>\n    <textarea data-attribute="description" class="model edit description" name="description" placeholder="Description"><%- description %></textarea>\n    <span class="error" id="description-error"></span>\n</div>'},body:{full:'<div class="page description" ><%- description %></div>'},cache:{}},Sm.loaded.add("Entities_Page_templates_standard")}),define("Sm-Entities-Page-templates-standard",function(){}),require(["require","Sm","Sm-Entities-Page-templates-_template","Sm-Entities-Page-templates-standard"],function(e){e("Sm"),e("Sm-Entities-Page-templates-_template"),e("Sm-Entities-Page-templates-standard"),Sm.loaded.when_loaded(["Entities_Abstraction_Garage","Entities_Page_Meta","Entities_Page_templates__template"],function(){var e=Sm.Entities.Abstraction.Garage.extend({relationships:function(e,t,i){return i=i||{},i.display_type="inline",Sm.Entities.Abstraction.Garage.prototype.relationships.apply(this,[e,t,i])},_continue_relationship_render:function(e,t,i,n){n=n||{};var o=$(t),r=Sm.Entities[this.type].templates._template,s=[];for(var a in e)if(e.hasOwnProperty(a)){var l=o.find("."+a+"-container");if(l[0]&&"concepts"===a)for(var c=e[a],d=0;d<c.length;d++){var u=c[d].View,p=u.MvCombo;if(p){var h=c[d].Relationship;s.indexOf(p.Identity.r_id)>-1&&(u=u.clone());var f=(n.relationship_outer?r[n.relationship_outer]:"Section"==p.type?r.definition_relationship_outer:r.relationship_outer)||"",m=f.replace("__CONTENT__","").replace("__TITLE__",'<%- title && title.trim().length ? title : "-" %>').replace("__R_ID__",h.Identity.r_id).replace("__MV_R_ID__",p.Identity.r_id);m=_.template(m)(p.Model.attributes),Sm.CONFIG.DEBUG&&console.log(m);var v=$(m),g=v.find(".content"),y=!1;try{g[0]&&y?(g[0].appendChild(y),v[0].addEventListener("click",function(e){return function(t){e.MvCombo.focus(e)}}(u)),l[0].appendChild(v[0]),s.push(p.Identity.r_id)):Sm.CONFIG.DEBUG&&console.log(v,g,u.cid)}catch(b){Sm.CONFIG.DEBUG&&console.log(b)}}}}var S=Sm.urls.api.generate({type:"Concept",context:{user_id:11}});$(o.find("#add-concept")).select2({tags:!0,multiple:!0,allowClear:!0,ajax:{url:S,dataType:"json",delay:250,data:function(e){return{q:e.term}},processResults:function(e,t){for(var i=[],n=0;n<e.length;n++){var o=e[n];o&&o.title&&i.push({id:o.ent_id,text:o.title})}return Sm.CONFIG.DEBUG&&console.log(i),{results:i}}}});var C=o[0];return i?C:Promise.resolve(C)}});Sm.Entities.Page.Garage=new e("Page","page_type"),Sm.loaded.add("Entities_Page_Garage")},"Entities_Page_Garage")}),define("Sm-Entities-Page-Garage",function(){}),require(["require","Sm-Core-SmModel"],function(e){e("Sm-Core-SmModel"),Sm.Entities.Concept.Model=Sm.Core.SmModel.extend({}),Sm.Entities.Concept.Model.prototype.type="Concept",Sm.loaded.add("Entities_Concept_Model")}),define("Sm-Entities-Concept-Model",function(){}),require(["require","Sm","Sm-Entities-Concept-Model","Sm-Core-MvCombo"],function(e){Sm.loaded.when_loaded("Core_MvCombo",function(){Sm.Entities.Concept.MvCombo=Sm.Core.MvCombo.extend({}),Sm.loaded.add("Entities_Concept_MvCombo")},"Entities_Concept_MvCombo")}),define("Sm-Entities-Concept-MvCombo",function(){}),require(["require","Sm-Entities-Concept-main","Sm-Core-MvWrapper"],function(e){Sm.loaded.when_loaded("Core_MvWrapper",function(){var e=Sm.Core.MvWrapper.extend({type:"Concept",parentType:null,populate_container:function(e){}});Sm.Entities.Concept.Wrapper=new e,Sm.loaded.add("Entities_Concept_Wrapper")},"Entities_Concept_Wrapper")}),define("Sm-Entities-Concept-Wrapper",function(){}),require(["require","backbone","jquery","underscore","Cocktail","Sm-Entities-Abstraction-ModalEdit"],function(e,t,i,n,o){Sm.Entities.Abstraction.mixins.SidebarModule={focus:function(){if(this.status.is_focused)return this;var e=this.MvCombo,t=e.Model,i=(t.get("description")||"",this),n=i.elements.description_container||this.get_rendered("description_container");return n?Sm.Entities[this.type].Garage.generate("preview",e,!1).then(function(e){i.elements.description_container.innerHTML=e,i.init_button_control_events()}):Sm.CONFIG.DEBUG&&console.log(this.type,this.elements.description_container,n),Sm.Core.SmView.prototype.focus.apply(this,arguments)},blur:function(){return this.MvCombo.queryStatus("focused")?(this.elements.description_container&&(this.elements.description_container.innerHTML=""),Sm.Core.SmView.prototype.blur.apply(this,arguments)):this},_rendering_callbacks:{button_control:function(){return this.elements.button_control=this.elements.button_control||i(this.get_rendered("description_container")).find(".button-control")[0]},container:function(){if(this.elements.container)return this.elements.container;var e=this.type.toLowerCase();return this.elements.container=this.elements.container||i("."+e+"-container")[0]||!1},description_container:function(){return this.elements.description_container=this.elements.description_container||i(this.get_rendered("container")).parent().find(".description-container")[0]},title_element:function(){if(this.elements.title)return this.elements.title;var e=this.get_rendered("$Element").find(".title");return this.elements.title=e[0]?e[0]:!1},description_element:function(){if(this.elements.description)return this.elements.description;var e=this.get_rendered("$Element").find(".description");return this.elements.description=e[0]?e[0]:!1}}},Sm.loaded.add("Sm_Entities_Abstraction_mixins_SidebarModule")}),define("Sm-Entities-Abstraction-mixins-SidebarModule",function(){}),require(["require","Sm-Entities-Abstraction-mixins-SidebarModule"],function(e){Sm.loaded.when_loaded(["Core_SmView","Sm_Entities_Abstraction_mixins_SidebarModule"],function(){Sm.Entities.Concept.View=Sm.Core.SmView.extend({type:"Concept",mixins:[Sm.Entities.Abstraction.mixins.SidebarModule],identifier:".spwashi-concept",additional_events:{click:function(e){var t=e.target,i=$(t);this.MvCombo;i.hasClass("spwashi-concept")&&(this.MvCombo.queryStatus("focused")?this.MvCombo.blur(this):this.MvCombo.focus(this),e.stopPropagation())}}}),Sm.loaded.add("Entities_Concept_View")},"Entities_Concept_View")}),define("Sm-Entities-Concept-View",function(){}),require(["require","Sm-Core-Meta"],function(e){var t=Sm.Core.Meta.base_constructor.extend({relationship_type_obj:{sections:{MvType:"Section",index:"section",id:null,primary_key:"concept_id",secondary_key:"section_id",is_reciprocal:!1,linked_entities:["Concept","Section"]},concepts:{MvType:"Section|Page|Concept",index:"section|page|concept",id:null,primary_key:"section_id|page_id|primary_concept_id",secondary_key:"concept_id|concept_id|primary_concept_id",is_reciprocal:!0,linked_entities:["Concept","Section|Page|Concept"]},pages:{MvType:"Page",index:"page",id:null,primary_key:"concept_id",secondary_key:"page_id",is_reciprocal:!1,linked_entities:["Page","Concept"]}},get_possible_relationship_indices:function(e){if(!e)return[];e=e||{};var t=e.OtherMvCombo,i=(t?t.type:e.type)||!1,n=!!e.is_reciprocal;return n?[null,"concepts"]:"Page"==i?["pages"]:"Collection"==i?["collections"]:"Section"==i?["sections"]:"Dimension"==i?["dimensions"]:"Concept"==i?["concepts"]:[]}});Sm.Entities.Concept.Meta=new t({type:"Concept"}),Sm.Entities.Concept.Meta.base_constructor=t;var i="Concept";Sm.loaded.add("Entities_"+i+"_Meta")}),define("Sm-Entities-Concept-Meta",function(){}),require(["require","Sm-Entities-Concept-main"],function(e){Sm.Entities.Concept.templates._template={outer:{full:"",preview:'<div class="spwashi-concept preview" data-ent_id="<%- ent_id %>" data-id="<%- id %>" data-title=\'<%- title %>\'>\n    __BUTTON_CONTROL__\n    __CONTENT__\n</div>',inline:"",tab:"",tag:""},relationship_index_container:'<section class="relationship-index-container">\n    <select multiple name="relationships-concepts" id="add-concept" data-attribute="relationships-concepts" class="model edit"></select>\n    __CONTENT__\n</section>',relationship_container:'<div class="relationship-container __TYPE__-container" data-Mv-r_id="__R_ID__">\n    <header class="title">\n        <h2>__TITLE__</h2>\n    </header>\n    <div class="content">__CONTENT__</div>\n</div>',relationship_outer:'<div class="relationship" data-Relationship-r_id="__R_ID__" data-Mv-r_id="__MV_R_ID__">\n    <div class="content">__CONTENT__</div>\n</div>',modal_outer:{full:'<header>\n    <h3>Edit Concept </h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" value="<%- id %>" name="id">\n\n    __CONTENT__\n\n    <div class="control-group view_relationship-container">\n        <button class="action modal-button" data-action="view_relationships">View Relationships</button>\n    </div>\n</div>'},button_control:{full:'<div class="icons button-control">\n    <i class="button edit fa fa-pencil"></i>\n    <i class="button delete close fa fa-remove"></i>\n    <i class="button add fa fa-plus"></i>\n    <i class="button handle fa fa-arrows"></i>\n    <i class="debug button fa fa-question"></i>\n</div>'},modal_button_control:{full:'<div class="icons button-control">\n    <i class="modal-button button edit fa fa-pencil"></i>\n    <i class="modal-button delete button close fa fa-remove"></i>\n    <i class="modal-button button save fa fa-save icon-save"></i>\n    <i class="modal-button button add fa fa-plus"></i>\n</div>'}},Sm.loaded.add("Entities_Concept_templates__template")}),define("Sm-Entities-Concept-templates-_template",function(){}),require(["require","Sm-Entities-Concept-main"],function(e){Sm.Entities.Concept.templates.standard={modal:{full:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="subtitle">Subtitle:</label>\n    <input data-attribute="subtitle" class="model edit subtitle" type="text" name="subtitle"\n           placeholder="Section Subtitle" title="subtitle" value="<%- subtitle %>">\n    <span class="error" id="subtitle-error"></span>\n</div>\n<div class="control-group">\n    <label for="description">Description: </label>\n    <textarea data-attribute="description" class="model edit description" name="description" placeholder="Description"><%- description %></textarea>\n    <span class="error" id="description-error"></span>\n</div>'},body:{full:'<div class="description" ><%- description %></div>'},cache:{}},Sm.loaded.add("Entities_Concept_templates_standard")}),define("Sm-Entities-Concept-templates-standard",function(){}),require(["require","Sm","Sm-Entities-Concept-templates-_template","Sm-Entities-Concept-templates-standard"],function(e){e("Sm"),e("Sm-Entities-Concept-templates-_template"),e("Sm-Entities-Concept-templates-standard"),Sm.loaded.when_loaded(["Entities_Abstraction_Garage","Entities_Concept_Meta","Entities_Concept_templates__template"],function(){var e=Sm.Entities.Abstraction.Garage.extend({relationships:function(e,t,i){return i=i||{},i.display_type="preview",i.relationship_index_list=i.relationship_index_list||["sections","concepts"],
Sm.Entities.Abstraction.Garage.prototype.relationships.apply(this,[e,t,i])}});Sm.Entities.Concept.Garage=new e("Concept","concept_type"),Sm.loaded.add("Entities_Concept_Garage")})}),define("Sm-Entities-Concept-Garage",function(){}),require(["require","Sm-Entities-Section-main"],function(e){Sm.Entities.Section.templates._template={outer:{full:'<section title="<%- subtitle %>" class="spwashi-section spwashi-entity  <% if( ! has_title) {%>no-title<% } %> <% if(_type){ %>type-<%- _type %><% } %> " data-ent_id="<%- ent_id %>" data-id="<%- id %>" data-title=\'<%- title %>\'>\n    __BUTTON_CONTROL__\n    <div class="focus upper">\n        <div class="pan left ">\n            <i class="fa left fa-caret-left"></i>\n        </div>\n        <div class="pan right">\n            <i class="fa right fa-caret-right"></i>\n        </div>\n    </div>\n    <header>\n        <div class="dev id"><%- id %></div>\n        <% if(has_title != 0) { %><h3 class="title"><%- title %></h3> <% } %>\n    </header>\n    __CONTENT__\n    <div data-relationship_index="composition" data-ent_id="<%- ent_id %>" class="relationship-container composition-container"></div>\n    <div data-relationship_index="children" data-ent_id="<%- ent_id %>" class="relationship-container children-container"></div>\n</section>',preview:'<section title="<%- subtitle %>" class="spwashi-section preview spwashi-entity  <% if( ! has_title) {%>no-title<% } %> <% if(_type){ %>type-<%- _type %><% } %> " data-ent_id="<%- ent_id %>" data-id="<%- id %>" data-title=\'<%- title %>\'>\n    __BUTTON_CONTROL__\n    <header>\n        <div class="dev id"><%- id %></div>\n        <% if(has_title != 0) { %><h3 class="title"><%- title %></h3> <% } %>\n    </header>\n    __CONTENT__\n</section>',inline:'<span title="<%- subtitle %>" class="spwashi-section inline spwashi-entity <% if(_type){ %>type-<%- _type %><% } %>">\n    __BUTTON_CONTROL__\n    __CONTENT__\n</span>',tab:"",tag:""},modal_outer:{full:'<header>\n    <h3>Edit <%- _type ? _type : \'Section\' %></h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" class="section-type" value="<%- section_type%>">\n    <input type="hidden" value="<%- id %>" name="id">\n\n    __CONTENT__\n\n    <div class="control-group">\n        <label for="has_title">Display Title: </label>\n        <input class="model edit has_title" data-attribute="has_title" type="checkbox" id="has_title" name="has_title" value="1" <% if(has_title == 1) {%>checked<% } %>>\n    </div>\n    <div class="control-group">\n        <label for="section_type">Section Type: </label>\n        <select class="model edit section_type select" data-attribute="section_type" id="section_type" name="section_type">\n            <option value="1"\n            <% if(section_type == 1){%>selected<% } %>>Standard</option>\n            <option value="2"\n            <% if(section_type == 2){%>selected<% } %>>Image</option>\n            <option value="3"\n            <% if(section_type == 3){%>selected<% } %>>Video</option>\n            <option value="4"\n            <% if(section_type == 4){%>selected<% } %>>Audio</option>\n            <option value="5"\n            <% if(section_type == 5){%>selected<% } %>>Definition</option>\n            <option value="6"\n            <% if(section_type == 6){%>selected<% } %>>Table</option>\n            <option value="7"\n            <% if(section_type == 7){%>selected<% } %>>List</option>\n            <option value="8"\n            <% if(section_type == 8){%>selected<% } %>>Embedded Content</option>\n        </select>\n    </div>\n    <div class="control-group view_relationship-container" >\n        <button class="action modal-button" data-action="view_relationships">View Relationships</button>\n    </div>\n</div>'},relationship_index_container:'<section class="relationship-index-container">__CONTENT__</section>',relationship_container:'<div class="relationship-container __TYPE__-container" data-Mv-r_id="__R_ID__">\n    <header class="title">__TITLE__</header>\n    <div class="content">__CONTENT__</div>\n</div>',relationship_outer:'<div class="relationship" data-Relationship-r_id="__R_ID__">\n    <div class="add-to-list">\n        <input type="checkbox" title="Add entity">\n    </div>\n    <div class="content">__CONTENT__</div>\n</div>',button_control:{full:'<div class="icons button-control">\n    <i class="button edit fa fa-pencil"></i>\n    <i class="button delete close fa fa-remove"></i>\n    <i class="button add fa fa-plus"></i>\n    <i class="button handle fa fa-arrows"></i>\n    <i class="debug button fa fa-question"></i>\n</div>'},modal_button_control:{full:'<div class="icons button-control">\n    <i class="modal-button button edit fa fa-pencil"></i>\n    <i class="modal-button delete button close fa fa-remove"></i>\n    <i class="modal-button button save fa fa-save icon-save"></i>\n    <i class="modal-button button add fa fa-plus"></i>\n</div>'},pivot_display:'<div class="button-dialog relationship-type section-pivot">\n    \n    <% if(typeof(home) !== "undefined") {%>\n    <div class="relationship-subtype-category home clearfix">\n        <div data-action="pivot" data-data="home" class="relationship-subtype action home active" data-relationship_subtype="home"><span>Home</span></div>\n    </div>\n    <% } %>\n    <% if(typeof(text) !== "undefined") {%>\n    <div class="relationship-subtype-category text clearfix">\n        <div data-action="pivot" data-data="text" class="relationship-subtype action text <%= text.indexOf(\'text\') > -1 ? \'active\' : \'not\' %>" data-relationship_subtype="text"><span>Text</span></div>\n        <div data-action="pivot" data-data="eli5" class="relationship-subtype action eli5 <%= text.indexOf(\'eli5\') > -1 ? \'active\' : \'not\' %>" data-relationship_subtype="eli5"><span>ELI5</span></div>\n        <div data-action="pivot" data-data="thing_explainer" class="relationship-subtype action thing_explainer <%= text.indexOf(\'thing_explainer\') > -1 ? \'active\' : \'not\' %>" data-relationship_subtype="thing_explainer">\n            <span>Thing Explainer</span></div>\n    </div>\n    <% } %>\n    <% if(typeof(image) !== "undefined") {%>\n    <div class="relationship-subtype-category image">\n        <div data-action="pivot" data-data="image" class="relationship-subtype action image <%= image.indexOf(\'image\') > -1 ? \'active\' : \'inactive\' %>" data-relationship_subtype="image"><span>Image</span></div>\n    </div>\n    <% } %>\n    <% if(typeof(video) !== "undefined") {%>\n    <div class="relationship-subtype-category video">\n        <div data-action="pivot" data-data="video" class="relationship-subtype action video <%= video.indexOf(\'video\') > -1 ? \'active\' : \'inactive\' %>" data-relationship_subtype="video"><span>Video</span></div>\n    </div>\n    <% } %>\n    <% if(typeof(audio) !== "undefined") {%>\n    <div class="relationship-subtype-category audio">\n        <div data-action="pivot" data-data="audio" class="relationship-subtype action audio <%= audio.indexOf(\'audio\') > -1 ? \'active\' : \'inactive\' %>" data-relationship_subtype="audio"><span>Audio</span></div>\n    </div>\n    <% } %>\n</div>'},Sm.loaded.add("Entities_Section_templates__template")}),define("Sm-Entities-Section-templates-_template",function(){}),require(["require","Sm-Entities-Section-main"],function(e){Sm.Entities.Section.templates.standard={body:{full:'<div class="content" ><%- content %></div>',preview:'<div class="content" ><% if(content.length > 50 ){ %><%- content.substr(0, 50) %> <% } else {%> <%- content %> <% }%></div>',inline:'<div class="content" ><%- content && content.trim().length ? content :  "-" %></div>',tab:!1,tag:!1},modal:{full:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="subtitle">Subtitle:</label>\n    <input data-attribute="subtitle" class="model edit subtitle" type="text" name="subtitle"\n           placeholder="Section Subtitle" title="subtitle" value="<%- subtitle %>">\n    <span class="error" id="subtitle-error"></span>\n</div>\n<div class="control-group">\n    <label for="content_location">Content Location:</label>\n    <input data-attribute="content_location" class="model edit content_location" type="text" name="content_location"\n           placeholder="Content Location" title="content_location" value="<%- content_location %>">\n    <span class="error" id="content_location-error"></span>\n</div>\n<div class="control-group">\n    <label for="content">Content: </label>\n    <textarea data-attribute="content" class="model edit content" name="content" placeholder="Content"><%- content %></textarea>\n    <span class="error" id="content-error"></span>\n</div>',inline:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="content">Content: </label>\n    <textarea data-attribute="content" class="model edit content" name="content" placeholder="Content"><%- content %></textarea>\n    <span class="error" id="content-error"></span>\n</div>',preview:!1,tab:!1,tag:!1},cache:{}},Sm.loaded.add("Entities_Section_templates_standard")}),define("Sm-Entities-Section-templates-standard",function(){}),require(["require"],function(e){Sm.Entities.Section.templates.definition={modal_outer:{full:'<header>\n    <h3>Edit Definition!</h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" class="section-type" value="<%- section_type%>">\n    <input type="hidden" value="<%- id %>" name="id">\n\n    __CONTENT__\n\n    <div class="control-group">\n        <label for="has_title">Display Title: </label>\n        <input class="model edit has_title" data-attribute="has_title" type="checkbox" id="has_title" name="has_title" value="1" <% if(has_title == 1) {%>checked<% } %>>\n    </div>\n    <div class="control-group">\n        <label for="section_type">Section Type: </label>\n        <select class="model edit section_type select" data-attribute="section_type" id="section_type" name="section_type">\n            <option value="1"\n            <% if(section_type == 1){%>selected<% } %>>Standard</option>\n            <option value="2"\n            <% if(section_type == 2){%>selected<% } %>>Image</option>\n            <option value="3"\n            <% if(section_type == 3){%>selected<% } %>>Video</option>\n            <option value="4"\n            <% if(section_type == 4){%>selected<% } %>>Audio</option>\n            <option value="5"\n            <% if(section_type == 5){%>selected<% } %>>Definition</option>\n            <option value="6"\n            <% if(section_type == 6){%>selected<% } %>>Table</option>\n            <option value="7"\n            <% if(section_type == 7){%>selected<% } %>>List</option>\n            <option value="8"\n            <% if(section_type == 8){%>selected<% } %>>Embedded Content</option>\n        </select>\n    </div>\n    <div class="control-group view_relationship-container" >\n        <button class="action modal-button" data-action="view_relationships">View Relationships</button>\n    </div>\n</div>',inline:'<header>\n    <h3>Edit Definition!</h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" class="section-type" value="<%- section_type%>">\n    <input type="hidden" value="<%- id %>" name="id">\n    __CONTENT__\n</div>',preview:!1,tab:!1,tag:!1},modal:{full:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="subtitle">Subtitle:</label>\n    <input data-attribute="subtitle" class="model edit subtitle" type="text" name="subtitle"\n           placeholder="Section Subtitle" title="subtitle" value="<%- subtitle %>">\n    <span class="error" id="subtitle-error"></span>\n</div>\n<div class="control-group">\n    <label for="content_location">Content Location:</label>\n    <input data-attribute="content_location" class="model edit content_location" type="text" name="content_location"\n           placeholder="Content Location" title="content_location" value="<%- content_location %>">\n    <span class="error" id="content_location-error"></span>\n</div>\n<div class="control-group">\n    <label for="content">Content: </label>\n    <textarea data-attribute="content" class="model edit content" name="content" placeholder="Content"><%- content %></textarea>\n    <span class="error" id="content-error"></span>\n</div>\n<div class="control-group">\n    <label for="words">Content: </label>\n    <textarea data-attribute="words" class="model edit words" name="words" placeholder="words"><%- words %></textarea>\n    <span class="error" id="words-error"></span>\n</div>',inline:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="content">Content: </label>\n    <textarea data-attribute="content" class="model edit content" name="content" placeholder="Content"><%- content %></textarea>\n    <span class="error" id="content-error"></span>\n</div>\n<div class="control-group">\n    <label for="words">Words: </label>\n    <textarea data-attribute="words" class="model edit words" name="words" placeholder="words"><%- words %></textarea>\n    <span class="error" id="words-error"></span>\n</div>'},body:{full:'<div class="content boon <% if(content_location !== undefined && !!content_location && content_location.length) {%>clickable <%}%>" ><%- content %></div>'},cache:{}},Sm.loaded.add("Entities_Section_templates_definition")}),define("Sm-Entities-Section-templates-definition",function(){}),require(["require"],function(e){Sm.Entities.Section.templates.image={modal_outer:{full:'<header>\n    <h3>Edit Image!</h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" class="section-type" value="<%- section_type%>">\n    <input type="hidden" value="<%- id %>" name="id">\n\n    __CONTENT__\n\n    <div class="control-group">\n        <label for="has_title">Display Title: </label>\n        <input class="model edit has_title" data-attribute="has_title" type="checkbox" id="has_title" name="has_title" value="1" <% if(has_title == 1) {%>checked<% } %>>\n    </div>\n    <div class="control-group">\n        <label for="section_type">Section Type: </label>\n        <select class="model edit section_type select" data-attribute="section_type" id="section_type" name="section_type">\n            <option value="1"\n            <% if(section_type == 1){%>selected<% } %>>Standard</option>\n            <option value="2"\n            <% if(section_type == 2){%>selected<% } %>>Image</option>\n            <option value="3"\n            <% if(section_type == 3){%>selected<% } %>>Video</option>\n            <option value="4"\n            <% if(section_type == 4){%>selected<% } %>>Audio</option>\n            <option value="5"\n            <% if(section_type == 5){%>selected<% } %>>Image</option>\n            <option value="6"\n            <% if(section_type == 6){%>selected<% } %>>Table</option>\n            <option value="7"\n            <% if(section_type == 7){%>selected<% } %>>List</option>\n            <option value="8"\n            <% if(section_type == 8){%>selected<% } %>>Embedded Content</option>\n        </select>\n    </div>\n    <div class="control-group view_relationship-container" >\n        <button class="action modal-button" data-action="view_relationships">View Relationships</button>\n    </div>\n</div>',inline:'<header>\n    <h3>Edit Image!</h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" class="section-type" value="<%- section_type%>">\n    <input type="hidden" value="<%- id %>" name="id">\n    __CONTENT__\n</div>'},modal:{full:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="subtitle">Subtitle:</label>\n    <input data-attribute="subtitle" class="model edit subtitle" type="text" name="subtitle"\n           placeholder="Section Subtitle" title="subtitle" value="<%- subtitle %>">\n    <span class="error" id="subtitle-error"></span>\n</div>\n<div class="control-group">\n    <label for="content_location">Content Location:</label>\n    <input data-attribute="content_location" class="model edit content_location" type="text" name="content_location"\n           placeholder="Content Location" title="content_location" value="<%- content_location %>">\n    <span class="error" id="content_location-error"></span>\n</div>\n<div class="control-group">\n    <label for="content">Content: </label>\n    <textarea data-attribute="content" class="model edit content" name="content" placeholder="Content"><%- content %></textarea>\n    <span class="error" id="content-error"></span>\n</div>\n<div class="control-group">\n    <label for="words">Content: </label>\n    <textarea data-attribute="words" class="model edit words" name="words" placeholder="words"><%- words %></textarea>\n    <span class="error" id="words-error"></span>\n</div>',inline:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Section Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="content">Content: </label>\n    <textarea data-attribute="content" class="model edit content" name="content" placeholder="Content"><%- content %></textarea>\n    <span class="error" id="content-error"></span>\n</div>\n<div class="control-group">\n    <label for="words">Content: </label>\n    <textarea data-attribute="words" class="model edit words" name="words" placeholder="words"><%- words %></textarea>\n    <span class="error" id="words-error"></span>\n</div>'},body:{full:'<div class="content-container entity-container">\n    <img class="content-location" src="<%- content_location %>" alt="<%- subtitle %>" title="">\n    <div class="content" ><%- content %></div>\n</div>'},cache:{}},Sm.loaded.add("Entities_Section_templates_image")}),define("Sm-Entities-Section-templates-image",function(){}),require(["require","underscore","Sm","Sm-Entities-Section-templates-_template","Sm-Entities-Section-templates-standard","Sm-Entities-Section-templates-definition","Sm-Entities-Section-templates-image"],function(e){e("Sm"),e("Sm-Entities-Section-templates-_template"),e("Sm-Entities-Section-templates-standard"),e("Sm-Entities-Section-templates-definition"),e("Sm-Entities-Section-templates-image"),Sm.loaded.when_loaded(["Entities_Abstraction_Garage","Entities_Section_Meta","Entities_Section_templates__template"],function(){var e=Sm.Entities.Abstraction.Garage.extend({relationships:function(e,t,i){return i=i||{},i.display_type="preview",i.relationship_index_list=i.relationship_index_list||["children","micros","pivots","composition","concepts"],Sm.Entities.Abstraction.Garage.prototype.relationships.apply(this,[e,t,i])}});Sm.Entities.Section.Garage=new e("Section","section_type"),Sm.loaded.add("Entities_Section_Garage")},"Entities_Section_Garage")}),define("Sm-Entities-Section-Garage",function(){}),require(["require","Sm-Core-SmModel"],function(e){e("Sm-Core-SmModel"),Sm.Entities.Section.Model=Sm.Core.SmModel.extend({defaults:{id:null,content_location:null,user_id:null,has_title:0,section_type:1,title:"-",subtitle:null,content:"-",description:"-",ent_id:null,words:""},set:function(e,t){if(Sm.Core.SmModel.prototype.set.call(this,e,t),this.init_words(),("string"==typeof e&&"words"==e||"object"==typeof e&&e.words)&&this.get("section_type")==Sm.Entities.Section.Meta.types.definition&&this.MvCombo){var i=this.MvCombo.getRelationshipIndex("dictionaries");if(!i)return;var n=i.get_listed_items(),o=n.items;if(n.count)for(var r=0;r<o.length;r++){var s=o[r];s&&s.add_definition&&s.add_definition(this.MvCombo)}}},init_words:function(){var e=[],t=this.get("section_type");if(t==Sm.Entities.Section.Meta.types.definition){e=this.get("words")||"","string"==typeof e&&e.trim().length?e=e.split(","):e.constructor!==Array&&(e=[]);for(var i=0;i<e.length;i++){var n=e[i];e[i]=n.trim()}this._words=e}return e},get_words:function(){return this.init_words(),this._words||[]},initialize:function(){this._words=[],Sm.Core.SmModel.prototype.initialize.apply(this,arguments)}}),Sm.Entities.Section.Model.prototype.type="Section",Sm.loaded.add("Entities_Section_Model")}),define("Sm-Entities-Section-Model",function(){}),require(["require","Sm","Sm-Entities-Section-Model","Sm-Core-MvCombo"],function(e){Sm.loaded.when_loaded("Core_MvCombo",function(){Sm.Entities.Section.MvCombo=Sm.Core.MvCombo.extend({scale:function(e,t){var i=Sm.Entities.Section.MvCombo.generate_standard_get_listed_items_fn("micros",t),n=Sm.Core.MvCombo.replace_MV({MvCombo:this,is_reciprocal:!e,list_items_fn:i,replacement_indices:"micros"});return Promise.resolve(n)},pivot:function(e,t){var i=e.constructor===Array&&"home"==e[0];e=i?e[1]||!1:Sm.Entities.Section.Meta.get_relationship_type({sub:!0,type:"index"},e);var n=Sm.Entities.Section.MvCombo.generate_standard_get_listed_items_fn("pivots",t,e),o=Sm.Core.MvCombo.replace_MV({MvCombo:this,replace_effective:!0,is_reciprocal:i,list_items_fn:n,replacement_indices:"pivots"});return Promise.resolve(o||{})},get_relationship_subtypes:function(e,t){var i={},n=this.relationships.pivots;if(!n)return{};var o=n.relationship_subtype_map,r=!1;if(o&&o[t]){var s;for(s in o[t])o[t].hasOwnProperty(s)&&s!=e&&(/eli5|thing_explainer|text/.test(s)?(i.text=i.text||[],i.text.push(s)):/audio|video|image/.test(s)&&(i[s]=i[s]||[],i[s].push(s),r=!0))}return"home"!=e&&(i.home=["home"],r=!0),i.max=i.text&&3||(r?1:!1),i},_build_other_MV:function(e,t){t.model_properties=t.model_properties||{};var i=Sm.Entities.Section.Meta.types.definition;return"Section"==e.type&&this.Model.attributes.section_type==i&&(t.model_properties.section_type=i),e.build_MV(t)},_continue_prompt_relationship_add:function(e,t){var i=Sm.Entities[this.type];if(!i)return Promise.reject("No SM");var n=i.Meta,o=e.type,r=!1;return new Promise(function(i,s){s=s||function(e){return Sm.CONFIG.DEBUG&&console.log(e)&&!1};var a=n.get_possible_relationship_indices({OtherMvCombo:e});if(1==a.length&&(t.relationship_index=a[0]),!t.relationship_index){if(!n||!n.get_relationship_type)return s("The relationship type is not established");t.relationship_index=prompt("What is the relationship type?"),(0===t.relationship_index.indexOf("reciprocal_")||0===t.relationship_index.indexOf("!"))&&(t.relationship_index=t.relationship_index.replace("reciprocal_","").replace("!",""),r=!0,Sm.CONFIG.DEBUG&&console.log(t.relationship_index,r)),t.relationship_index=n.get_relationship_type({type:"index"},t.relationship_index)}if(!t.relationship_index)return s("There is no established relationship type");if("pivots"==t.relationship_index?t.map.relationship_subtype=n.get_relationship_type({type:"id",sub:!0},prompt("What is the relationship subtype?")):t.position||"Concept"==o||(t.position=prompt("At which position should we add the relationship?"),t.position=t.position||0,t.map.position=t.position),t.OtherView&&t.OtherView.MvCombo){var l=!0;t.OtherView.MvCombo.blur(),l&&(t.OtherView=t.OtherView.clone())}return i({opposite:r})})},_relationship_detail_hook:function(e,t,i,n){var o,r,s;switch(e){case"Section":o=!0,r="secondary_section_id",s="primary_section_id",i.relationship_type=Sm.Entities.Section.Meta.get_relationship_type({type:"id"},t.relationship_index);break;case"Collection":case"Concept":case"Dictionary":case"Dimension":r=n+"_id",s="section_id"}return{map:i,reciprocity_matters:o,self_index:s,other_index:r}},_prompt_destroy:function(e,t){if(t=t||{},confirm("Are you sure you want to delete "+this.type+" "+this.Identity.ent_id))return this._continue_destroy({then_arg:e.then_args||[t.success,t.fail]});var i=this.Wrapper,n=this,o=e.View;return"function"==typeof t.cancel&&t.cancel({Wrapper:i,MvCombo:n,View:o}),Promise.reject()}}),Sm.Entities.Section.MvCombo.generate_standard_get_listed_items_fn=function(e,t,i){return function(n,o,r){var s=n.getRelationshipIndex(e,o);return s?"pivots"==e?s.get_listed_subtype_items(i,t):s.get_listed_items(t):{relationships:[],items:[]}}},Sm.loaded.add("Entities_Section_MvCombo")},"Entities_Section_MvCombo")}),define("Sm-Entities-Section-MvCombo",function(){}),require(["require"],function(e){Sm.loaded.when_loaded("Core_MvWrapper",function(){var e=Sm.Core.MvWrapper.extend({type:"Section",parentType:null,populate_container:function(e){}});Sm.Entities.Section.Wrapper=new e,Sm.loaded.add("Entities_Section_Wrapper")},"Entities_Section_Wrapper")}),define("Sm-Entities-Section-Wrapper",function(){}),require(["require"],function(e){Sm.loaded.when_loaded("Core_SmView",function(){Sm.Entities.Section.View=Sm.Core.SmView.extend({relationship_index_obj:{collections:!1,children:"child_holder",composition:"composition",micros:!1,pivots:"pivot_holder"},type:"Section",identifier:".spwashi-section",setElement:function(e){return e&&(e=e[0]||e),e&&e.addEventListener?Sm.Core.SmView.prototype.setElement.apply(this,arguments):!1},_rendering_callbacks:{button_control_element:function(){if(this.elements.button_control)return this.elements.button_control;var e=this.get_rendered("$Element").children(".button-control");return this.elements.button_control=e[0]?e[0]:!1},title_element:function(){if(this.elements.title)return this.elements.title;var e=this.get_rendered("$Element").children(".title");return this.elements.title=e[0]?e[0]:!1},subtitle_element:function(){if(this.elements.subtitle)return this.elements.subtitle;var e=this.get_rendered("$Element").children(".subtitle");return this.elements.subtitle=e[0]?e[0]:!1},content_element:function(){if(this.elements.content)return this.elements.content;var e=this.get_rendered("$Element").children(".content");return this.elements.content=e[0]?e[0]:!1},description_element:function(){if(this.elements.description)return this.elements.description;var e=this.get_rendered("$Element").children(".description");return this.elements.description=e[0]?e[0]:!1},content_location_element:function(){if(this.elements.content_location)return this.elements.content_location;var e=this.get_rendered("$Element").children(".content_location");return this.elements.content_location=e[0]?e[0]:!1},child_holder_element:function(){if(this.elements.child_holder)return this.elements.child_holder;var e,t=this.get_rendered("$Element").children(".children-container");if(t[0])return this.elements.child_holder=t[0];if(e=this.get_rendered("content_element")){var i=document.createElement("div");return i.className="children-container",Sm.Core.util.insertAfter(i,e),this.elements.child_holder=i,this.elements.child_holder}return!1},pivot_holder_element:function(){if(this.elements.pivot_holder)return this.elements.pivot_holder;var e=this.find_closest_relationship(),t=(e.Relationship,e.el),i=$(t),n=!1;return i.hasClass("definition-relationship")&&(i.addClass("pivot-container"),n=t),this.elements.pivot_holder=n,this.elements.pivot_holder},composition_element:function(){if(this.elements.composition_holder)return this.elements.composition_holder;var e,t=this.get_rendered("$Element").children(".composition-container");if(t[0])return this.elements.composition_holder=t[0];if(e=this.get_rendered("content_element")){var i=document.createElement("div");return i.className="composition-container",Sm.Core.util.insertAfter(i,e),this.elements.composition_holder=i,this.elements.composition_holder}return!1},focus_element:function(){if(this.elements.focus)return this.elements.focus;var e=this.$el.children(".focus");if(!e.length){var t=document.createElement("div");t.className="focus upper";var i=this.el;if(!i)return!1;var n=i.childNodes[0];return n?(i.insertBefore(t,n),this.elements.focus=t):!1}return this.elements.focus=e[0]}},initialize:function(e){this._touch_data={start:{x:0,y:0,time:0},threshold:150,allowed_time:200},this.what_we_on="home",Sm.Core.SmView.prototype.initialize.apply(this,arguments)},update:function(e){if(this.display_type.indexOf("modal")>-1)return this;var t=["section_type","content_location"];Sm.CONFIG.DEBUG&&console.log(e);for(var i=0;i<t.length;i++){var n=t[i];if(e.indexOf(n)>-1)return this.mark_unrendered(),this.replaceOldElement(),this}return Sm.Core.SmView.prototype.update.apply(this,arguments)},handle:!0,handle_click:function(e,t){var i=$(e);if(!this.MvCombo)return!1;var n=this,o=this.find_closest_relationship(),r=o.Relationship,s=o.el;if(i.closest(".pan")[0])i.hasClass("left")?this.scale(!0):i.hasClass("right")&&this.scale(!1);else if(this.queryPermission("edit")&&i.hasClass("edit")&&i.hasClass("button")){var a={};r&&(a.display_type="inline"),this.prompt_edit(a)}else if(i.hasClass("debug")&&i.hasClass("button")&&Sm.CONFIG.DEBUG)Sm.CONFIG.DEBUG&&console.log(this.cid," -- ",this.MvCombo,this.MvCombo.Identity.r_id,this.MvCombo.Model.attributes);else if(this.queryPermission("destroy")&&i.hasClass("delete")&&i.hasClass("button"))r?r.destroy({silent:!1}).then(function(){r.linked_entities&&(n.destroy(),s&&s.parentNode.removeChild(s),"Section"==r.linked_entities[0]&&"Section"==r.linked_entities[1]||"Dictionary"==r.linked_entities[0]||"Dictionary"==r.linked_entities[1])}):this.MvCombo.destroy({prompt:!0},this);else if(this.queryPermission("relate")&&i.hasClass("add")&&i.hasClass("button"))this.begin_add_relationship({type:"Section"});else if(t.ctrlKey)this.MvCombo.queryStatus("selected")?this.MvCombo.deselect(this):this.MvCombo.select(this);else{var l=!1;if(r&&null!==r&&void 0!==r?l="Dictionary"==r.linked_entities[0]||"Dictionary"==r.linked_entities[1]:r=!1,null!==r&&r&&l){Sm.CONFIG.DEBUG&&console.log("is_dictionary");var c=this.MvCombo.Model.get("content_location");c&&c.length&&Sm.Core.util.follow_link(c,!1)}this.MvCombo.focus(this)}},init_button_control_events:function(){var e=this.el,t=this.type,i=Sm.Entities[t],n=$(e);if(!n[0])return!1;var o,r=$(this.get_rendered("button_control")),s=this,a="0",l="home",c=!1;this.PivotViewAid=null;var d={};r.on({mouseenter:function(e){if(e.stopPropagation(),s.PivotViewAid&&s.PivotViewAid.status.is_open&&(c=!0),c)return!0;var t=Sm.Core.MvWrapper.get_effective_MV(s.MvCombo.r_id,!0,!0)||{},n=t.MVs||!1;"string"==typeof t.replacement_indices&&"pivots"!=t.replacement_indices&&(n=!1);var u=!1;l=s.what_we_on,n?(n=Sm.Core.MvWrapper.convert_to_MvCombo(n)[0],u=!0):(l="home",n=s.MvCombo),c=!0;var p=$(this),h=!1,f=n.get_relationship_subtypes(l,a)||{};for(var m in f)if(f.hasOwnProperty(m)){var _=f[m].length;d[m]!=_&&(h=!0,d[m]=_)}var v=i.Garage.generate({outer_string_name:"pivot_display",synchronous:!0,data:f});o=o?o:$($(v)[0]);var g=f.max||1,y=o.find(".relationship-subtype"),b=$(y[0]);if(b[0]){var S=75,C=o.find(".relationship-subtype-category");if(C[0]){var w=$(C[0]),E=S*g;w.width(E)}}s.PivotViewAid&&h&&delete s.PivotViewAid,s.PivotViewAid||(s.PivotViewAid=new Sm.Extras.ViewAid({element:o[0],events:{pivot:function(e,t,i,o){var r=s;u&&"home"!==i?(r=n.getView({
reference_element:s.referenceElement,strict:!0}),Sm.CONFIG.DEBUG&&console.log("-------------------"),r?r.pivot(i,!1,a):Sm.CONFIG.DEBUG&&console.log(n)):("home"==i&&(i=["home",l]),s.pivot(i,!1,a))},open:function(){if(f.max){var e=$(window).width()-(p.offset().left+p.outerWidth());200>e&&o.addClass("left"),r.append(o)}}}})),s.PivotViewAid.open()},mouseleave:function(){c=!1,o&&setTimeout(function(){!c&&s.PivotViewAid.status.is_open&&s.PivotViewAid.close()},250)}})},remove:function(){return this.PivotViewAid&&this.PivotViewAid.status.is_open&&this.PivotViewAid.close(),Sm.Core.SmView.prototype.remove.apply(this,arguments)},scale:function(e,t){var i=this,n=this.MvCombo;return n.scale(e,t||0).then(function(t){Sm.Core.SmView.replace_with_elements({items:t.items||[],referenceElement:i.referenceElement,replacement_MVs:t.replacement_MVs||[],replaced_MVs:t.replaced_MVs||[],replacement_relationships:t.replacement_relationships||[],replaced_relationships:t.replaced_relationships||[]})["catch"](function(t){Sm.CONFIG.DEBUG&&console.log(t);var n=e?"can-pan-left":"can-pan-right";i.get_rendered("focus_element")&&$(i.get_rendered("focus_element")).removeClass(n).removeClass("maybe-"+n)})})},pivot:function(e,t,i){i=i||0;var n=this;return this.MvCombo.pivot(e,i||0).then(function(t){Sm.Core.SmView.replace_with_elements({referenceElement:n.referenceElement,items:t.items||{},replacement_MVs:t.replacement_MVs||[],replaced_MVs:t.replaced_MVs||[],replacement_relationships:t.replacement_relationships||[],replaced_relationships:t.replaced_relationships||[],name:"pivots."+e,forEachView:function(){this.what_we_on=e}})["catch"](function(e){Sm.CONFIG.DEBUG&&console.log(e)})})},additional_events:{touchstart:function(e){var t=e.changedTouches||e.originalEvent.changedTouches,i=t[0];this._touch_data.start.x=i.pageX,this._touch_data.start.y=i.pageY,this._touch_data.start.time=(new Date).getTime(),e.preventDefault()},touchend:function(e){var t=e.changedTouches||e.originalEvent.changedTouches,i=t[0],n=i.pageX-this._touch_data.start.x,o=(new Date).getTime()-this._touch_data.start.time;if(o<=this._touch_data.allowed_time&&Math.abs(i.pageY-this._touch_data.start.y)<=100&&Math.abs(n)>=this._touch_data.threshold){var r=!0;0>n&&(r=!1),this.scale(!!r)}else this.MvCombo&&(e.stopPropagation(),this.handle_click(e.target,e));this._touch_data.start={x:0,y:0,time:0},e.preventDefault(),e.stopPropagation()},click:function(e){var t=e.which&&3==e.which||e.button&&2==e.button;t&&Sm.CONFIG.DEBUG&&console.log(this),this.MvCombo&&(this.handle_click(e.target,e),e.stopPropagation())}},renderDragMirror:function(e){var t=this.MvCombo;if(!t)return!1;var i=e.cloneNode(!0),n=document.createElement("div");return n.style.position="absolute",n.appendChild(i),n.className="sm-mirror",n.style.cursor="grabbing",n},blur:function(){return this.queryStatus("focused")?(this.add_bound&&document.removeEventListener("click",this.add_bound("blur",this.MvCombo.blur.bind(this.MvCombo,{},this))),document.removeEventListener("keydown",this.get_bound("scale_handler")),Sm.Core.SmView.prototype.blur.apply(this,arguments)):this},focus:function(){if(this.queryStatus("focused"))return this;var e=this,t=function(t){if(!e.queryStatus("focused"))return Sm.CONFIG.DEBUG&&console.log("View is not focused, will not scale"),!1;var i=t.which;37==i?(e.scale(!0)["catch"](function(e){Sm.CONFIG.DEBUG&&console.log(e)}),t.stopPropagation()):39==i&&(e.scale(!1)["catch"](function(e){Sm.CONFIG.DEBUG&&console.log(e)}),t.stopPropagation())};this.add_bound&&document.addEventListener("click",this.add_bound("blur",this.MvCombo.blur.bind(this.MvCombo,{},this))),document.addEventListener("keydown",this.add_bound("scale_handler",t));var i=this.$el.children(".focus");if(i[0]){var n=0,o=this.MvCombo,r=o.relationships.micros,s=o.reciprocal_relationships.micros,a=r&&r.has_relationships_in_context(n),l=s&&s.has_relationships_in_context(n);a?i.addClass("can-pan-left"):0===a?i.addClass("maybe-can-pan-left"):i.removeClass("maybe-can-pan-left").removeClass("can-pan-left"),l?i.addClass("can-pan-right"):0===l?i.addClass("maybe-can-pan-right"):i.removeClass("maybe-can-pan-right").removeClass("can-pan-right")}return Sm.Core.SmView.prototype.focus.apply(this,arguments)},undelegateEvents:function(){Sm.Core.SmView.prototype.undelegateEvents.apply(this,arguments)},wrap_element_for_relationship:function(e,t,i,n){var o=n||"<div></div>";if(i.linked_entities&&"Dictionary"in i.linked_entities){o=o.replace("__R_ID__",i.Identity.r_id);var r=$(o);if(r[0])return r[0].appendChild(OtherView.get_rendered("Element")),r[0]}return e.get_rendered("Element")}}),Sm.loaded.add("Entities_Section_View")},"Entities_Section_View")}),define("Sm-Entities-Section-View",function(){}),require(["require","Sm-Core-Meta"],function(e){var t=Sm.Core.Meta.base_constructor.extend({relationship_type_obj:{children:{MvType:"Section",index_singular:"child",id:1,primary_key:"primary_section_id",secondary_key:"secondary_section_id",is_only_reciprocal:!1,linked_entities:["Section","Section"]},composition:{MvType:"Section",index_singular:"composition",id:2,primary_key:"primary_section_id",secondary_key:"secondary_section_id",is_only_reciprocal:!1,linked_entities:["Section","Section"]},micros:{MvType:"Section",index_singular:"micro",id:4,primary_key:"primary_section_id",secondary_key:"secondary_section_id",is_only_reciprocal:!1,linked_entities:["Section","Section"]},pivots:{MvType:"Section",index_singular:"pivot",id:5,primary_key:"primary_section_id",secondary_key:"secondary_section_id",is_only_reciprocal:!1,linked_entities:["Section","Section"]},pages:{MvType:"Page",index_singular:"page",primary_key:"section_id",secondary_key:"page_id",is_only_reciprocal:!1,linked_entities:["Section","Page"]},collections:{MvType:"Collection",index_singular:"collection",primary_key:"section_id",secondary_key:"collection_id",is_only_reciprocal:!1,linked_entities:["Section","Collection"]},dictionaries:{MvType:"Dictionary",index_singular:"dictionary",primary_key:"section_id",secondary_key:"dictionary_id",is_only_reciprocal:!1,linked_entities:["Section","Dictionary"]},dimensions:{MvType:"Dimension",index_singular:"dimension",primary_key:"section_id",secondary_key:"dimension_id",is_only_reciprocal:!1,linked_entities:["Section","Dimension"]},definitions:{MvType:"Dictionary",index_singular:"definition",secondary_key:"dictionary_id",primary_key:"section_id",is_only_reciprocal:!0,linked_entities:["Section","Dictionary"]},sections:{MvType:"Collection|Dimension|Concept",index_singular:"collection|dimension|concept",primary_key:"collection_id|dimension_id|concept_id",secondary_key:"section_id",is_reciprocal:!0,linked_entities:["Section","Collection|Dimension|Concept"]},concepts:{MvType:"Concept",index:"concept",id:null,primary_key:"section_id",secondary_key:"concept_id",is_reciprocal:!1,linked_entities:["Section","Concept"]}},types:{standard:1,image:2,video:3,audio:4,definition:5,table:6,list:7,mirror:8},get_possible_relationship_indices:function(e){if(!e)return[null];e=e||{};var t=e.OtherMvCombo,i=(t?t.type:e.type)||!1,n=!!e.is_reciprocal;return"Dictionary"==i&&n?[null,"definitions"]:"Section"==i?["children","composition","micros","pivots"]:"Page"==i?["pages"]:"Collection"==i?["collections"]:"Dimension"==i?["dimensions"]:"Concept"==i?["concepts"]:"Dictionary"==i?["dictionaries"]:[]}});try{Sm.Entities.Section.Meta=new t({type:"Section"}),Sm.Entities.Section.Meta.base_constructor=t;var i="Section";Sm.loaded.add("Entities_"+i+"_Meta")}catch(n){Sm.CONFIG.DEBUG&&console.log(n)}}),define("Sm-Entities-Section-Meta",function(){}),require(["require","Emitter","Sm"],function(e,t){e("Sm"),e(["require","Sm/Extras/ViewAid"],function(){}),Sm.loaded.when_loaded("Core_RelationshipIndex",function(){Sm.Entities.Section.RelationshipAbstraction.pivots_RelationshipIndex=Sm.Core.RelationshipIndex.extend({relationship_subtype_map:{},init:function(e){return this.relationship_subtype_map={},Sm.Core.RelationshipIndex.prototype.init.apply(this,arguments)},get_listed_subtype_items:function(e,t){var i=this.relationship_subtype_map[t];if(!i||!i[e])return!1;var n=i[e],o={relationships:[],items:[]};for(var r in n)if(n.hasOwnProperty(r)){var s=n[r],a=Sm.Core.Identifier.retrieve(r);a&&(a=a.getResource(),o.items.push(a),o.relationships.push(s))}return o},sort_incoming:function(e,t,i){i=i||0;var n;if(n=e.map.relationship_subtype){if(n=Sm.Entities.Section.Meta.get_relationship_type({sub:!0,type:"index"},n),!n)return;this.relationship_subtype_map[i]=this.relationship_subtype_map[i]||{},this.relationship_subtype_map[i][n]=this.relationship_subtype_map[i][n]||{},this.relationship_subtype_map[i][n][t]=e}},remove_item:function(e,t,i){t=t||0;var n=this.relationship_subtype_map[t]&&Sm.Core.RelationshipIndex.prototype.remove_item.apply(this,arguments);if(!n)return!1;var o=this.relationship_subtype_map[t];"object"==typeof e&&(e.setMap?e=this.r_id_map[e.Identity.r_id]:e.r_id&&(e=e.r_id));for(var r in o)if(o.hasOwnProperty(r)&&o[r][e]){var s=o[r];delete s[e];var a=!1;for(var l in s)if(a=s.hasOwnProperty(l))break;a||delete o[r]}}}),Sm.loaded.add("Entities_Section_RelationshipAbstraction_pivots_RelationshipIndex")},"Entities_Section_RelationshipAbstraction_pivots_RelationshipIndex")}),define("Sm-Entities-Section-RelationshipAbstraction-pivots_RelationshipIndex",function(){}),require(["require","Sm-Core-SmModel"],function(e){e("Sm-Core-SmModel"),Sm.Entities.Collection.Model=Sm.Core.SmModel.extend({defaults:{id:null,user_id:null,collection_type:null,title:null,description:null,ent_id:null,update_dt:null,creation_dt:null}}),Sm.Entities.Collection.Model.prototype.type="Collection",Sm.loaded.add("Entities_Collection_Model")}),define("Sm-Entities-Collection-Model",function(){}),require(["require","Sm","Sm-Entities-Collection-Model","Sm-Core-MvCombo"],function(e){Sm.loaded.when_loaded("Core_MvCombo",function(){Sm.Entities.Collection.MvCombo=Sm.Core.MvCombo.extend({}),Sm.loaded.add("Entities_Collection_MvCombo")},"Entities_Collection_MvCombo")}),define("Sm-Entities-Collection-MvCombo",function(){}),require(["require","Sm-Entities-Collection-main","Sm-Core-MvWrapper"],function(e){Sm.loaded.when_loaded("Core_MvWrapper",function(){var e=Sm.Core.MvWrapper.extend({type:"Collection",parentType:null,populate_container:function(e){}});Sm.Entities.Collection.Wrapper=new e,Sm.loaded.add("Entities_Collection_Wrapper")},"Entities_Collection_Wrapper")}),define("Sm-Entities-Collection-Wrapper",function(){}),require(["require","Sm-Core-SmView","Sm-Entities-Abstraction-mixins-SidebarModule"],function(e){e(),Sm.loaded.when_loaded(["Core_SmView","Sm_Entities_Abstraction_mixins_SidebarModule"],function(){Sm.Entities.Collection.View=Sm.Core.SmView.extend({type:"Collection",mixins:[Sm.Entities.Abstraction.mixins.SidebarModule],identifier:".spwashi-collection",additional_events:{click:function(e){var t=e.target,i=$(t);this.MvCombo;i.hasClass("spwashi-collection")&&(this.MvCombo.queryStatus("focused")?this.MvCombo.blur(this):this.MvCombo.focus(this),e.stopPropagation())}}}),Sm.loaded.add("Entities_Collection_View")},"Entities_Collection_View")}),define("Sm-Entities-Collection-View",function(){}),require(["require","Sm-Core-Meta"],function(e){var t=Sm.Core.Meta.base_constructor.extend({relationship_type_obj:{sections:{MvType:"Section",index_singular:"section",id:null,primary_key:"collection_id",secondary_key:"section_id",is_only_reciprocal:!1,linked_entities:["Collection","Section"]},collections:{MvType:"Section",index_singular:"section",id:null,primary_key:"section_id",secondary_key:"collection_id",is_only_reciprocal:!0,linked_entities:["Collection","Section"]}},get_possible_relationship_indices:function(e){if(!e)return[];e=e||{};var t=e.OtherMvCombo,i=(t?t.type:e.type)||!1;return"Section"==i?["sections"]:[]}});Sm.Entities.Collection.Meta=new t({type:"Collection"}),Sm.Entities.Collection.Meta.base_constructor=t;var i="Collection";Sm.loaded.add("Entities_"+i+"_Meta")}),define("Sm-Entities-Collection-Meta",function(){}),require(["require","Sm-Entities-Collection-main"],function(e){Sm.Entities.Collection.templates._template={outer:{full:"",preview:'<div class="spwashi-collection preview" data-ent_id="<%- ent_id %>" data-id="<%- id %>" data-title=\'<%- title %>\'>\n    __BUTTON_CONTROL__\n    __CONTENT__\n</div>',inline:"",tab:"",tag:""},modal_outer:{full:'<header>\n    <h3>Edit Section</h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" class="section-type" value="<%- section_type%>">\n    <input type="hidden" value="<%- id %>" name="id">\n\n    __CONTENT__\n\n    <div class="control-group">\n        <label for="has_title">Display Title: </label>\n        <input class="model edit has_title" data-attribute="has_title" type="checkbox" id="has_title" name="has_title" value="1" <% if(has_title == 1) {%>checked<% } %>>\n    </div>\n    <div class="control-group">\n        <label for="section_type">Section Type: </label>\n        <select class="model edit section_type select" data-attribute="section_type" id="section_type" name="section_type">\n            <option value="1"\n            <% if(section_type == 1){%>selected<% } %>>Standard</option>\n            <option value="2"\n            <% if(section_type == 2){%>selected<% } %>>Image</option>\n            <option value="3"\n            <% if(section_type == 3){%>selected<% } %>>Video</option>\n            <option value="4"\n            <% if(section_type == 4){%>selected<% } %>>Audio</option>\n            <option value="5"\n            <% if(section_type == 5){%>selected<% } %>>Definition</option>\n            <option value="6"\n            <% if(section_type == 6){%>selected<% } %>>Table</option>\n            <option value="7"\n            <% if(section_type == 7){%>selected<% } %>>List</option>\n            <option value="8"\n            <% if(section_type == 8){%>selected<% } %>>Embedded Content</option>\n        </select>\n    </div>\n    <div class="control-group view_relationship-container" >\n        <button class="action modal-button" data-action="view_relationships">View Relationships</button>\n    </div>\n</div>'},relationship_index_container:'<section class="relationship-index-container">__CONTENT__</section>',relationship_container:'<div class="relationship-container __TYPE__-container" data-Mv-r_id="__R_ID__">\n    <header class="title">__TITLE__</header>\n    <div class="content">__CONTENT__</div>\n</div>',relationship_outer:'<div class="relationship" data-Relationship-r_id="__R_ID__">\n    <div class="add-to-list">\n        <input type="checkbox" title="Add entity">\n    </div>\n    <div class="content">__CONTENT__</div>\n</div>',button_control:{full:'<div class="icons button-control">\n    <i class="button edit fa fa-pencil"></i>\n    <i class="button delete close fa fa-remove"></i>\n    <i class="button add fa fa-plus"></i>\n    <i class="button handle fa fa-arrows"></i>\n    <i class="debug button fa fa-question"></i>\n</div>'}},Sm.loaded.add("Entities_Collection_templates__template")}),define("Sm-Entities-Collection-templates-_template",function(){}),require(["require","Sm-Entities-Collection-main"],function(e){Sm.Entities.Collection.templates.standard={body:{full:'<div class="description" ><%- description %></div>',preview:'<div class="description" ><%- description %></div>',inline:'<div class="description" ><%- description %></div>',tab:'<div class="description" ><%- description %></div>',tag:'<div class="description" ><%- description %></div>'},cache:{}},Sm.loaded.add("Entities_Collection_templates_standard")}),define("Sm-Entities-Collection-templates-standard",function(){}),require(["require","Sm","Sm-Entities-Collection-templates-_template","Sm-Entities-Collection-templates-standard"],function(e){e("Sm"),e("Sm-Entities-Collection-templates-_template"),e("Sm-Entities-Collection-templates-standard"),Sm.loaded.when_loaded(["Entities_Abstraction_Garage","Entities_Collection_Meta","Entities_Collection_templates__template","Entities_Collection_templates_standard"],function(){var e=Sm.Entities.Abstraction.Garage.extend({});Sm.Entities.Collection.Garage=new e("Collection","collection_type"),Sm.loaded.add("Entities_Collection_Garage")},"Entities_Collection_Garage")}),define("Sm-Entities-Collection-Garage",function(){}),require(["require","Sm-Core-SmModel"],function(e){e("Sm-Core-SmModel"),Sm.Entities.Dictionary.Model=Sm.Core.SmModel.extend({defaults:{title:"-",description:"-",ent_id:null,id:null}}),Sm.Entities.Dictionary.Model.prototype.type="Dictionary",Sm.loaded.add("Entities_Dictionary_Model")}),define("Sm-Entities-Dictionary-Model",function(){}),require(["require","Sm","Sm-Entities-Dictionary-Model","Sm-Core-MvCombo"],function(e){Sm.loaded.when_loaded("Core_MvCombo",function(){Sm.Entities.Dictionary.MvCombo=Sm.Core.MvCombo.extend({words:{},check_words:function(e,t){e||(e=""),e="object"==typeof e&&e.constructor===Array?e.slice(0):e.split(",");for(var i=[],n=[],o=0;o<e.length;o++){var r=e[o]=e[o].toLowerCase().trim();r.length&&(this.words[r]?t&&-1===this.words[r].indexOf(t)&&n.push(r):n.push(r))}if(t)if(this.definition_word_map[t])for(var s=0;s<this.definition_word_map[t].length;s++){var a=this.definition_word_map[t][s];e.indexOf(a)<0&&i.push(a)}else this.definition_word_map[t]=[];return{nonexistent_words:n,since_deleted_words:i}},add_definition:function(e){for(var t=e.Model,i=t.get_words(),n=this.check_words(i,e.Identity.r_id),o=n.nonexistent_words,r=n.since_deleted_words,s=0;s<o.length;s++){var a=o[s];Sm.CONFIG.DEBUG&&console.log(a),this.add_word(a,e)}for(var l=0;l<r.length;l++){var c=r[l];this.remove_word(c,e)}},add_word:function(e,t){if(e.length&&(e=e.toLowerCase().trim(),e.length)){this.words[e]=this.words[e]||[];var i=t.Identity.r_id;if(this.words[e].indexOf(i)<0){this.words[e].push(i);var n=this.definition_word_map[i]=this.definition_word_map[i]||[];n.indexOf(e)<0&&n.push(e)}Sm.Entities.Dictionary.Wrapper.add_word(e,this)}},remove_word:function(e,t){if(!e||"string"!=typeof e||!e.length)return!1;if(e=e.toLowerCase().trim(),!e.length)return!1;if(!(e in this.words))return!1;var i=this.words[e];i.length&&t&&t.Identity?i.indexOf(t.Identity.r_id)>-1&&i.splice(i.indexOf(t.Identity.r_id),1):(delete this.words[e],Sm.Entities.Dictionary.Wrapper.remove_word(e,this))},init:function(){Sm.Core.MvCombo.prototype.init.apply(this,arguments),this.words={},this.definition_word_map={},this.on("add_relationship",function(e){e=e||{};var t=e.SelfMvCombo,i=e.OtherMvCombo;e.Relationship,e.RelationshipIndex,e.OtherView,e.map_indices;if("Section"==i.type&&i.Model){var n=i.Model.get("words")||"";if(n.length)for(var o=n.split(","),r=0;r<o.length;r++){var s=o[r];t.add_word(s,i)}}})},_build_other_MV:function(e,t){return t.model_properties=t.model_properties||{},"Section"==e.type&&(t.model_properties.section_type=Sm.Entities.Section.Meta.types.definition,t.prompt=!0),e.build_MV(t)},define_word:function(e,t){t=!!t,e=(t?e:e.toLowerCase()).trim();var i=this.words[e],n=[],o=[];if(i)for(var r=0;r<i.length;r++){var s=i[r],a=Sm.Core.Identifier.retrieve(s).getResource(),l=this.getRelationship(s);l&&a&&(n.push(l),o.push(a))}return{items:o,relationships:n}}}),Sm.loaded.add("Entities_Dictionary_MvCombo")},"Entities_Dictionary_MvCombo")}),define("Sm-Entities-Dictionary-MvCombo",function(){}),require(["require","Sm-Entities-Dictionary-main","Sm-Core-MvWrapper"],function(e){Sm.loaded.when_loaded("Core_MvWrapper",function(){var e=Sm.Core.MvWrapper.extend({type:"Dictionary",parentType:null,highlighted_words:{},words:{},add_word:function(e,t){e=e.toLowerCase().trim(),this.words[e]=this.words[e]||[];var i=t.Identity.r_id;this.words[e].length||this.highlight_word(e,{element:document.getElementById("main")}),this.words[e].indexOf(i)<0&&this.words[e].push(i)},remove_word:function(e,t){if(e=e.toLowerCase().trim(),!(e in this.words))return!1;var i=this.words[e];e.length&&t&&t.Identity?i.splice(i.indexOf(t.Identity.r_id),1):(delete this.words[e],this.unhighlight_word(e,{element:document.getElementById("main")}))},init_tooltips:function(e){var t=$(e),i=Sm.Entities.Dictionary.Garage,n=Sm.Entities.Dictionary.templates;return i&&n?void t.find(".sm-highlight").each(function(){var e=$(this);e.tooltipster({content:"Loading",interactive:!0,animation:"grow",speed:0,debug:!1,touchDevices:!1,trigger:"click",functionBefore:function(e,t){Sm.CONFIG.DEBUG&&console.log("attempt"),e.parent().hasClass("tooltipstered")&&e.parent().tooltipster("hide");var i=Sm.Entities.Dictionary.Wrapper.MvMaps.active_MVs;if(i){var n=[];for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];r&&n.push(r.getResource())}n.length&&(t(),Sm.Entities.Dictionary.Garage.definition_tooltip(n,!1,{word:e.data("word"),title:e.text()}).then(function(t){e.tooltipster("content",$(t))}))}}})}):!1},unhighlight_word:function(e,t){if(t=t||{},"object"==typeof e&&e.constructor===Array)for(var i=0;i<e.length;i++){var n=e[i];this.unhighlight_word(n)}else{if(!e||!e.length)var o=t.element||document.body;Sm.CONFIG.DEBUG&&console.log(e),this.highlighted_words=this.highlighted_words||{},this.highlighted_words[e]=!1,Sm.Extras.Highlight.un_highlight({word:e,element:o})}},highlight_word:function(e,t){if(t=t||{},e+""=="[object Array]")for(var i=0;i<e.length;i++){var n=e[i];this.highlight_word(n)}else{var o=t.element||document.body;this.highlighted_words[e]=!0,Sm.Extras.Highlight.highlight({word:e,element:o}),this.init_tooltips(o)}},change_word_highlight_status:function(e,t,i){if(t=t.trim().toLowerCase(),e=!!e,!t||!i||!t.trim().length)return!1;var n=i.Identity.r_id,o=this.highlighted_words[t]=this.highlighted_words[t]||[];if(e)return o.indexOf(n)<0&&o.push(n),!0;var r;return o&&(r=o.indexOf(n))>-1?(o.splice(r,1),!0):!1}});Sm.Entities.Dictionary.Wrapper=new e,Sm.loaded.add("Entities_Dictionary_Wrapper")},"Entities_Dictionary_Wrapper")}),define("Sm-Entities-Dictionary-Wrapper",function(){}),require(["require","Sm-Core-SmView","Sm-Entities-Abstraction-mixins-SidebarModule"],function(e){e("Sm-Core-SmView"),e("Sm-Entities-Abstraction-mixins-SidebarModule"),Sm.loaded.when_loaded(["Core","Sm_Entities_Abstraction_mixins_SidebarModule"],function(){Sm.Entities.Dictionary.View=Sm.Core.SmView.extend({type:"Dictionary",mixins:[Sm.Entities.Abstraction.mixins.SidebarModule],identifier:".spwashi-dictionary",additional_events:{click:function(e){var t=e.target,i=$(t),n=this.MvCombo;"INPUT"==t.tagName&&"checkbox"==t.type?!n.queryStatus("active")&&t.checked?(Sm.CONFIG.DEBUG&&console.log("activate"),n.activate(this),Sm.CONFIG.DEBUG&&console.log(n.words)):n.deactivate(this):i.hasClass("spwashi-dictionary")&&(this.MvCombo.queryStatus("focused")?this.MvCombo.blur(this):this.MvCombo.focus(this),e.stopPropagation()),this.queryPermission("edit")&&i.hasClass("edit")&&i.hasClass("button")&&this.prompt_edit()}},relationship_index_obj:{definitions:"definitions_container"},_rendering_callbacks:{definitions_container_element:function(){if(this.elements.definitions_container)return this.elements.definitions_container;var e,t=this.get_rendered("$Element").find(".definitions-container");if(t[0])return this.elements.definitions_container=t[0];if(e=this.get_rendered("description")){var i=document.createElement("div");return i.className="definitions-container",Sm.Core.util.insertAfter(i,e),this.elements.definitions_container=i,this.elements.definitions_container}return!1}},wrap_element_for_relationship:function(e,t,i){if("definitions"==t){var n=e.MvCombo,o=Sm.Entities.Dictionary.templates._template.definition_relationship_outer;o=o.replace("__MV_R_ID__",n.Identity.r_id).replace("__R_ID__",i.Identity.r_id).replace("__CONTENT__","").replace("__TITLE__",n.Model.get("title")||"_");var r=$(o);if(r[0]){var s=r.find(".content");if(s[0])return s[0].appendChild(e.get_rendered("Element")),r[0]}}return e.get_rendered("Element")},handle:void 0}),Sm.loaded.add("Entities_Dictionary_View")},"Entities_Dictionary_View")}),define("Sm-Entities-Dictionary-View",function(){}),require(["require","Sm-Core-Meta"],function(e){var t=Sm.Core.Meta.base_constructor.extend({relationship_type_obj:{definitions:{MvType:"Section",index_singular:"definition",id:null,primary_key:"dictionary_id",secondary_key:"section_id",is_only_reciprocal:!1,linked_entities:["Dictionary","Section"]},dictionaries:{MvType:"Page|Section",index_singular:"page|section",id:null,primary_key:"page_id|section_id",secondary_key:"dictionary_id",is_only_reciprocal:!0,linked_entities:["Section|Page","Dictionary"]}},relationship_aliases:{sections:"definitions"},get_possible_relationship_indices:function(e){if(!e)return[];e=e||{};var t=e.OtherMvCombo,i=(t?t.type:e.type)||!1,n=!!e.is_reciprocal;return n?[null,"dictionaries"]:"Section"==i?["definitions"]:"Page"==i?["pages"]:[]}});Sm.Entities.Dictionary.Meta=new t({type:"Dictionary"}),Sm.Entities.Dictionary.Meta.base_constructor=t;var i="Dictionary";Sm.loaded.add("Entities_"+i+"_Meta")}),define("Sm-Entities-Dictionary-Meta",function(){}),require(["require","Sm-Entities-Dictionary-main"],function(e){Sm.Entities.Dictionary.templates._template={outer:{full:'<div class="spwashi-dictionary preview" data-ent_id="<%- ent_id %>" data-id="<%- id %>" data-title=\'<%- title %>\'>\n    __BUTTON_CONTROL__\n    __CONTENT__\n</div>',preview:'<div class="spwashi-dictionary preview" data-ent_id="<%- ent_id %>" data-id="<%- id %>" data-title=\'<%- title %>\'>\n    __BUTTON_CONTROL__\n    __CONTENT__\n</div>',inline:"",tab:"",tag:""},modal_outer:{full:'<header>\n    <h3>Edit Dictionary</h3>\n</header>\n<div class="content form aligned">\n    __BUTTON_CONTROL__\n    <input type="hidden" value="<%- id %>" name="id">\n    __CONTENT__\n    <div class="control-group view_relationship-container">\n        <button class="action modal-button" data-action="view_relationships">View Relationships</button>\n    </div>\n</div>'},relationship_index_container:'<section class="relationship-index-container">\n    <button class="action modal-button" data-action="add_entity" data-data=\'Section\' id="add-new-definition">Add New Definition</button>\n    __CONTENT__\n</section>',relationship_container:'<div class="relationship-container __TYPE__-container" data-Mv-r_id="__R_ID__">\n    <header class="title">\n        <h2>__TITLE__</h2>\n    </header>\n    <div class="content">__CONTENT__</div>\n</div>',additional_definition_container:'<div class="definition-container" data-Relationship-r_id="__R_ID__"></div>',relationship_outer:'<div class="relationship" data-Relationship-r_id="__R_ID__" data-Mv-r_id="__MV_R_ID__">\n    <div class="add-to-list">\n        <input type="checkbox" title="Add entity">\n    </div>\n    <div class="content">__CONTENT__</div>\n</div>',definition_relationship_outer:'<div class="relationship definition-relationship" data-Mv-r_id="__MV_R_ID__" data-Relationship-r_id="__R_ID__">\n    <div class="add-to-list">\n        <input type="checkbox" title="Add entity" >\n    </div>\n    <header class="relationship-type-title">\n        <h3 class="title">__TITLE__</h3>\n    </header>\n    <div class="content">__CONTENT__</div>\n</div>',tooltip_outer:'<div class="tooltip relationship definition-relationship" data-Mv-r_id="__MV_R_ID__" data-Relationship-r_id="__R_ID__">\n    <header>\n        <h3 class="title">__TITLE__</h3>\n        <h3 class="subtitle">__SUBTITLE__</h3>\n    </header>\n    <div class="content">__CONTENT__</div>\n</div>',button_control:{full:'<div class="icons button-control">\n    <i class="button edit fa fa-pencil"></i>\n    <i class="button delete close fa fa-remove"></i>\n    <i class="button add fa fa-plus"></i>\n    <i class="button handle fa fa-arrows"></i>\n    <i class="debug button fa fa-question"></i>\n</div>'}},Sm.loaded.add("Entities_Dictionary_templates__template")}),define("Sm-Entities-Dictionary-templates-_template",function(){}),require(["require","Sm-Entities-Dictionary-main"],function(e){Sm.Entities.Dictionary.templates.standard={body:{full:'<div class="description" ><%- description %></div>',preview:'<div class="description" ><%- description %></div>',inline:'<div class="description" ><%- description %></div>',tab:'<div class="description" ><%- description %></div>',tag:'<div class="description" ><%- description %></div>'},modal:{full:'<div class="control-group">\n    <label for="title">Title:</label>\n    <input data-attribute="title" class="model edit title" type="text" name="title" placeholder="Dictionary Title" title="title" value="<%- title %>">\n    <span class="error" id="title-error"></span>\n</div>\n<div class="control-group">\n    <label for="description">Description: </label>\n    <textarea data-attribute="description" class="model edit description" name="description" placeholder="Dictionary Description"><%- description %></textarea>\n    <span class="error" id="description-error"></span>\n</div>'},cache:{}},Sm.loaded.add("Entities_Dictionary_templates_standard")}),define("Sm-Entities-Dictionary-templates-standard",function(){}),require(["require","Sm","Sm-Entities-Dictionary-templates-_template","Sm-Entities-Dictionary-templates-standard"],function(e){e("Sm"),e("Sm-Entities-Dictionary-templates-_template"),e("Sm-Entities-Dictionary-templates-standard"),Sm.loaded.when_loaded(["Entities_Abstraction_Garage","Entities_Dictionary_Meta","Entities_Dictionary_templates__template"],function(){var e=Sm.Entities.Abstraction.Garage.extend({relationships:function(e,t,i){return i=i||{},i.display_type="inline",i.always_display=["definitions"],Sm.Entities.Abstraction.Garage.prototype.relationships.apply(this,[e,t,i])},definition_tooltip:function(e,t,i){i=i||{};var n=i.word||!1,o=i.title||n,r=this,s={relationship_index_list:["definitions"],on_append:function(e,t,i){Sm.CONFIG.DEBUG&&console.log(t.queryPermission("view")),t.setPermission("focus",!1),t.mark_added()}},a=Sm.Entities.Dictionary.templates._template.tooltip_outer||"";a=a.replace("__CONTENT__","").replace("__TITLE__","").replace("__SUBTITLE__","");var l=$(a),c=l.find(".content");c=c[0]||!1;var d=function(e){return c&&c.appendChild(e),l[0]};if("[object Array]"===Object.prototype.toString.call(e)){!n&&e[0]&&e[0].Model&&(n=e[0].Model.get("title"));var u=l.find(".title");return u=u[0]||!1,u&&(u.innerHTML=o),e.reduce(function(e,t){return e.then(function(){var e=t.define_word(n);return s.listed_relationships_obj={definitions:e},r.relationships(t,!1,s).then(d)})},Promise.resolve())}return this.relationships(e,!1,s).then(d)}});Sm.Entities.Dictionary.Garage=new e("Dictionary","dictionary_type"),Sm.loaded.add("Entities_Dictionary_Garage")},"Entities_Dictionary_Garage")}),define("Sm-Entities-Dictionary-Garage",function(){}),require(["require","Sm-Core-SmModel"],function(e){e("Sm-Core-SmModel"),Sm.Entities.Dimension.Model=Sm.Core.SmModel.extend({defaults:{title:"-",description:"-",ent_id:null,id:null}}),Sm.Entities.Dimension.Model.prototype.type="Dimension",Sm.loaded.add("Entities_Dimension_Model")}),define("Sm-Entities-Dimension-Model",function(){}),require(["require","Sm","Sm-Entities-Dimension-Model","Sm-Core-MvCombo"],function(e){Sm.loaded.when_loaded("Core_MvCombo",function(){Sm.Entities.Dimension.MvCombo=Sm.Core.MvCombo.extend({}),Sm.loaded.add("Entities_Dimension_MvCombo")},"Entities_Dimension_MvCombo")}),define("Sm-Entities-Dimension-MvCombo",function(){}),require(["require","Sm-Entities-Dimension-main","Sm-Core-MvWrapper"],function(e){Sm.loaded.when_loaded("Core_MvWrapper",function(){var e=Sm.Core.MvWrapper.extend({type:"Dimension",parentType:null,populate_container:function(e){},get_active:function(){var e=this.MvMaps.active_MVs;for(var t in e)if(e.hasOwnProperty(t))return e[t].getResource()}});Sm.Entities.Dimension.Wrapper=new e,Sm.loaded.add("Entities_Dimension_Wrapper")},"Entities_Dimension_Wrapper")}),define("Sm-Entities-Dimension-Wrapper",function(){}),require(["require"],function(e){Sm.loaded.when_loaded("Core_SmView",function(){Sm.Entities.Dimension.View=Sm.Core.SmView.extend({type:"Dimension",identifier:".spwashi-dimension",relationship_index_obj:{sections:"section_holder"},initialize:function(e){this._touch_data={start:{x:0,y:0,time:0},threshold:150,allowed_time:200
};Sm.Core.SmView.prototype.initialize.apply(this,arguments),this.elements=Sm.Core.util.merge_objects({title:null,description:null,content:null,section_holder:null},this.elements)},_rendering_callbacks:{title_element:function(){if(this.elements.title)return this.elements.title;var e=Sm.Core.util.getChildElementsByClassName(this.el,"title");return e.length?this.elements.title=e[0]:!1},content_element:function(){if(this.elements.content)return this.elements.content;var e=Sm.Core.util.getChildElementsByClassName(this.el,"content");return e.length?this.elements.content=e[0]:!1},description_element:function(){if(this.elements.description)return this.elements.description;var e=Sm.Core.util.getChildElementsByClassName(this.el,"description");return e.length?this.elements.description=e[0]:!1},section_holder_element:function(){if(this.elements.section_holder)return this.elements.section_holder;if(!this.MvCombo||!this.MvCombo.Identity.ent_id||!this.MvCombo.Identity.ent_id.length)return!1;var e=$(".section-container[data-ent_id="+this.MvCombo.Identity.ent_id+"]");return e.length?(Sm.CONFIG.DEBUG&&console.log(e[0]),this.elements.section_holder=e[0]):!1}},focus:function(){var e=document.getElementsByClassName("add-section-button");return e.length&&e[0].addEventListener("click",this.add_bound("begin_add_rel",this.begin_add_relationship.bind(this,{type:"Section"}))),Sm.Core.SmView.prototype.focus.apply(this,arguments)}}),Sm.loaded.add("Entities_Dimension_View")},"Entities_Dimension_View")}),define("Sm-Entities-Dimension-View",function(){}),require(["require","Sm-Core-Meta"],function(e){var t=Sm.Core.Meta.base_constructor.extend({relationship_type_obj:{sections:{MvType:"Section",index_singular:"section",primary_key:"dimension_id",secondary_key:"section_id",is_only_reciprocal:!1,linked_entities:["Dimension","Section"]},pages:{MvType:"Page",index_singular:"page",primary_key:"dimension_id",secondary_key:"page_id",is_only_reciprocal:!1,linked_entities:["Dimension","Page"]},dimensions:{MvType:"Section",index_singular:"section",primary_key:"section_id",secondary_key:"dimension_id",is_only_reciprocal:!0,linked_entities:["Dimension","Section"]}},get_possible_relationship_indices:function(e){if(!e)return[];e=e||{};var t=e.OtherMvCombo,i=(t?t.type:e.type)||!1,n=!!e.is_reciprocal;return n?[null,"dimensions"]:"Section"==i?["sections"]:"Page"==i?["pages"]:[]}});Sm.Entities.Dimension.Meta=new t({type:"Dimension"}),Sm.Entities.Dimension.Meta.base_constructor=t;var i="Dimension";Sm.loaded.add("Entities_"+i+"_Meta")}),define("Sm-Entities-Dimension-Meta",function(){}),require(["require","Sm-Entities-Dimension-main"],function(e){Sm.Entities.Dimension.templates._template={outer:{full:"",preview:"",inline:"",tab:"",tag:""},button_control:{full:"",preview:"",inline:"",tab:"",tag:""}},Sm.loaded.add("Entities_Dimension_templates__template")}),define("Sm-Entities-Dimension-templates-_template",function(){}),require(["require","Sm-Entities-Dimension-main"],function(e){Sm.Entities.Dimension.templates.standard={body:{full:'<div class="description" ><%- description %></div>',preview:'<div class="description" ><%- description %></div>',inline:'<div class="description" ><%- description %></div>',tab:'<div class="description" ><%- description %></div>',tag:'<div class="description" ><%- description %></div>'},cache:{}},Sm.loaded.add("Entities_Dimension_templates_standard")}),define("Sm-Entities-Dimension-templates-standard",function(){}),require(["require","Sm","Sm-Entities-Dimension-templates-_template","Sm-Entities-Dimension-templates-standard"],function(e){e("Sm"),e("Sm-Entities-Dimension-templates-_template"),e("Sm-Entities-Dimension-templates-standard"),Sm.loaded.when_loaded(["Entities_Abstraction_Garage","Entities_Dimension_Meta","Entities_Dimension_templates__template"],function(){var e=Sm.Entities.Abstraction.Garage.extend({});Sm.Entities.Dimension.Garage=new e("Dimension","dimension_type"),Sm.loaded.add("Entities_Dimension_Garage")},"Entities_Dimension_Garage")}),define("Sm-Entities-Dimension-Garage",function(){});